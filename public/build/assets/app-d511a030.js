var Oo=Object.defineProperty;var Fo=(t,e,r)=>e in t?Oo(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var ko=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var ii=(t,e,r)=>(Fo(t,typeof e!="symbol"?e+"":e,r),r);var Rp=ko((Np,Tr)=>{const Uo="modulepreload",Ro=function(t){return"/build/"+t},ni={},Co=function(e,r,s){if(!r||r.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(r.map(n=>{if(n=Ro(n),n in ni)return;ni[n]=!0;const o=n.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!s)for(let d=i.length-1;d>=0;d--){const c=i[d];if(c.href===n&&(!o||c.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${n}"]${a}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":Uo,o||(u.as="script",u.crossOrigin=""),u.href=n,document.head.appendChild(u),o)return new Promise((d,c)=>{u.addEventListener("load",d),u.addEventListener("error",()=>c(new Error(`Unable to preload CSS for ${n}`)))})})).then(()=>e()).catch(n=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=n,window.dispatchEvent(o),!o.defaultPrevented)throw n})};function ln(t,e){return function(){return t.apply(e,arguments)}}const{toString:xo}=Object.prototype,{getPrototypeOf:js}=Object,Mr=(t=>e=>{const r=xo.call(e);return t[r]||(t[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),_e=t=>(t=t.toLowerCase(),e=>Mr(e)===t),$r=t=>e=>typeof e===t,{isArray:yt}=Array,rr=$r("undefined");function Mo(t){return t!==null&&!rr(t)&&t.constructor!==null&&!rr(t.constructor)&&pe(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const un=_e("ArrayBuffer");function $o(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&un(t.buffer),e}const No=$r("string"),pe=$r("function"),cn=$r("number"),Nr=t=>t!==null&&typeof t=="object",Lo=t=>t===!0||t===!1,yr=t=>{if(Mr(t)!=="object")return!1;const e=js(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},jo=_e("Date"),Bo=_e("File"),Io=_e("Blob"),Do=_e("FileList"),zo=t=>Nr(t)&&pe(t.pipe),qo=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||pe(t.append)&&((e=Mr(t))==="formdata"||e==="object"&&pe(t.toString)&&t.toString()==="[object FormData]"))},Ho=_e("URLSearchParams"),[Go,Wo,Vo,Jo]=["ReadableStream","Request","Response","Headers"].map(_e),Ko=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function or(t,e,{allOwnKeys:r=!1}={}){if(t===null||typeof t>"u")return;let s,i;if(typeof t!="object"&&(t=[t]),yt(t))for(s=0,i=t.length;s<i;s++)e.call(null,t[s],s,t);else{const n=r?Object.getOwnPropertyNames(t):Object.keys(t),o=n.length;let a;for(s=0;s<o;s++)a=n[s],e.call(null,t[a],a,t)}}function dn(t,e){e=e.toLowerCase();const r=Object.keys(t);let s=r.length,i;for(;s-- >0;)if(i=r[s],e===i.toLowerCase())return i;return null}const at=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),pn=t=>!rr(t)&&t!==at;function ws(){const{caseless:t}=pn(this)&&this||{},e={},r=(s,i)=>{const n=t&&dn(e,i)||i;yr(e[n])&&yr(s)?e[n]=ws(e[n],s):yr(s)?e[n]=ws({},s):yt(s)?e[n]=s.slice():e[n]=s};for(let s=0,i=arguments.length;s<i;s++)arguments[s]&&or(arguments[s],r);return e}const Xo=(t,e,r,{allOwnKeys:s}={})=>(or(e,(i,n)=>{r&&pe(i)?t[n]=ln(i,r):t[n]=i},{allOwnKeys:s}),t),Yo=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),Qo=(t,e,r,s)=>{t.prototype=Object.create(e.prototype,s),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),r&&Object.assign(t.prototype,r)},Zo=(t,e,r,s)=>{let i,n,o;const a={};if(e=e||{},t==null)return e;do{for(i=Object.getOwnPropertyNames(t),n=i.length;n-- >0;)o=i[n],(!s||s(o,t,e))&&!a[o]&&(e[o]=t[o],a[o]=!0);t=r!==!1&&js(t)}while(t&&(!r||r(t,e))&&t!==Object.prototype);return e},ea=(t,e,r)=>{t=String(t),(r===void 0||r>t.length)&&(r=t.length),r-=e.length;const s=t.indexOf(e,r);return s!==-1&&s===r},ta=t=>{if(!t)return null;if(yt(t))return t;let e=t.length;if(!cn(e))return null;const r=new Array(e);for(;e-- >0;)r[e]=t[e];return r},ra=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&js(Uint8Array)),sa=(t,e)=>{const s=(t&&t[Symbol.iterator]).call(t);let i;for(;(i=s.next())&&!i.done;){const n=i.value;e.call(t,n[0],n[1])}},ia=(t,e)=>{let r;const s=[];for(;(r=t.exec(e))!==null;)s.push(r);return s},na=_e("HTMLFormElement"),oa=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,s,i){return s.toUpperCase()+i}),oi=(({hasOwnProperty:t})=>(e,r)=>t.call(e,r))(Object.prototype),aa=_e("RegExp"),hn=(t,e)=>{const r=Object.getOwnPropertyDescriptors(t),s={};or(r,(i,n)=>{let o;(o=e(i,n,t))!==!1&&(s[n]=o||i)}),Object.defineProperties(t,s)},la=t=>{hn(t,(e,r)=>{if(pe(t)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const s=t[r];if(pe(s)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},ua=(t,e)=>{const r={},s=i=>{i.forEach(n=>{r[n]=!0})};return yt(t)?s(t):s(String(t).split(e)),r},ca=()=>{},da=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e,Vr="abcdefghijklmnopqrstuvwxyz",ai="0123456789",fn={DIGIT:ai,ALPHA:Vr,ALPHA_DIGIT:Vr+Vr.toUpperCase()+ai},pa=(t=16,e=fn.ALPHA_DIGIT)=>{let r="";const{length:s}=e;for(;t--;)r+=e[Math.random()*s|0];return r};function ha(t){return!!(t&&pe(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const fa=t=>{const e=new Array(10),r=(s,i)=>{if(Nr(s)){if(e.indexOf(s)>=0)return;if(!("toJSON"in s)){e[i]=s;const n=yt(s)?[]:{};return or(s,(o,a)=>{const l=r(o,i+1);!rr(l)&&(n[a]=l)}),e[i]=void 0,n}}return s};return r(t,0)},ma=_e("AsyncFunction"),ga=t=>t&&(Nr(t)||pe(t))&&pe(t.then)&&pe(t.catch),mn=((t,e)=>t?setImmediate:e?((r,s)=>(at.addEventListener("message",({source:i,data:n})=>{i===at&&n===r&&s.length&&s.shift()()},!1),i=>{s.push(i),at.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",pe(at.postMessage)),ya=typeof queueMicrotask<"u"?queueMicrotask.bind(at):typeof process<"u"&&process.nextTick||mn,p={isArray:yt,isArrayBuffer:un,isBuffer:Mo,isFormData:qo,isArrayBufferView:$o,isString:No,isNumber:cn,isBoolean:Lo,isObject:Nr,isPlainObject:yr,isReadableStream:Go,isRequest:Wo,isResponse:Vo,isHeaders:Jo,isUndefined:rr,isDate:jo,isFile:Bo,isBlob:Io,isRegExp:aa,isFunction:pe,isStream:zo,isURLSearchParams:Ho,isTypedArray:ra,isFileList:Do,forEach:or,merge:ws,extend:Xo,trim:Ko,stripBOM:Yo,inherits:Qo,toFlatObject:Zo,kindOf:Mr,kindOfTest:_e,endsWith:ea,toArray:ta,forEachEntry:sa,matchAll:ia,isHTMLForm:na,hasOwnProperty:oi,hasOwnProp:oi,reduceDescriptors:hn,freezeMethods:la,toObjectSet:ua,toCamelCase:oa,noop:ca,toFiniteNumber:da,findKey:dn,global:at,isContextDefined:pn,ALPHABET:fn,generateString:pa,isSpecCompliantForm:ha,toJSONObject:fa,isAsyncFn:ma,isThenable:ga,setImmediate:mn,asap:ya};function k(t,e,r,s,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),r&&(this.config=r),s&&(this.request=s),i&&(this.response=i,this.status=i.status?i.status:null)}p.inherits(k,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:p.toJSONObject(this.config),code:this.code,status:this.status}}});const gn=k.prototype,yn={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{yn[t]={value:t}});Object.defineProperties(k,yn);Object.defineProperty(gn,"isAxiosError",{value:!0});k.from=(t,e,r,s,i,n)=>{const o=Object.create(gn);return p.toFlatObject(t,o,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),k.call(o,t.message,e,r,s,i),o.cause=t,o.name=t.name,n&&Object.assign(o,n),o};const va=null;function Ss(t){return p.isPlainObject(t)||p.isArray(t)}function vn(t){return p.endsWith(t,"[]")?t.slice(0,-2):t}function li(t,e,r){return t?t.concat(e).map(function(i,n){return i=vn(i),!r&&n?"["+i+"]":i}).join(r?".":""):e}function _a(t){return p.isArray(t)&&!t.some(Ss)}const ba=p.toFlatObject(p,{},null,function(e){return/^is[A-Z]/.test(e)});function Lr(t,e,r){if(!p.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,r=p.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(y,g){return!p.isUndefined(g[y])});const s=r.metaTokens,i=r.visitor||d,n=r.dots,o=r.indexes,l=(r.Blob||typeof Blob<"u"&&Blob)&&p.isSpecCompliantForm(e);if(!p.isFunction(i))throw new TypeError("visitor must be a function");function u(f){if(f===null)return"";if(p.isDate(f))return f.toISOString();if(!l&&p.isBlob(f))throw new k("Blob is not supported. Use a Buffer instead.");return p.isArrayBuffer(f)||p.isTypedArray(f)?l&&typeof Blob=="function"?new Blob([f]):Buffer.from(f):f}function d(f,y,g){let v=f;if(f&&!g&&typeof f=="object"){if(p.endsWith(y,"{}"))y=s?y:y.slice(0,-2),f=JSON.stringify(f);else if(p.isArray(f)&&_a(f)||(p.isFileList(f)||p.endsWith(y,"[]"))&&(v=p.toArray(f)))return y=vn(y),v.forEach(function(U,F){!(p.isUndefined(U)||U===null)&&e.append(o===!0?li([y],F,n):o===null?y:y+"[]",u(U))}),!1}return Ss(f)?!0:(e.append(li(g,y,n),u(f)),!1)}const c=[],m=Object.assign(ba,{defaultVisitor:d,convertValue:u,isVisitable:Ss});function h(f,y){if(!p.isUndefined(f)){if(c.indexOf(f)!==-1)throw Error("Circular reference detected in "+y.join("."));c.push(f),p.forEach(f,function(v,S){(!(p.isUndefined(v)||v===null)&&i.call(e,v,p.isString(S)?S.trim():S,y,m))===!0&&h(v,y?y.concat(S):[S])}),c.pop()}}if(!p.isObject(t))throw new TypeError("data must be an object");return h(t),e}function ui(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(s){return e[s]})}function Bs(t,e){this._pairs=[],t&&Lr(t,this,e)}const _n=Bs.prototype;_n.append=function(e,r){this._pairs.push([e,r])};_n.toString=function(e){const r=e?function(s){return e.call(this,s,ui)}:ui;return this._pairs.map(function(i){return r(i[0])+"="+r(i[1])},"").join("&")};function wa(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function bn(t,e,r){if(!e)return t;const s=r&&r.encode||wa,i=r&&r.serialize;let n;if(i?n=i(e,r):n=p.isURLSearchParams(e)?e.toString():new Bs(e,r).toString(s),n){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+n}return t}class Sa{constructor(){this.handlers=[]}use(e,r,s){return this.handlers.push({fulfilled:e,rejected:r,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){p.forEach(this.handlers,function(s){s!==null&&e(s)})}}const ci=Sa,wn={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Pa=typeof URLSearchParams<"u"?URLSearchParams:Bs,Ea=typeof FormData<"u"?FormData:null,Ta=typeof Blob<"u"?Blob:null,Aa={isBrowser:!0,classes:{URLSearchParams:Pa,FormData:Ea,Blob:Ta},protocols:["http","https","file","blob","url","data"]},Is=typeof window<"u"&&typeof document<"u",Ps=typeof navigator=="object"&&navigator||void 0,Oa=Is&&(!Ps||["ReactNative","NativeScript","NS"].indexOf(Ps.product)<0),Fa=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),ka=Is&&window.location.href||"http://localhost",Ua=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Is,hasStandardBrowserEnv:Oa,hasStandardBrowserWebWorkerEnv:Fa,navigator:Ps,origin:ka},Symbol.toStringTag,{value:"Module"})),re={...Ua,...Aa};function Ra(t,e){return Lr(t,new re.classes.URLSearchParams,Object.assign({visitor:function(r,s,i,n){return re.isNode&&p.isBuffer(r)?(this.append(s,r.toString("base64")),!1):n.defaultVisitor.apply(this,arguments)}},e))}function Ca(t){return p.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function xa(t){const e={},r=Object.keys(t);let s;const i=r.length;let n;for(s=0;s<i;s++)n=r[s],e[n]=t[n];return e}function Sn(t){function e(r,s,i,n){let o=r[n++];if(o==="__proto__")return!0;const a=Number.isFinite(+o),l=n>=r.length;return o=!o&&p.isArray(i)?i.length:o,l?(p.hasOwnProp(i,o)?i[o]=[i[o],s]:i[o]=s,!a):((!i[o]||!p.isObject(i[o]))&&(i[o]=[]),e(r,s,i[o],n)&&p.isArray(i[o])&&(i[o]=xa(i[o])),!a)}if(p.isFormData(t)&&p.isFunction(t.entries)){const r={};return p.forEachEntry(t,(s,i)=>{e(Ca(s),i,r,0)}),r}return null}function Ma(t,e,r){if(p.isString(t))try{return(e||JSON.parse)(t),p.trim(t)}catch(s){if(s.name!=="SyntaxError")throw s}return(r||JSON.stringify)(t)}const Ds={transitional:wn,adapter:["xhr","http","fetch"],transformRequest:[function(e,r){const s=r.getContentType()||"",i=s.indexOf("application/json")>-1,n=p.isObject(e);if(n&&p.isHTMLForm(e)&&(e=new FormData(e)),p.isFormData(e))return i?JSON.stringify(Sn(e)):e;if(p.isArrayBuffer(e)||p.isBuffer(e)||p.isStream(e)||p.isFile(e)||p.isBlob(e)||p.isReadableStream(e))return e;if(p.isArrayBufferView(e))return e.buffer;if(p.isURLSearchParams(e))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(n){if(s.indexOf("application/x-www-form-urlencoded")>-1)return Ra(e,this.formSerializer).toString();if((a=p.isFileList(e))||s.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return Lr(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return n||i?(r.setContentType("application/json",!1),Ma(e)):e}],transformResponse:[function(e){const r=this.transitional||Ds.transitional,s=r&&r.forcedJSONParsing,i=this.responseType==="json";if(p.isResponse(e)||p.isReadableStream(e))return e;if(e&&p.isString(e)&&(s&&!this.responseType||i)){const o=!(r&&r.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(a){if(o)throw a.name==="SyntaxError"?k.from(a,k.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:re.classes.FormData,Blob:re.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};p.forEach(["delete","get","head","post","put","patch"],t=>{Ds.headers[t]={}});const zs=Ds,$a=p.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Na=t=>{const e={};let r,s,i;return t&&t.split(`
`).forEach(function(o){i=o.indexOf(":"),r=o.substring(0,i).trim().toLowerCase(),s=o.substring(i+1).trim(),!(!r||e[r]&&$a[r])&&(r==="set-cookie"?e[r]?e[r].push(s):e[r]=[s]:e[r]=e[r]?e[r]+", "+s:s)}),e},di=Symbol("internals");function St(t){return t&&String(t).trim().toLowerCase()}function vr(t){return t===!1||t==null?t:p.isArray(t)?t.map(vr):String(t)}function La(t){const e=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=r.exec(t);)e[s[1]]=s[2];return e}const ja=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Jr(t,e,r,s,i){if(p.isFunction(s))return s.call(this,e,r);if(i&&(e=r),!!p.isString(e)){if(p.isString(s))return e.indexOf(s)!==-1;if(p.isRegExp(s))return s.test(e)}}function Ba(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,r,s)=>r.toUpperCase()+s)}function Ia(t,e){const r=p.toCamelCase(" "+e);["get","set","has"].forEach(s=>{Object.defineProperty(t,s+r,{value:function(i,n,o){return this[s].call(this,e,i,n,o)},configurable:!0})})}class jr{constructor(e){e&&this.set(e)}set(e,r,s){const i=this;function n(a,l,u){const d=St(l);if(!d)throw new Error("header name must be a non-empty string");const c=p.findKey(i,d);(!c||i[c]===void 0||u===!0||u===void 0&&i[c]!==!1)&&(i[c||l]=vr(a))}const o=(a,l)=>p.forEach(a,(u,d)=>n(u,d,l));if(p.isPlainObject(e)||e instanceof this.constructor)o(e,r);else if(p.isString(e)&&(e=e.trim())&&!ja(e))o(Na(e),r);else if(p.isHeaders(e))for(const[a,l]of e.entries())n(l,a,s);else e!=null&&n(r,e,s);return this}get(e,r){if(e=St(e),e){const s=p.findKey(this,e);if(s){const i=this[s];if(!r)return i;if(r===!0)return La(i);if(p.isFunction(r))return r.call(this,i,s);if(p.isRegExp(r))return r.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,r){if(e=St(e),e){const s=p.findKey(this,e);return!!(s&&this[s]!==void 0&&(!r||Jr(this,this[s],s,r)))}return!1}delete(e,r){const s=this;let i=!1;function n(o){if(o=St(o),o){const a=p.findKey(s,o);a&&(!r||Jr(s,s[a],a,r))&&(delete s[a],i=!0)}}return p.isArray(e)?e.forEach(n):n(e),i}clear(e){const r=Object.keys(this);let s=r.length,i=!1;for(;s--;){const n=r[s];(!e||Jr(this,this[n],n,e,!0))&&(delete this[n],i=!0)}return i}normalize(e){const r=this,s={};return p.forEach(this,(i,n)=>{const o=p.findKey(s,n);if(o){r[o]=vr(i),delete r[n];return}const a=e?Ba(n):String(n).trim();a!==n&&delete r[n],r[a]=vr(i),s[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const r=Object.create(null);return p.forEach(this,(s,i)=>{s!=null&&s!==!1&&(r[i]=e&&p.isArray(s)?s.join(", "):s)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,r])=>e+": "+r).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...r){const s=new this(e);return r.forEach(i=>s.set(i)),s}static accessor(e){const s=(this[di]=this[di]={accessors:{}}).accessors,i=this.prototype;function n(o){const a=St(o);s[a]||(Ia(i,o),s[a]=!0)}return p.isArray(e)?e.forEach(n):n(e),this}}jr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);p.reduceDescriptors(jr.prototype,({value:t},e)=>{let r=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(s){this[r]=s}}});p.freezeMethods(jr);const ve=jr;function Kr(t,e){const r=this||zs,s=e||r,i=ve.from(s.headers);let n=s.data;return p.forEach(t,function(a){n=a.call(r,n,i.normalize(),e?e.status:void 0)}),i.normalize(),n}function Pn(t){return!!(t&&t.__CANCEL__)}function vt(t,e,r){k.call(this,t??"canceled",k.ERR_CANCELED,e,r),this.name="CanceledError"}p.inherits(vt,k,{__CANCEL__:!0});function En(t,e,r){const s=r.config.validateStatus;!r.status||!s||s(r.status)?t(r):e(new k("Request failed with status code "+r.status,[k.ERR_BAD_REQUEST,k.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function Da(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function za(t,e){t=t||10;const r=new Array(t),s=new Array(t);let i=0,n=0,o;return e=e!==void 0?e:1e3,function(l){const u=Date.now(),d=s[n];o||(o=u),r[i]=l,s[i]=u;let c=n,m=0;for(;c!==i;)m+=r[c++],c=c%t;if(i=(i+1)%t,i===n&&(n=(n+1)%t),u-o<e)return;const h=d&&u-d;return h?Math.round(m*1e3/h):void 0}}function qa(t,e){let r=0,s=1e3/e,i,n;const o=(u,d=Date.now())=>{r=d,i=null,n&&(clearTimeout(n),n=null),t.apply(null,u)};return[(...u)=>{const d=Date.now(),c=d-r;c>=s?o(u,d):(i=u,n||(n=setTimeout(()=>{n=null,o(i)},s-c)))},()=>i&&o(i)]}const Ar=(t,e,r=3)=>{let s=0;const i=za(50,250);return qa(n=>{const o=n.loaded,a=n.lengthComputable?n.total:void 0,l=o-s,u=i(l),d=o<=a;s=o;const c={loaded:o,total:a,progress:a?o/a:void 0,bytes:l,rate:u||void 0,estimated:u&&a&&d?(a-o)/u:void 0,event:n,lengthComputable:a!=null,[e?"download":"upload"]:!0};t(c)},r)},pi=(t,e)=>{const r=t!=null;return[s=>e[0]({lengthComputable:r,total:t,loaded:s}),e[1]]},hi=t=>(...e)=>p.asap(()=>t(...e)),Ha=re.hasStandardBrowserEnv?function(){const e=re.navigator&&/(msie|trident)/i.test(re.navigator.userAgent),r=document.createElement("a");let s;function i(n){let o=n;return e&&(r.setAttribute("href",o),o=r.href),r.setAttribute("href",o),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:r.pathname.charAt(0)==="/"?r.pathname:"/"+r.pathname}}return s=i(window.location.href),function(o){const a=p.isString(o)?i(o):o;return a.protocol===s.protocol&&a.host===s.host}}():function(){return function(){return!0}}(),Ga=re.hasStandardBrowserEnv?{write(t,e,r,s,i,n){const o=[t+"="+encodeURIComponent(e)];p.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),p.isString(s)&&o.push("path="+s),p.isString(i)&&o.push("domain="+i),n===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Wa(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function Va(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function Tn(t,e){return t&&!Wa(e)?Va(t,e):e}const fi=t=>t instanceof ve?{...t}:t;function dt(t,e){e=e||{};const r={};function s(u,d,c){return p.isPlainObject(u)&&p.isPlainObject(d)?p.merge.call({caseless:c},u,d):p.isPlainObject(d)?p.merge({},d):p.isArray(d)?d.slice():d}function i(u,d,c){if(p.isUndefined(d)){if(!p.isUndefined(u))return s(void 0,u,c)}else return s(u,d,c)}function n(u,d){if(!p.isUndefined(d))return s(void 0,d)}function o(u,d){if(p.isUndefined(d)){if(!p.isUndefined(u))return s(void 0,u)}else return s(void 0,d)}function a(u,d,c){if(c in e)return s(u,d);if(c in t)return s(void 0,u)}const l={url:n,method:n,data:n,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(u,d)=>i(fi(u),fi(d),!0)};return p.forEach(Object.keys(Object.assign({},t,e)),function(d){const c=l[d]||i,m=c(t[d],e[d],d);p.isUndefined(m)&&c!==a||(r[d]=m)}),r}const An=t=>{const e=dt({},t);let{data:r,withXSRFToken:s,xsrfHeaderName:i,xsrfCookieName:n,headers:o,auth:a}=e;e.headers=o=ve.from(o),e.url=bn(Tn(e.baseURL,e.url),t.params,t.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let l;if(p.isFormData(r)){if(re.hasStandardBrowserEnv||re.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((l=o.getContentType())!==!1){const[u,...d]=l?l.split(";").map(c=>c.trim()).filter(Boolean):[];o.setContentType([u||"multipart/form-data",...d].join("; "))}}if(re.hasStandardBrowserEnv&&(s&&p.isFunction(s)&&(s=s(e)),s||s!==!1&&Ha(e.url))){const u=i&&n&&Ga.read(n);u&&o.set(i,u)}return e},Ja=typeof XMLHttpRequest<"u",Ka=Ja&&function(t){return new Promise(function(r,s){const i=An(t);let n=i.data;const o=ve.from(i.headers).normalize();let{responseType:a,onUploadProgress:l,onDownloadProgress:u}=i,d,c,m,h,f;function y(){h&&h(),f&&f(),i.cancelToken&&i.cancelToken.unsubscribe(d),i.signal&&i.signal.removeEventListener("abort",d)}let g=new XMLHttpRequest;g.open(i.method.toUpperCase(),i.url,!0),g.timeout=i.timeout;function v(){if(!g)return;const U=ve.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),C={data:!a||a==="text"||a==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:U,config:t,request:g};En(function(A){r(A),y()},function(A){s(A),y()},C),g=null}"onloadend"in g?g.onloadend=v:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(v)},g.onabort=function(){g&&(s(new k("Request aborted",k.ECONNABORTED,t,g)),g=null)},g.onerror=function(){s(new k("Network Error",k.ERR_NETWORK,t,g)),g=null},g.ontimeout=function(){let F=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const C=i.transitional||wn;i.timeoutErrorMessage&&(F=i.timeoutErrorMessage),s(new k(F,C.clarifyTimeoutError?k.ETIMEDOUT:k.ECONNABORTED,t,g)),g=null},n===void 0&&o.setContentType(null),"setRequestHeader"in g&&p.forEach(o.toJSON(),function(F,C){g.setRequestHeader(C,F)}),p.isUndefined(i.withCredentials)||(g.withCredentials=!!i.withCredentials),a&&a!=="json"&&(g.responseType=i.responseType),u&&([m,f]=Ar(u,!0),g.addEventListener("progress",m)),l&&g.upload&&([c,h]=Ar(l),g.upload.addEventListener("progress",c),g.upload.addEventListener("loadend",h)),(i.cancelToken||i.signal)&&(d=U=>{g&&(s(!U||U.type?new vt(null,t,g):U),g.abort(),g=null)},i.cancelToken&&i.cancelToken.subscribe(d),i.signal&&(i.signal.aborted?d():i.signal.addEventListener("abort",d)));const S=Da(i.url);if(S&&re.protocols.indexOf(S)===-1){s(new k("Unsupported protocol "+S+":",k.ERR_BAD_REQUEST,t));return}g.send(n||null)})},Xa=(t,e)=>{const{length:r}=t=t?t.filter(Boolean):[];if(e||r){let s=new AbortController,i;const n=function(u){if(!i){i=!0,a();const d=u instanceof Error?u:this.reason;s.abort(d instanceof k?d:new vt(d instanceof Error?d.message:d))}};let o=e&&setTimeout(()=>{o=null,n(new k(`timeout ${e} of ms exceeded`,k.ETIMEDOUT))},e);const a=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(u=>{u.unsubscribe?u.unsubscribe(n):u.removeEventListener("abort",n)}),t=null)};t.forEach(u=>u.addEventListener("abort",n));const{signal:l}=s;return l.unsubscribe=()=>p.asap(a),l}},Ya=Xa,Qa=function*(t,e){let r=t.byteLength;if(!e||r<e){yield t;return}let s=0,i;for(;s<r;)i=s+e,yield t.slice(s,i),s=i},Za=async function*(t,e){for await(const r of el(t))yield*Qa(r,e)},el=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:r,value:s}=await e.read();if(r)break;yield s}}finally{await e.cancel()}},mi=(t,e,r,s)=>{const i=Za(t,e);let n=0,o,a=l=>{o||(o=!0,s&&s(l))};return new ReadableStream({async pull(l){try{const{done:u,value:d}=await i.next();if(u){a(),l.close();return}let c=d.byteLength;if(r){let m=n+=c;r(m)}l.enqueue(new Uint8Array(d))}catch(u){throw a(u),u}},cancel(l){return a(l),i.return()}},{highWaterMark:2})},Br=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",On=Br&&typeof ReadableStream=="function",tl=Br&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),Fn=(t,...e)=>{try{return!!t(...e)}catch{return!1}},rl=On&&Fn(()=>{let t=!1;const e=new Request(re.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),gi=64*1024,Es=On&&Fn(()=>p.isReadableStream(new Response("").body)),Or={stream:Es&&(t=>t.body)};Br&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Or[e]&&(Or[e]=p.isFunction(t[e])?r=>r[e]():(r,s)=>{throw new k(`Response type '${e}' is not supported`,k.ERR_NOT_SUPPORT,s)})})})(new Response);const sl=async t=>{if(t==null)return 0;if(p.isBlob(t))return t.size;if(p.isSpecCompliantForm(t))return(await new Request(re.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(p.isArrayBufferView(t)||p.isArrayBuffer(t))return t.byteLength;if(p.isURLSearchParams(t)&&(t=t+""),p.isString(t))return(await tl(t)).byteLength},il=async(t,e)=>{const r=p.toFiniteNumber(t.getContentLength());return r??sl(e)},nl=Br&&(async t=>{let{url:e,method:r,data:s,signal:i,cancelToken:n,timeout:o,onDownloadProgress:a,onUploadProgress:l,responseType:u,headers:d,withCredentials:c="same-origin",fetchOptions:m}=An(t);u=u?(u+"").toLowerCase():"text";let h=Ya([i,n&&n.toAbortSignal()],o),f;const y=h&&h.unsubscribe&&(()=>{h.unsubscribe()});let g;try{if(l&&rl&&r!=="get"&&r!=="head"&&(g=await il(d,s))!==0){let C=new Request(e,{method:"POST",body:s,duplex:"half"}),P;if(p.isFormData(s)&&(P=C.headers.get("content-type"))&&d.setContentType(P),C.body){const[A,x]=pi(g,Ar(hi(l)));s=mi(C.body,gi,A,x)}}p.isString(c)||(c=c?"include":"omit");const v="credentials"in Request.prototype;f=new Request(e,{...m,signal:h,method:r.toUpperCase(),headers:d.normalize().toJSON(),body:s,duplex:"half",credentials:v?c:void 0});let S=await fetch(f);const U=Es&&(u==="stream"||u==="response");if(Es&&(a||U&&y)){const C={};["status","statusText","headers"].forEach(N=>{C[N]=S[N]});const P=p.toFiniteNumber(S.headers.get("content-length")),[A,x]=a&&pi(P,Ar(hi(a),!0))||[];S=new Response(mi(S.body,gi,A,()=>{x&&x(),y&&y()}),C)}u=u||"text";let F=await Or[p.findKey(Or,u)||"text"](S,t);return!U&&y&&y(),await new Promise((C,P)=>{En(C,P,{data:F,headers:ve.from(S.headers),status:S.status,statusText:S.statusText,config:t,request:f})})}catch(v){throw y&&y(),v&&v.name==="TypeError"&&/fetch/i.test(v.message)?Object.assign(new k("Network Error",k.ERR_NETWORK,t,f),{cause:v.cause||v}):k.from(v,v&&v.code,t,f)}}),Ts={http:va,xhr:Ka,fetch:nl};p.forEach(Ts,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const yi=t=>`- ${t}`,ol=t=>p.isFunction(t)||t===null||t===!1,kn={getAdapter:t=>{t=p.isArray(t)?t:[t];const{length:e}=t;let r,s;const i={};for(let n=0;n<e;n++){r=t[n];let o;if(s=r,!ol(r)&&(s=Ts[(o=String(r)).toLowerCase()],s===void 0))throw new k(`Unknown adapter '${o}'`);if(s)break;i[o||"#"+n]=s}if(!s){const n=Object.entries(i).map(([a,l])=>`adapter ${a} `+(l===!1?"is not supported by the environment":"is not available in the build"));let o=e?n.length>1?`since :
`+n.map(yi).join(`
`):" "+yi(n[0]):"as no adapter specified";throw new k("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return s},adapters:Ts};function Xr(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new vt(null,t)}function vi(t){return Xr(t),t.headers=ve.from(t.headers),t.data=Kr.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),kn.getAdapter(t.adapter||zs.adapter)(t).then(function(s){return Xr(t),s.data=Kr.call(t,t.transformResponse,s),s.headers=ve.from(s.headers),s},function(s){return Pn(s)||(Xr(t),s&&s.response&&(s.response.data=Kr.call(t,t.transformResponse,s.response),s.response.headers=ve.from(s.response.headers))),Promise.reject(s)})}const Un="1.7.7",qs={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{qs[t]=function(s){return typeof s===t||"a"+(e<1?"n ":" ")+t}});const _i={};qs.transitional=function(e,r,s){function i(n,o){return"[Axios v"+Un+"] Transitional option '"+n+"'"+o+(s?". "+s:"")}return(n,o,a)=>{if(e===!1)throw new k(i(o," has been removed"+(r?" in "+r:"")),k.ERR_DEPRECATED);return r&&!_i[o]&&(_i[o]=!0,console.warn(i(o," has been deprecated since v"+r+" and will be removed in the near future"))),e?e(n,o,a):!0}};function al(t,e,r){if(typeof t!="object")throw new k("options must be an object",k.ERR_BAD_OPTION_VALUE);const s=Object.keys(t);let i=s.length;for(;i-- >0;){const n=s[i],o=e[n];if(o){const a=t[n],l=a===void 0||o(a,n,t);if(l!==!0)throw new k("option "+n+" must be "+l,k.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new k("Unknown option "+n,k.ERR_BAD_OPTION)}}const As={assertOptions:al,validators:qs},Ie=As.validators;class Fr{constructor(e){this.defaults=e,this.interceptors={request:new ci,response:new ci}}async request(e,r){try{return await this._request(e,r)}catch(s){if(s instanceof Error){let i;Error.captureStackTrace?Error.captureStackTrace(i={}):i=new Error;const n=i.stack?i.stack.replace(/^.+\n/,""):"";try{s.stack?n&&!String(s.stack).endsWith(n.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+n):s.stack=n}catch{}}throw s}}_request(e,r){typeof e=="string"?(r=r||{},r.url=e):r=e||{},r=dt(this.defaults,r);const{transitional:s,paramsSerializer:i,headers:n}=r;s!==void 0&&As.assertOptions(s,{silentJSONParsing:Ie.transitional(Ie.boolean),forcedJSONParsing:Ie.transitional(Ie.boolean),clarifyTimeoutError:Ie.transitional(Ie.boolean)},!1),i!=null&&(p.isFunction(i)?r.paramsSerializer={serialize:i}:As.assertOptions(i,{encode:Ie.function,serialize:Ie.function},!0)),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=n&&p.merge(n.common,n[r.method]);n&&p.forEach(["delete","get","head","post","put","patch","common"],f=>{delete n[f]}),r.headers=ve.concat(o,n);const a=[];let l=!0;this.interceptors.request.forEach(function(y){typeof y.runWhen=="function"&&y.runWhen(r)===!1||(l=l&&y.synchronous,a.unshift(y.fulfilled,y.rejected))});const u=[];this.interceptors.response.forEach(function(y){u.push(y.fulfilled,y.rejected)});let d,c=0,m;if(!l){const f=[vi.bind(this),void 0];for(f.unshift.apply(f,a),f.push.apply(f,u),m=f.length,d=Promise.resolve(r);c<m;)d=d.then(f[c++],f[c++]);return d}m=a.length;let h=r;for(c=0;c<m;){const f=a[c++],y=a[c++];try{h=f(h)}catch(g){y.call(this,g);break}}try{d=vi.call(this,h)}catch(f){return Promise.reject(f)}for(c=0,m=u.length;c<m;)d=d.then(u[c++],u[c++]);return d}getUri(e){e=dt(this.defaults,e);const r=Tn(e.baseURL,e.url);return bn(r,e.params,e.paramsSerializer)}}p.forEach(["delete","get","head","options"],function(e){Fr.prototype[e]=function(r,s){return this.request(dt(s||{},{method:e,url:r,data:(s||{}).data}))}});p.forEach(["post","put","patch"],function(e){function r(s){return function(n,o,a){return this.request(dt(a||{},{method:e,headers:s?{"Content-Type":"multipart/form-data"}:{},url:n,data:o}))}}Fr.prototype[e]=r(),Fr.prototype[e+"Form"]=r(!0)});const _r=Fr;class Hs{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(n){r=n});const s=this;this.promise.then(i=>{if(!s._listeners)return;let n=s._listeners.length;for(;n-- >0;)s._listeners[n](i);s._listeners=null}),this.promise.then=i=>{let n;const o=new Promise(a=>{s.subscribe(a),n=a}).then(i);return o.cancel=function(){s.unsubscribe(n)},o},e(function(n,o,a){s.reason||(s.reason=new vt(n,o,a),r(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const r=this._listeners.indexOf(e);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const e=new AbortController,r=s=>{e.abort(s)};return this.subscribe(r),e.signal.unsubscribe=()=>this.unsubscribe(r),e.signal}static source(){let e;return{token:new Hs(function(i){e=i}),cancel:e}}}const ll=Hs;function ul(t){return function(r){return t.apply(null,r)}}function cl(t){return p.isObject(t)&&t.isAxiosError===!0}const Os={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Os).forEach(([t,e])=>{Os[e]=t});const dl=Os;function Rn(t){const e=new _r(t),r=ln(_r.prototype.request,e);return p.extend(r,_r.prototype,e,{allOwnKeys:!0}),p.extend(r,e,null,{allOwnKeys:!0}),r.create=function(i){return Rn(dt(t,i))},r}const j=Rn(zs);j.Axios=_r;j.CanceledError=vt;j.CancelToken=ll;j.isCancel=Pn;j.VERSION=Un;j.toFormData=Lr;j.AxiosError=k;j.Cancel=j.CanceledError;j.all=function(e){return Promise.all(e)};j.spread=ul;j.isAxiosError=cl;j.mergeConfig=dt;j.AxiosHeaders=ve;j.formToJSON=t=>Sn(p.isHTMLForm(t)?new FormData(t):t);j.getAdapter=kn.getAdapter;j.HttpStatusCode=dl;j.default=j;const pl=j;window.axios=pl;window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";const xr=class xr{constructor(e){this.value=e}isTop(){return this.value===xr.Top}};ii(xr,"Top","top");let Fs=xr;class Gs{constructor(e,r){this.alignment=new Fs(e),this.duration=r}static fromJson(e){return new Gs(e.alignment,e.duration)}}function hl(){let t="";for(;t.length<32;)t+=Math.random().toString(16).substring(2);const e=(Number.parseInt(t.substring(16,1),16)&3|8).toString(16);return`${t.substring(0,8)}-${t.substring(8,4)}-4${t.substring(13,3)}-${e}${t.substring(17,3)}-${t.substring(20,12)}`}class Ws{constructor(e,r,s){this.$el=null,this.id=hl(),this.isVisible=!1,this.duration=e,this.message=r,this.timeout=null,this.trashed=!1,this.type=s}static fromJson(e){return new Ws(e.duration,e.message,e.type)}dispose(){this.timeout&&clearTimeout(this.timeout),this.isVisible=!1,this.$el.addEventListener("transitioncancel",()=>{this.trashed=!0}),this.$el.addEventListener("transitionend",()=>{this.trashed=!0})}runAfterDuration(e){this.timeout=setTimeout(()=>e(this),this.duration)}select(e){return e[this.type]}show(e){this.$el=e,this.isVisible=!0}}function fl(t){t.data("toasterHub",(e,r)=>(r=Gs.fromJson(r),{_toasts:[],get toasts(){const s=this._toasts.filter(i=>!i.trashed);return this._toasts.length&&!s.length&&this.$nextTick(()=>{this._toasts=[]}),s},init(){document.addEventListener("toaster:received",s=>{this.show({duration:r.duration,...s.detail})}),e.forEach(s=>this.show(s))},show(s){s=t.reactive(Ws.fromJson(s)),s.runAfterDuration(i=>i.dispose()),r.alignment.isTop()?this._toasts.unshift(s):this._toasts.push(s)}}))}const Ir=(t,e)=>{document.dispatchEvent(new CustomEvent("toaster:received",{detail:{message:t,type:e}}))},ml=t=>Ir(t,"error"),gl=t=>Ir(t,"info"),yl=t=>Ir(t,"success"),vl=t=>Ir(t,"warning"),_l=Object.freeze(Object.defineProperty({__proto__:null,error:ml,info:gl,success:yl,warning:vl},Symbol.toStringTag,{value:"Module"}));window.Toaster=_l;document.addEventListener("alpine:init",()=>{window.Alpine.plugin(fl)});function cr(t,e){if(!{}.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var bl=0;function Cn(t){return"__private_"+bl+++"_"+t}function wl(t,e,r){const s=[];return t.forEach(i=>typeof i!="string"?s.push(i):e[Symbol.split](i).forEach((n,o,a)=>{n!==""&&s.push(n),o<a.length-1&&s.push(r)})),s}/**
 * Takes a string with placeholder variables like `%{smart_count} file selected`
 * and replaces it with values from options `{smart_count: 5}`
 *
 * @license https://github.com/airbnb/polyglot.js/blob/master/LICENSE
 * taken from https://github.com/airbnb/polyglot.js/blob/master/lib/polyglot.js#L299
 *
 * @param phrase that needs interpolation, with placeholders
 * @param options with values that will be used to replace placeholders
 */function bi(t,e){const r=/\$/g,s="$$$$";let i=[t];if(e==null)return i;for(const n of Object.keys(e))if(n!=="_"){let o=e[n];typeof o=="string"&&(o=r[Symbol.replace](o,s)),i=wl(i,new RegExp(`%\\{${n}\\}`,"g"),o)}return i}const Sl=t=>{throw new Error(`missing string: ${t}`)};var Pt=Cn("onMissingKey"),Et=Cn("apply");class xn{constructor(e,r){let{onMissingKey:s=Sl}=r===void 0?{}:r;Object.defineProperty(this,Et,{value:Pl}),Object.defineProperty(this,Pt,{writable:!0,value:void 0}),this.locale={strings:{},pluralize(i){return i===1?0:1}},Array.isArray(e)?e.forEach(cr(this,Et)[Et],this):cr(this,Et)[Et](e),cr(this,Pt)[Pt]=s}translate(e,r){return this.translateArray(e,r).join("")}translateArray(e,r){let s=this.locale.strings[e];if(s==null&&(cr(this,Pt)[Pt](e),s=e),typeof s=="object"){if(r&&typeof r.smart_count<"u"){const n=this.locale.pluralize(r.smart_count);return bi(s[n],r)}throw new Error("Attempted to use a string with plural forms, but no value was given for %{smart_count}")}if(typeof s!="string")throw new Error("string was not a string");return bi(s,r)}}function Pl(t){if(!(t!=null&&t.strings))return;const e=this.locale;Object.assign(this.locale,{strings:{...e.strings,...t.strings},pluralize:t.pluralize||e.pluralize})}var dr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _t(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var El=function(){var e={},r=e._fns={};e.emit=function(o,a,l,u,d,c,m){var h=s(o);h.length&&i(o,h,[a,l,u,d,c,m])},e.on=function(o,a){r[o]||(r[o]=[]),r[o].push(a)},e.once=function(o,a){function l(){a.apply(this,arguments),e.off(o,l)}this.on(o,l)},e.off=function(o,a){var l=[];if(o&&a){var u=this._fns[o],d=0,c=u?u.length:0;for(d;d<c;d++)u[d]!==a&&l.push(u[d])}l.length?this._fns[o]=l:delete this._fns[o]};function s(n){var o=r[n]?r[n]:[],a=n.indexOf(":"),l=a===-1?[n]:[n.substring(0,a),n.substring(a+1)],u=Object.keys(r),d=0,c=u.length;for(d;d<c;d++){var m=u[d];if(m==="*"&&(o=o.concat(r[m])),l.length===2&&l[0]===m){o=o.concat(r[m]);break}}return o}function i(n,o,a){var l=0,u=o.length;for(l;l<u&&o[l];l++)o[l].event=n,o[l].apply(o[l],a)}return e};const Tl=_t(El);let Al="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",Ol=(t=21)=>{let e="",r=t|0;for(;r--;)e+=Al[Math.random()*64|0];return e};function Fl(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Vs=Fl,kl=typeof dr=="object"&&dr&&dr.Object===Object&&dr,Ul=kl,Rl=Ul,Cl=typeof self=="object"&&self&&self.Object===Object&&self,xl=Rl||Cl||Function("return this")(),Mn=xl,Ml=Mn,$l=function(){return Ml.Date.now()},Nl=$l,Ll=/\s/;function jl(t){for(var e=t.length;e--&&Ll.test(t.charAt(e)););return e}var Bl=jl,Il=Bl,Dl=/^\s+/;function zl(t){return t&&t.slice(0,Il(t)+1).replace(Dl,"")}var ql=zl,Hl=Mn,Gl=Hl.Symbol,$n=Gl,wi=$n,Nn=Object.prototype,Wl=Nn.hasOwnProperty,Vl=Nn.toString,Tt=wi?wi.toStringTag:void 0;function Jl(t){var e=Wl.call(t,Tt),r=t[Tt];try{t[Tt]=void 0;var s=!0}catch{}var i=Vl.call(t);return s&&(e?t[Tt]=r:delete t[Tt]),i}var Kl=Jl,Xl=Object.prototype,Yl=Xl.toString;function Ql(t){return Yl.call(t)}var Zl=Ql,Si=$n,eu=Kl,tu=Zl,ru="[object Null]",su="[object Undefined]",Pi=Si?Si.toStringTag:void 0;function iu(t){return t==null?t===void 0?su:ru:Pi&&Pi in Object(t)?eu(t):tu(t)}var nu=iu;function ou(t){return t!=null&&typeof t=="object"}var au=ou,lu=nu,uu=au,cu="[object Symbol]";function du(t){return typeof t=="symbol"||uu(t)&&lu(t)==cu}var pu=du,hu=ql,Ei=Vs,fu=pu,Ti=0/0,mu=/^[-+]0x[0-9a-f]+$/i,gu=/^0b[01]+$/i,yu=/^0o[0-7]+$/i,vu=parseInt;function _u(t){if(typeof t=="number")return t;if(fu(t))return Ti;if(Ei(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Ei(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=hu(t);var r=gu.test(t);return r||yu.test(t)?vu(t.slice(2),r?2:8):mu.test(t)?Ti:+t}var bu=_u,wu=Vs,Yr=Nl,Ai=bu,Su="Expected a function",Pu=Math.max,Eu=Math.min;function Tu(t,e,r){var s,i,n,o,a,l,u=0,d=!1,c=!1,m=!0;if(typeof t!="function")throw new TypeError(Su);e=Ai(e)||0,wu(r)&&(d=!!r.leading,c="maxWait"in r,n=c?Pu(Ai(r.maxWait)||0,e):n,m="trailing"in r?!!r.trailing:m);function h(P){var A=s,x=i;return s=i=void 0,u=P,o=t.apply(x,A),o}function f(P){return u=P,a=setTimeout(v,e),d?h(P):o}function y(P){var A=P-l,x=P-u,N=e-A;return c?Eu(N,n-x):N}function g(P){var A=P-l,x=P-u;return l===void 0||A>=e||A<0||c&&x>=n}function v(){var P=Yr();if(g(P))return S(P);a=setTimeout(v,y(P))}function S(P){return a=void 0,m&&s?h(P):(s=i=void 0,o)}function U(){a!==void 0&&clearTimeout(a),u=0,s=l=i=a=void 0}function F(){return a===void 0?o:S(Yr())}function C(){var P=Yr(),A=g(P);if(s=arguments,i=this,l=P,A){if(a===void 0)return f(l);if(c)return clearTimeout(a),a=setTimeout(v,e),h(l)}return a===void 0&&(a=setTimeout(v,e)),o}return C.cancel=U,C.flush=F,C}var Au=Tu,Ou=Au,Fu=Vs,ku="Expected a function";function Uu(t,e,r){var s=!0,i=!0;if(typeof t!="function")throw new TypeError(ku);return Fu(r)&&(s="leading"in r?!!r.leading:s,i="trailing"in r?!!r.trailing:i),Ou(t,e,{leading:s,maxWait:e,trailing:i})}var Ru=Uu;const Cu=_t(Ru);function br(t,e){if(!{}.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var xu=0;function Ln(t){return"__private_"+xu+++"_"+t}const Mu={version:"4.2.0"};var Qe=Ln("callbacks"),Qr=Ln("publish");class jn{constructor(){Object.defineProperty(this,Qr,{value:$u}),this.state={},Object.defineProperty(this,Qe,{writable:!0,value:new Set})}getState(){return this.state}setState(e){const r={...this.state},s={...this.state,...e};this.state=s,br(this,Qr)[Qr](r,s,e)}subscribe(e){return br(this,Qe)[Qe].add(e),()=>{br(this,Qe)[Qe].delete(e)}}}function $u(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];br(this,Qe)[Qe].forEach(s=>{s(...e)})}jn.VERSION=Mu.version;function Bn(t){const e=t.lastIndexOf(".");return e===-1||e===t.length-1?{name:t,extension:void 0}:{name:t.slice(0,e),extension:t.slice(e+1)}}const Oi={__proto__:null,md:"text/markdown",markdown:"text/markdown",mp4:"video/mp4",mp3:"audio/mp3",svg:"image/svg+xml",jpg:"image/jpeg",png:"image/png",webp:"image/webp",gif:"image/gif",heic:"image/heic",heif:"image/heif",yaml:"text/yaml",yml:"text/yaml",csv:"text/csv",tsv:"text/tab-separated-values",tab:"text/tab-separated-values",avi:"video/x-msvideo",mks:"video/x-matroska",mkv:"video/x-matroska",mov:"video/quicktime",dicom:"application/dicom",doc:"application/msword",msg:"application/vnd.ms-outlook",docm:"application/vnd.ms-word.document.macroenabled.12",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dot:"application/msword",dotm:"application/vnd.ms-word.template.macroenabled.12",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",xla:"application/vnd.ms-excel",xlam:"application/vnd.ms-excel.addin.macroenabled.12",xlc:"application/vnd.ms-excel",xlf:"application/x-xliff+xml",xlm:"application/vnd.ms-excel",xls:"application/vnd.ms-excel",xlsb:"application/vnd.ms-excel.sheet.binary.macroenabled.12",xlsm:"application/vnd.ms-excel.sheet.macroenabled.12",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlt:"application/vnd.ms-excel",xltm:"application/vnd.ms-excel.template.macroenabled.12",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xlw:"application/vnd.ms-excel",txt:"text/plain",text:"text/plain",conf:"text/plain",log:"text/plain",pdf:"application/pdf",zip:"application/zip","7z":"application/x-7z-compressed",rar:"application/x-rar-compressed",tar:"application/x-tar",gz:"application/gzip",dmg:"application/x-apple-diskimage"};function In(t){var e;if(t.type)return t.type;const r=t.name?(e=Bn(t.name).extension)==null?void 0:e.toLowerCase():null;return r&&r in Oi?Oi[r]:"application/octet-stream"}function Nu(t){return t.charCodeAt(0).toString(32)}function Fi(t){let e="";return t.replace(/[^A-Z0-9]/gi,r=>(e+=`-${Nu(r)}`,"/"))+e}function Lu(t,e){let r=e||"uppy";return typeof t.name=="string"&&(r+=`-${Fi(t.name.toLowerCase())}`),t.type!==void 0&&(r+=`-${t.type}`),t.meta&&typeof t.meta.relativePath=="string"&&(r+=`-${Fi(t.meta.relativePath.toLowerCase())}`),t.data.size!==void 0&&(r+=`-${t.data.size}`),t.data.lastModified!==void 0&&(r+=`-${t.data.lastModified}`),r}function ju(t){return!t.isRemote||!t.remote?!1:new Set(["box","dropbox","drive","facebook","unsplash"]).has(t.remote.provider)}function Bu(t,e){if(ju(t))return t.id;const r=In(t);return Lu({...t,type:r},e)}function Iu(t){if(t==null&&typeof navigator<"u"&&(t=navigator.userAgent),!t)return!0;const e=/Edge\/(\d+\.\d+)/.exec(t);if(!e)return!0;const s=e[1].split(".",2),i=parseInt(s[0],10),n=parseInt(s[1],10);return i<15||i===15&&n<15063||i>18||i===18&&n>=18218}function Du(t,e){return e.name?e.name:t.split("/")[0]==="image"?`${t.split("/")[0]}.${t.split("/")[1]}`:"noname"}function Zr(t){return t<10?`0${t}`:t.toString()}function wr(){const t=new Date,e=Zr(t.getHours()),r=Zr(t.getMinutes()),s=Zr(t.getSeconds());return`${e}:${r}:${s}`}const zu={debug:()=>{},warn:()=>{},error:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return console.error(`[Uppy] [${wr()}]`,...e)}},qu={debug:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return console.debug(`[Uppy] [${wr()}]`,...e)},warn:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return console.warn(`[Uppy] [${wr()}]`,...e)},error:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return console.error(`[Uppy] [${wr()}]`,...e)}};var Hu=function(e){if(typeof e!="number"||Number.isNaN(e))throw new TypeError(`Expected a number, got ${typeof e}`);const r=e<0;let s=Math.abs(e);if(r&&(s=-s),s===0)return"0 B";const i=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],n=Math.min(Math.floor(Math.log(s)/Math.log(1024)),i.length-1),o=Number(s/1024**n),a=i[n];return`${o>=10||o%1===0?Math.round(o):o.toFixed(1)} ${a}`};const ft=_t(Hu);function Dn(t,e){this.text=t=t||"",this.hasWild=~t.indexOf("*"),this.separator=e,this.parts=t.split(e)}Dn.prototype.match=function(t){var e=!0,r=this.parts,s,i=r.length,n;if(typeof t=="string"||t instanceof String)if(!this.hasWild&&this.text!=t)e=!1;else{for(n=(t||"").split(this.separator),s=0;e&&s<i;s++)r[s]!=="*"&&(s<n.length?e=r[s]===n[s]:e=!1);e=e&&n}else if(typeof t.splice=="function")for(e=[],s=t.length;s--;)this.match(t[s])&&(e[e.length]=t[s]);else if(typeof t=="object"){e={};for(var o in t)this.match(o)&&(e[o]=t[o])}return e};var Gu=function(t,e,r){var s=new Dn(t,r||/[\/\.]/);return typeof e<"u"?s.match(e):s},Wu=Gu,Vu=/[\/\+\.]/,Ju=function(t,e){function r(s){var i=Wu(s,t,Vu);return i&&i.length>=2}return e?r(e.split(";")[0]):r};const Ku=_t(Ju),Xu={maxFileSize:null,minFileSize:null,maxTotalFileSize:null,maxNumberOfFiles:null,minNumberOfFiles:null,allowedFileTypes:null,requiredMetaFields:[]};class me extends Error{constructor(e,r){var s;super(e),this.isRestriction=!0,this.isUserFacing=(s=r==null?void 0:r.isUserFacing)!=null?s:!0,r!=null&&r.file&&(this.file=r.file)}}class Yu{constructor(e,r){this.getI18n=r,this.getOpts=()=>{var s;const i=e();if(((s=i.restrictions)==null?void 0:s.allowedFileTypes)!=null&&!Array.isArray(i.restrictions.allowedFileTypes))throw new TypeError("`restrictions.allowedFileTypes` must be an array");return i}}validateAggregateRestrictions(e,r){const{maxTotalFileSize:s,maxNumberOfFiles:i}=this.getOpts().restrictions;if(i&&e.filter(o=>!o.isGhost).length+r.length>i)throw new me(`${this.getI18n()("youCanOnlyUploadX",{smart_count:i})}`);if(s){const n=[...e,...r].reduce((o,a)=>{var l;return o+((l=a.size)!=null?l:0)},0);if(n>s)throw new me(this.getI18n()("aggregateExceedsSize",{sizeAllowed:ft(s),size:ft(n)}))}}validateSingleFile(e){const{maxFileSize:r,minFileSize:s,allowedFileTypes:i}=this.getOpts().restrictions;if(i&&!i.some(a=>a.includes("/")?e.type?Ku(e.type.replace(/;.*?$/,""),a):!1:a[0]==="."&&e.extension?e.extension.toLowerCase()===a.slice(1).toLowerCase():!1)){const a=i.join(", ");throw new me(this.getI18n()("youCanOnlyUploadFileTypes",{types:a}),{file:e})}if(r&&e.size!=null&&e.size>r){var n;throw new me(this.getI18n()("exceedsSize",{size:ft(r),file:(n=e.name)!=null?n:this.getI18n()("unnamed")}),{file:e})}if(s&&e.size!=null&&e.size<s)throw new me(this.getI18n()("inferiorSize",{size:ft(s)}),{file:e})}validate(e,r){r.forEach(s=>{this.validateSingleFile(s)}),this.validateAggregateRestrictions(e,r)}validateMinNumberOfFiles(e){const{minNumberOfFiles:r}=this.getOpts().restrictions;if(r&&Object.keys(e).length<r)throw new me(this.getI18n()("youHaveToAtLeastSelectX",{smart_count:r}))}getMissingRequiredMetaFields(e){var r;const s=new me(this.getI18n()("missingRequiredMetaFieldOnFile",{fileName:(r=e.name)!=null?r:this.getI18n()("unnamed")})),{requiredMetaFields:i}=this.getOpts().restrictions,n=[];for(const o of i)(!Object.hasOwn(e.meta,o)||e.meta[o]==="")&&n.push(o);return{missingFields:n,error:s}}}const Qu={strings:{addBulkFilesFailed:{0:"Failed to add %{smart_count} file due to an internal error",1:"Failed to add %{smart_count} files due to internal errors"},youCanOnlyUploadX:{0:"You can only upload %{smart_count} file",1:"You can only upload %{smart_count} files"},youHaveToAtLeastSelectX:{0:"You have to select at least %{smart_count} file",1:"You have to select at least %{smart_count} files"},aggregateExceedsSize:"You selected %{size} of files, but maximum allowed size is %{sizeAllowed}",exceedsSize:"%{file} exceeds maximum allowed size of %{size}",missingRequiredMetaField:"Missing required meta fields",missingRequiredMetaFieldOnFile:"Missing required meta fields in %{fileName}",inferiorSize:"This file is smaller than the allowed size of %{size}",youCanOnlyUploadFileTypes:"You can only upload: %{types}",noMoreFilesAllowed:"Cannot add more files",noDuplicates:"Cannot add the duplicate file '%{fileName}', it already exists",companionError:"Connection with Companion failed",authAborted:"Authentication aborted",companionUnauthorizeHint:"To unauthorize to your %{provider} account, please go to %{url}",failedToUpload:"Failed to upload %{file}",noInternetConnection:"No Internet connection",connectedToInternet:"Connected to the Internet",noFilesFound:"You have no files or folders here",noSearchResults:"Unfortunately, there are no results for this search",selectX:{0:"Select %{smart_count}",1:"Select %{smart_count}"},allFilesFromFolderNamed:"All files from folder %{name}",openFolderNamed:"Open folder %{name}",cancel:"Cancel",logOut:"Log out",logIn:"Log in",pickFiles:"Pick files",pickPhotos:"Pick photos",filter:"Filter",resetFilter:"Reset filter",loading:"Loading...",loadedXFiles:"Loaded %{numFiles} files",authenticateWithTitle:"Please authenticate with %{pluginName} to select files",authenticateWith:"Connect to %{pluginName}",signInWithGoogle:"Sign in with Google",searchImages:"Search for images",enterTextToSearch:"Enter text to search for images",search:"Search",resetSearch:"Reset search",emptyFolderAdded:"No files were added from empty folder",addedNumFiles:"Added %{numFiles} file(s)",folderAlreadyAdded:'The folder "%{folder}" was already added',folderAdded:{0:"Added %{smart_count} file from %{folder}",1:"Added %{smart_count} files from %{folder}"},additionalRestrictionsFailed:"%{count} additional restrictions were not fulfilled",unnamed:"Unnamed",pleaseWait:"Please wait"}};function _(t,e){if(!{}.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var Zu=0;function M(t){return"__private_"+Zu+++"_"+t}const ec={version:"4.4.7"},pr={totalProgress:0,allowNewUpload:!0,error:null,recoveredState:null};var D=M("plugins"),G=M("restricter"),At=M("storeUnsubscribe"),Ee=M("emitter"),Ze=M("preProcessors"),et=M("uploaders"),$e=M("postProcessors"),ce=M("informAndEmit"),sr=M("checkRequiredMetaFieldsOnFile"),es=M("checkRequiredMetaFields"),Ot=M("assertNewUploadAllowed"),ks=M("transformFile"),Ft=M("startIfAutoProceed"),kt=M("checkAndUpdateFileState"),Qt=M("getFilesToRetry"),Ut=M("doRetryAll"),Us=M("handleUploadProgress"),Rt=M("updateTotalProgress"),Ne=M("updateTotalProgressThrottled"),Rs=M("calculateTotalProgress"),ts=M("addListeners"),ye=M("updateOnlineStatus"),Ct=M("requestClientById"),Ue=M("createUpload"),rs=M("getUpload"),lt=M("removeUpload"),Re=M("runUpload");class Dr{constructor(e){Object.defineProperty(this,Re,{value:gc}),Object.defineProperty(this,lt,{value:mc}),Object.defineProperty(this,rs,{value:fc}),Object.defineProperty(this,Ue,{value:hc}),Object.defineProperty(this,ts,{value:pc}),Object.defineProperty(this,Rs,{value:dc}),Object.defineProperty(this,Rt,{value:cc}),Object.defineProperty(this,Ut,{value:uc}),Object.defineProperty(this,Qt,{value:lc}),Object.defineProperty(this,kt,{value:ac}),Object.defineProperty(this,Ft,{value:oc}),Object.defineProperty(this,ks,{value:nc}),Object.defineProperty(this,Ot,{value:ic}),Object.defineProperty(this,es,{value:sc}),Object.defineProperty(this,sr,{value:rc}),Object.defineProperty(this,ce,{value:tc}),Object.defineProperty(this,D,{writable:!0,value:Object.create(null)}),Object.defineProperty(this,G,{writable:!0,value:void 0}),Object.defineProperty(this,At,{writable:!0,value:void 0}),Object.defineProperty(this,Ee,{writable:!0,value:Tl()}),Object.defineProperty(this,Ze,{writable:!0,value:new Set}),Object.defineProperty(this,et,{writable:!0,value:new Set}),Object.defineProperty(this,$e,{writable:!0,value:new Set}),this.scheduledAutoProceed=null,this.wasOffline=!1,Object.defineProperty(this,Us,{writable:!0,value:(i,n)=>{const o=i?this.getFile(i.id):void 0;if(i==null||!o){this.log(`Not setting progress for a file that has been removed: ${i==null?void 0:i.id}`);return}if(o.progress.percentage===100){this.log(`Not setting progress for a file that has been already uploaded: ${i.id}`);return}const a={bytesTotal:n.bytesTotal,percentage:n.bytesTotal!=null&&Number.isFinite(n.bytesTotal)&&n.bytesTotal>0?Math.round(n.bytesUploaded/n.bytesTotal*100):void 0};o.progress.uploadStarted!=null?this.setFileState(i.id,{progress:{...o.progress,...a,bytesUploaded:n.bytesUploaded}}):this.setFileState(i.id,{progress:{...o.progress,...a}}),_(this,Ne)[Ne]()}}),Object.defineProperty(this,Ne,{writable:!0,value:Cu(()=>_(this,Rt)[Rt](),500,{leading:!0,trailing:!0})}),Object.defineProperty(this,ye,{writable:!0,value:this.updateOnlineStatus.bind(this)}),Object.defineProperty(this,Ct,{writable:!0,value:new Map}),this.defaultLocale=Qu;const r={id:"uppy",autoProceed:!1,allowMultipleUploadBatches:!0,debug:!1,restrictions:Xu,meta:{},onBeforeFileAdded:(i,n)=>!Object.hasOwn(n,i.id),onBeforeUpload:i=>i,store:new jn,logger:zu,infoTimeout:5e3},s={...r,...e};this.opts={...s,restrictions:{...r.restrictions,...e&&e.restrictions}},e&&e.logger&&e.debug?this.log("You are using a custom `logger`, but also set `debug: true`, which uses built-in logger to output logs to console. Ignoring `debug: true` and using your custom `logger`.","warning"):e&&e.debug&&(this.opts.logger=qu),this.log(`Using Core v${Dr.VERSION}`),this.i18nInit(),this.store=this.opts.store,this.setState({...pr,plugins:{},files:{},currentUploads:{},capabilities:{uploadProgress:Iu(),individualCancellation:!0,resumableUploads:!1},meta:{...this.opts.meta},info:[]}),_(this,G)[G]=new Yu(()=>this.opts,()=>this.i18n),_(this,At)[At]=this.store.subscribe((i,n,o)=>{this.emit("state-update",i,n,o),this.updateAll(n)}),this.opts.debug&&typeof window<"u"&&(window[this.opts.id]=this),_(this,ts)[ts]()}emit(e){for(var r=arguments.length,s=new Array(r>1?r-1:0),i=1;i<r;i++)s[i-1]=arguments[i];_(this,Ee)[Ee].emit(e,...s)}on(e,r){return _(this,Ee)[Ee].on(e,r),this}once(e,r){return _(this,Ee)[Ee].once(e,r),this}off(e,r){return _(this,Ee)[Ee].off(e,r),this}updateAll(e){this.iteratePlugins(r=>{r.update(e)})}setState(e){this.store.setState(e)}getState(){return this.store.getState()}patchFilesState(e){const r=this.getState().files;this.setState({files:{...r,...Object.fromEntries(Object.entries(e).map(s=>{let[i,n]=s;return[i,{...r[i],...n}]}))}})}setFileState(e,r){if(!this.getState().files[e])throw new Error(`Cant set state for ${e} (the file could have been removed)`);this.patchFilesState({[e]:r})}i18nInit(){const e=s=>this.log(`Missing i18n string: ${s}`,"error"),r=new xn([this.defaultLocale,this.opts.locale],{onMissingKey:e});this.i18n=r.translate.bind(r),this.i18nArray=r.translateArray.bind(r),this.locale=r.locale}setOptions(e){this.opts={...this.opts,...e,restrictions:{...this.opts.restrictions,...e==null?void 0:e.restrictions}},e.meta&&this.setMeta(e.meta),this.i18nInit(),e.locale&&this.iteratePlugins(r=>{r.setOptions(e)}),this.setState(void 0)}resetProgress(){const e={percentage:0,bytesUploaded:!1,uploadComplete:!1,uploadStarted:null},r={...this.getState().files},s=Object.create(null);Object.keys(r).forEach(i=>{s[i]={...r[i],progress:{...r[i].progress,...e},tus:void 0,transloadit:void 0}}),this.setState({files:s,...pr})}clear(){const{capabilities:e,currentUploads:r}=this.getState();if(Object.keys(r).length>0&&!e.individualCancellation)throw new Error("The installed uploader plugin does not allow removing files during an upload.");this.setState({...pr,files:{}})}addPreProcessor(e){_(this,Ze)[Ze].add(e)}removePreProcessor(e){return _(this,Ze)[Ze].delete(e)}addPostProcessor(e){_(this,$e)[$e].add(e)}removePostProcessor(e){return _(this,$e)[$e].delete(e)}addUploader(e){_(this,et)[et].add(e)}removeUploader(e){return _(this,et)[et].delete(e)}setMeta(e){const r={...this.getState().meta,...e},s={...this.getState().files};Object.keys(s).forEach(i=>{s[i]={...s[i],meta:{...s[i].meta,...e}}}),this.log("Adding metadata:"),this.log(e),this.setState({meta:r,files:s})}setFileMeta(e,r){const s={...this.getState().files};if(!s[e]){this.log(`Was trying to set metadata for a file that has been removed: ${e}`);return}const i={...s[e].meta,...r};s[e]={...s[e],meta:i},this.setState({files:s})}getFile(e){return this.getState().files[e]}getFiles(){const{files:e}=this.getState();return Object.values(e)}getFilesByIds(e){return e.map(r=>this.getFile(r))}getObjectOfFilesPerState(){const{files:e,totalProgress:r,error:s}=this.getState(),i=Object.values(e),n=[],o=[],a=[],l=[],u=[],d=[],c=[],m=[],h=[];for(const f of i){const{progress:y}=f;!y.uploadComplete&&y.uploadStarted&&(n.push(f),f.isPaused||m.push(f)),y.uploadStarted||o.push(f),(y.uploadStarted||y.preprocess||y.postprocess)&&a.push(f),y.uploadStarted&&l.push(f),f.isPaused&&u.push(f),y.uploadComplete&&d.push(f),f.error&&c.push(f),(y.preprocess||y.postprocess)&&h.push(f)}return{newFiles:o,startedFiles:a,uploadStartedFiles:l,pausedFiles:u,completeFiles:d,erroredFiles:c,inProgressFiles:n,inProgressNotPausedFiles:m,processingFiles:h,isUploadStarted:l.length>0,isAllComplete:r===100&&d.length===i.length&&h.length===0,isAllErrored:!!s&&c.length===i.length,isAllPaused:n.length!==0&&u.length===n.length,isUploadInProgress:n.length>0,isSomeGhost:i.some(f=>f.isGhost)}}validateRestrictions(e,r){r===void 0&&(r=this.getFiles());try{_(this,G)[G].validate(r,[e])}catch(s){return s}return null}validateSingleFile(e){try{_(this,G)[G].validateSingleFile(e)}catch(r){return r.message}return null}validateAggregateRestrictions(e){const r=this.getFiles();try{_(this,G)[G].validateAggregateRestrictions(r,e)}catch(s){return s.message}return null}checkIfFileAlreadyExists(e){const{files:r}=this.getState();return!!(r[e]&&!r[e].isGhost)}addFile(e){_(this,Ot)[Ot](e);const{nextFilesState:r,validFilesToAdd:s,errors:i}=_(this,kt)[kt]([e]),n=i.filter(a=>a.isRestriction);if(_(this,ce)[ce](n),i.length>0)throw i[0];this.setState({files:r});const[o]=s;return this.emit("file-added",o),this.emit("files-added",s),this.log(`Added file: ${o.name}, ${o.id}, mime type: ${o.type}`),_(this,Ft)[Ft](),o.id}addFiles(e){_(this,Ot)[Ot]();const{nextFilesState:r,validFilesToAdd:s,errors:i}=_(this,kt)[kt](e),n=i.filter(a=>a.isRestriction);_(this,ce)[ce](n);const o=i.filter(a=>!a.isRestriction);if(o.length>0){let a=`Multiple errors occurred while adding files:
`;if(o.forEach(l=>{a+=`
 * ${l.message}`}),this.info({message:this.i18n("addBulkFilesFailed",{smart_count:o.length}),details:a},"error",this.opts.infoTimeout),typeof AggregateError=="function")throw new AggregateError(o,a);{const l=new Error(a);throw l.errors=o,l}}this.setState({files:r}),s.forEach(a=>{this.emit("file-added",a)}),this.emit("files-added",s),s.length>5?this.log(`Added batch of ${s.length} files`):Object.values(s).forEach(a=>{this.log(`Added file: ${a.name}
 id: ${a.id}
 type: ${a.type}`)}),s.length>0&&_(this,Ft)[Ft]()}removeFiles(e){const{files:r,currentUploads:s}=this.getState(),i={...r},n={...s},o=Object.create(null);e.forEach(d=>{r[d]&&(o[d]=r[d],delete i[d])});function a(d){return o[d]===void 0}Object.keys(n).forEach(d=>{const c=s[d].fileIDs.filter(a);if(c.length===0){delete n[d];return}const{capabilities:m}=this.getState();if(c.length!==s[d].fileIDs.length&&!m.individualCancellation)throw new Error("The installed uploader plugin does not allow removing files during an upload.");n[d]={...s[d],fileIDs:c}});const l={currentUploads:n,files:i};Object.keys(i).length===0&&(l.allowNewUpload=!0,l.error=null,l.recoveredState=null),this.setState(l),_(this,Ne)[Ne]();const u=Object.keys(o);u.forEach(d=>{this.emit("file-removed",o[d])}),u.length>5?this.log(`Removed ${u.length} files`):this.log(`Removed files: ${u.join(", ")}`)}removeFile(e){this.removeFiles([e])}pauseResume(e){if(!this.getState().capabilities.resumableUploads||this.getFile(e).progress.uploadComplete)return;const r=this.getFile(e),i=!(r.isPaused||!1);return this.setFileState(e,{isPaused:i}),this.emit("upload-pause",r,i),i}pauseAll(){const e={...this.getState().files};Object.keys(e).filter(s=>!e[s].progress.uploadComplete&&e[s].progress.uploadStarted).forEach(s=>{const i={...e[s],isPaused:!0};e[s]=i}),this.setState({files:e}),this.emit("pause-all")}resumeAll(){const e={...this.getState().files};Object.keys(e).filter(s=>!e[s].progress.uploadComplete&&e[s].progress.uploadStarted).forEach(s=>{const i={...e[s],isPaused:!1,error:null};e[s]=i}),this.setState({files:e}),this.emit("resume-all")}async retryAll(){const e=await _(this,Ut)[Ut]();return this.emit("complete",e),e}cancelAll(){this.emit("cancel-all");const{files:e}=this.getState(),r=Object.keys(e);r.length&&this.removeFiles(r),this.setState(pr)}retryUpload(e){this.setFileState(e,{error:null,isPaused:!1}),this.emit("upload-retry",this.getFile(e));const r=_(this,Ue)[Ue]([e],{forceAllowNewUpload:!0});return _(this,Re)[Re](r)}logout(){this.iteratePlugins(e=>{var r;(r=e.provider)==null||r.logout==null||r.logout()})}[Symbol.for("uppy test: updateTotalProgress")](){return _(this,Rt)[Rt]()}updateOnlineStatus(){var e;((e=window.navigator.onLine)!=null?e:!0)?(this.emit("is-online"),this.wasOffline&&(this.emit("back-online"),this.info(this.i18n("connectedToInternet"),"success",3e3),this.wasOffline=!1)):(this.emit("is-offline"),this.info(this.i18n("noInternetConnection"),"error",0),this.wasOffline=!0)}getID(){return this.opts.id}use(e){if(typeof e!="function"){const l=`Expected a plugin class, but got ${e===null?"null":typeof e}. Please verify that the plugin was imported and spelled correctly.`;throw new TypeError(l)}for(var r=arguments.length,s=new Array(r>1?r-1:0),i=1;i<r;i++)s[i-1]=arguments[i];const n=new e(this,...s),o=n.id;if(!o)throw new Error("Your plugin must have an id");if(!n.type)throw new Error("Your plugin must have a type");const a=this.getPlugin(o);if(a){const l=`Already found a plugin named '${a.id}'. Tried to use: '${o}'.
Uppy plugins must have unique \`id\` options.`;throw new Error(l)}return e.VERSION&&this.log(`Using ${o} v${e.VERSION}`),n.type in _(this,D)[D]?_(this,D)[D][n.type].push(n):_(this,D)[D][n.type]=[n],n.install(),this.emit("plugin-added",n),this}getPlugin(e){for(const r of Object.values(_(this,D)[D])){const s=r.find(i=>i.id===e);if(s!=null)return s}}[Symbol.for("uppy test: getPlugins")](e){return _(this,D)[D][e]}iteratePlugins(e){Object.values(_(this,D)[D]).flat(1).forEach(e)}removePlugin(e){this.log(`Removing plugin ${e.id}`),this.emit("plugin-remove",e),e.uninstall&&e.uninstall();const r=_(this,D)[D][e.type],s=r.findIndex(o=>o.id===e.id);s!==-1&&r.splice(s,1);const n={plugins:{...this.getState().plugins,[e.id]:void 0}};this.setState(n)}destroy(){this.log(`Closing Uppy instance ${this.opts.id}: removing all files and uninstalling plugins`),this.cancelAll(),_(this,At)[At](),this.iteratePlugins(e=>{this.removePlugin(e)}),typeof window<"u"&&window.removeEventListener&&(window.removeEventListener("online",_(this,ye)[ye]),window.removeEventListener("offline",_(this,ye)[ye]))}hideInfo(){const{info:e}=this.getState();this.setState({info:e.slice(1)}),this.emit("info-hidden")}info(e,r,s){r===void 0&&(r="info"),s===void 0&&(s=3e3);const i=typeof e=="object";this.setState({info:[...this.getState().info,{type:r,message:i?e.message:e,details:i?e.details:null}]}),setTimeout(()=>this.hideInfo(),s),this.emit("info-visible")}log(e,r){const{logger:s}=this.opts;switch(r){case"error":s.error(e);break;case"warning":s.warn(e);break;default:s.debug(e);break}}registerRequestClient(e,r){_(this,Ct)[Ct].set(e,r)}getRequestClientForFile(e){if(!e.remote)throw new Error(`Tried to get RequestClient for a non-remote file ${e.id}`);const r=_(this,Ct)[Ct].get(e.remote.requestClientId);if(r==null)throw new Error(`requestClientId "${e.remote.requestClientId}" not registered for file "${e.id}"`);return r}restore(e){return this.log(`Core: attempting to restore upload "${e}"`),this.getState().currentUploads[e]?_(this,Re)[Re](e):(_(this,lt)[lt](e),Promise.reject(new Error("Nonexistent upload")))}[Symbol.for("uppy test: createUpload")](){return _(this,Ue)[Ue](...arguments)}addResultData(e,r){if(!_(this,rs)[rs](e)){this.log(`Not setting result for an upload that has been removed: ${e}`);return}const{currentUploads:s}=this.getState(),i={...s[e],result:{...s[e].result,...r}};this.setState({currentUploads:{...s,[e]:i}})}async upload(){var e;(e=_(this,D)[D].uploader)!=null&&e.length||this.log("No uploader type plugins are used","warning");let{files:r}=this.getState();if(_(this,Qt)[Qt]().length>0){const n=await _(this,Ut)[Ut]();if(!(this.getFiles().filter(a=>a.progress.uploadStarted==null).length>0))return this.emit("complete",n),n;({files:r}=this.getState())}const i=this.opts.onBeforeUpload(r);return i===!1?Promise.reject(new Error("Not starting the upload because onBeforeUpload returned false")):(i&&typeof i=="object"&&(r=i,this.setState({files:r})),Promise.resolve().then(()=>_(this,G)[G].validateMinNumberOfFiles(r)).catch(n=>{throw _(this,ce)[ce]([n]),n}).then(()=>{if(!_(this,es)[es](r))throw new me(this.i18n("missingRequiredMetaField"))}).catch(n=>{throw n}).then(async()=>{const{currentUploads:n}=this.getState(),o=Object.values(n).flatMap(d=>d.fileIDs),a=[];Object.keys(r).forEach(d=>{const c=this.getFile(d);!c.progress.uploadStarted&&o.indexOf(d)===-1&&a.push(c.id)});const l=_(this,Ue)[Ue](a),u=await _(this,Re)[Re](l);return this.emit("complete",u),u}).catch(n=>{throw this.emit("error",n),this.log(n,"error"),n}))}}function tc(t){for(const n of t)n.isRestriction?this.emit("restriction-failed",n.file,n):this.emit("error",n,n.file),this.log(n,"warning");const e=t.filter(n=>n.isUserFacing),r=4,s=e.slice(0,r),i=e.slice(r);s.forEach(n=>{let{message:o,details:a=""}=n;this.info({message:o,details:a},"error",this.opts.infoTimeout)}),i.length>0&&this.info({message:this.i18n("additionalRestrictionsFailed",{count:i.length})})}function rc(t){const{missingFields:e,error:r}=_(this,G)[G].getMissingRequiredMetaFields(t);return e.length>0?(this.setFileState(t.id,{missingRequiredMetaFields:e}),this.log(r.message),this.emit("restriction-failed",t,r),!1):(e.length===0&&t.missingRequiredMetaFields&&this.setFileState(t.id,{missingRequiredMetaFields:[]}),!0)}function sc(t){let e=!0;for(const r of Object.values(t))_(this,sr)[sr](r)||(e=!1);return e}function ic(t){const{allowNewUpload:e}=this.getState();if(e===!1){const r=new me(this.i18n("noMoreFilesAllowed"),{file:t});throw _(this,ce)[ce]([r]),r}}function nc(t){const e=t instanceof File?{name:t.name,type:t.type,size:t.size,data:t}:t,r=In(e),s=Du(r,e),i=Bn(s).extension,n=Bu(e,this.getID()),o=e.meta||{};o.name=s,o.type=r;const a=Number.isFinite(e.data.size)?e.data.size:null;return{source:e.source||"",id:n,name:s,extension:i||"",meta:{...this.getState().meta,...o},type:r,data:e.data,progress:{percentage:0,bytesUploaded:!1,bytesTotal:a,uploadComplete:!1,uploadStarted:null},size:a,isGhost:!1,isRemote:e.isRemote||!1,remote:e.remote,preview:e.preview}}function oc(){this.opts.autoProceed&&!this.scheduledAutoProceed&&(this.scheduledAutoProceed=setTimeout(()=>{this.scheduledAutoProceed=null,this.upload().catch(t=>{t.isRestriction||this.log(t.stack||t.message||t)})},4))}function ac(t){const{files:e}=this.getState(),r={...e},s=[],i=[];for(const a of t)try{var n;let l=_(this,ks)[ks](a);const u=(n=e[l.id])==null?void 0:n.isGhost;u&&(l={...e[l.id],isGhost:!1,data:a.data},this.log(`Replaced the blob in the restored ghost file: ${l.name}, ${l.id}`));const d=this.opts.onBeforeFileAdded(l,r);if(!d&&this.checkIfFileAlreadyExists(l.id)){var o;throw new me(this.i18n("noDuplicates",{fileName:(o=l.name)!=null?o:this.i18n("unnamed")}),{file:a})}if(d===!1&&!u)throw new me("Cannot add the file because onBeforeFileAdded returned false.",{isUserFacing:!1,file:a});typeof d=="object"&&d!==null&&(l=d),_(this,G)[G].validateSingleFile(l),r[l.id]=l,s.push(l)}catch(l){i.push(l)}try{_(this,G)[G].validateAggregateRestrictions(Object.values(e),s)}catch(a){return i.push(a),{nextFilesState:e,validFilesToAdd:[],errors:i}}return{nextFilesState:r,validFilesToAdd:s,errors:i}}function lc(){const{files:t}=this.getState();return Object.keys(t).filter(e=>t[e].error)}async function uc(){const t=_(this,Qt)[Qt](),e={...this.getState().files};if(t.forEach(s=>{e[s]={...e[s],isPaused:!1,error:null}}),this.setState({files:e,error:null}),this.emit("retry-all",this.getFilesByIds(t)),t.length===0)return{successful:[],failed:[]};const r=_(this,Ue)[Ue](t,{forceAllowNewUpload:!0});return _(this,Re)[Re](r)}function cc(){var t,e;const r=_(this,Rs)[Rs]();let s=null;r!=null&&(s=Math.round(r*100),s>100?s=100:s<0&&(s=0)),this.emit("progress",(t=s)!=null?t:0),this.setState({totalProgress:(e=s)!=null?e:0})}function dc(){const e=this.getFiles().filter(a=>a.progress.uploadStarted||a.progress.preprocess||a.progress.postprocess);if(e.length===0)return 0;if(e.every(a=>a.progress.uploadComplete))return 1;const r=a=>a.progress.bytesTotal!=null&&a.progress.bytesTotal!==0,s=e.filter(r),i=e.filter(a=>!r(a));if(s.every(a=>a.progress.uploadComplete)&&i.length>0&&!i.every(a=>a.progress.uploadComplete))return null;const n=s.reduce((a,l)=>{var u;return a+((u=l.progress.bytesTotal)!=null?u:0)},0),o=s.reduce((a,l)=>a+(l.progress.bytesUploaded||0),0);return n===0?0:o/n}function pc(){const t=(s,i,n)=>{let o=s.message||"Unknown error";s.details&&(o+=` ${s.details}`),this.setState({error:o}),i!=null&&i.id in this.getState().files&&this.setFileState(i.id,{error:o,response:n})};this.on("error",t),this.on("upload-error",(s,i,n)=>{if(t(i,s,n),typeof i=="object"&&i.message){var o;this.log(i.message,"error");const a=new Error(this.i18n("failedToUpload",{file:(o=s==null?void 0:s.name)!=null?o:""}));a.isUserFacing=!0,a.details=i.message,i.details&&(a.details+=` ${i.details}`),_(this,ce)[ce]([a])}else _(this,ce)[ce]([i])});let e=null;this.on("upload-stalled",(s,i)=>{const{message:n}=s,o=i.map(a=>a.meta.name).join(", ");e||(this.info({message:n,details:o},"warning",this.opts.infoTimeout),e=setTimeout(()=>{e=null},this.opts.infoTimeout)),this.log(`${n} ${o}`.trim(),"warning")}),this.on("upload",()=>{this.setState({error:null})});const r=s=>{const i=s.filter(o=>{const a=o!=null&&this.getFile(o.id);return a||this.log(`Not setting progress for a file that has been removed: ${o==null?void 0:o.id}`),a}),n=Object.fromEntries(i.map(o=>[o.id,{progress:{uploadStarted:Date.now(),uploadComplete:!1,bytesUploaded:0,bytesTotal:o.size}}]));this.patchFilesState(n)};this.on("upload-start",r),this.on("upload-progress",_(this,Us)[Us]),this.on("upload-success",(s,i)=>{if(s==null||!this.getFile(s.id)){this.log(`Not setting progress for a file that has been removed: ${s==null?void 0:s.id}`);return}const n=this.getFile(s.id).progress;this.setFileState(s.id,{progress:{...n,postprocess:_(this,$e)[$e].size>0?{mode:"indeterminate"}:void 0,uploadComplete:!0,percentage:100,bytesUploaded:n.bytesTotal},response:i,uploadURL:i.uploadURL,isPaused:!1}),s.size==null&&this.setFileState(s.id,{size:i.bytesUploaded||n.bytesTotal}),_(this,Ne)[Ne]()}),this.on("preprocess-progress",(s,i)=>{if(s==null||!this.getFile(s.id)){this.log(`Not setting progress for a file that has been removed: ${s==null?void 0:s.id}`);return}this.setFileState(s.id,{progress:{...this.getFile(s.id).progress,preprocess:i}})}),this.on("preprocess-complete",s=>{if(s==null||!this.getFile(s.id)){this.log(`Not setting progress for a file that has been removed: ${s==null?void 0:s.id}`);return}const i={...this.getState().files};i[s.id]={...i[s.id],progress:{...i[s.id].progress}},delete i[s.id].progress.preprocess,this.setState({files:i})}),this.on("postprocess-progress",(s,i)=>{if(s==null||!this.getFile(s.id)){this.log(`Not setting progress for a file that has been removed: ${s==null?void 0:s.id}`);return}this.setFileState(s.id,{progress:{...this.getState().files[s.id].progress,postprocess:i}})}),this.on("postprocess-complete",s=>{if(s==null||!this.getFile(s.id)){this.log(`Not setting progress for a file that has been removed: ${s==null?void 0:s.id}`);return}const i={...this.getState().files};i[s.id]={...i[s.id],progress:{...i[s.id].progress}},delete i[s.id].progress.postprocess,this.setState({files:i})}),this.on("restored",()=>{_(this,Ne)[Ne]()}),this.on("dashboard:file-edit-complete",s=>{s&&_(this,sr)[sr](s)}),typeof window<"u"&&window.addEventListener&&(window.addEventListener("online",_(this,ye)[ye]),window.addEventListener("offline",_(this,ye)[ye]),setTimeout(_(this,ye)[ye],3e3))}function hc(t,e){e===void 0&&(e={});const{forceAllowNewUpload:r=!1}=e,{allowNewUpload:s,currentUploads:i}=this.getState();if(!s&&!r)throw new Error("Cannot create a new upload: already uploading.");const n=Ol();return this.emit("upload",n,this.getFilesByIds(t)),this.setState({allowNewUpload:this.opts.allowMultipleUploadBatches!==!1&&this.opts.allowMultipleUploads!==!1,currentUploads:{...i,[n]:{fileIDs:t,step:0,result:{}}}}),n}function fc(t){const{currentUploads:e}=this.getState();return e[t]}function mc(t){const e={...this.getState().currentUploads};delete e[t],this.setState({currentUploads:e})}async function gc(t){const e=()=>{const{currentUploads:n}=this.getState();return n[t]};let r=e();const s=[..._(this,Ze)[Ze],..._(this,et)[et],..._(this,$e)[$e]];try{for(let n=r.step||0;n<s.length&&r;n++){const o=s[n];this.setState({currentUploads:{...this.getState().currentUploads,[t]:{...r,step:n}}});const{fileIDs:a}=r;await o(a,t),r=e()}}catch(n){throw _(this,lt)[lt](t),n}if(r){r.fileIDs.forEach(l=>{const u=this.getFile(l);u&&u.progress.postprocess&&this.emit("postprocess-complete",u)});const n=r.fileIDs.map(l=>this.getFile(l)),o=n.filter(l=>!l.error),a=n.filter(l=>l.error);this.addResultData(t,{successful:o,failed:a,uploadID:t}),r=e()}let i;return r&&(i=r.result,_(this,lt)[lt](t)),i==null&&(this.log(`Not setting result for an upload that has been removed: ${t}`),i={successful:[],failed:[],uploadID:t}),i}Dr.VERSION=ec.version;const zn=Dr;var zr,R,qn,tt,ki,Hn,Gn,Wn,Js,Cs,xs,ir={},Vn=[],yc=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,ar=Array.isArray;function je(t,e){for(var r in e)t[r]=e[r];return t}function Ks(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function b(t,e,r){var s,i,n,o={};for(n in e)n=="key"?s=e[n]:n=="ref"?i=e[n]:o[n]=e[n];if(arguments.length>2&&(o.children=arguments.length>3?zr.call(arguments,2):r),typeof t=="function"&&t.defaultProps!=null)for(n in t.defaultProps)o[n]===void 0&&(o[n]=t.defaultProps[n]);return Sr(t,o,s,i,null)}function Sr(t,e,r,s,i){var n={type:t,props:e,key:r,ref:s,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i??++qn,__i:-1,__u:0};return i==null&&R.vnode!=null&&R.vnode(n),n}function mt(t){return t.children}function Be(t,e){this.props=t,this.context=e}function gt(t,e){if(e==null)return t.__?gt(t.__,t.__i+1):null;for(var r;e<t.__k.length;e++)if((r=t.__k[e])!=null&&r.__e!=null)return r.__e;return typeof t.type=="function"?gt(t):null}function Jn(t){var e,r;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((r=t.__k[e])!=null&&r.__e!=null){t.__e=t.__c.base=r.__e;break}return Jn(t)}}function Ui(t){(!t.__d&&(t.__d=!0)&&tt.push(t)&&!kr.__r++||ki!=R.debounceRendering)&&((ki=R.debounceRendering)||Hn)(kr)}function kr(){for(var t,e,r,s,i,n,o,a=1;tt.length;)tt.length>a&&tt.sort(Gn),t=tt.shift(),a=tt.length,t.__d&&(r=void 0,i=(s=(e=t).__v).__e,n=[],o=[],e.__P&&((r=je({},s)).__v=s.__v+1,R.vnode&&R.vnode(r),Xs(e.__P,r,s,e.__n,e.__P.namespaceURI,32&s.__u?[i]:null,n,i??gt(s),!!(32&s.__u),o),r.__v=s.__v,r.__.__k[r.__i]=r,Yn(n,r,o),r.__e!=i&&Jn(r)));kr.__r=0}function Kn(t,e,r,s,i,n,o,a,l,u,d){var c,m,h,f,y,g,v=s&&s.__k||Vn,S=e.length;for(l=vc(r,e,v,l,S),c=0;c<S;c++)(h=r.__k[c])!=null&&(m=h.__i==-1?ir:v[h.__i]||ir,h.__i=c,g=Xs(t,h,m,i,n,o,a,l,u,d),f=h.__e,h.ref&&m.ref!=h.ref&&(m.ref&&Ys(m.ref,null,h),d.push(h.ref,h.__c||f,h)),y==null&&f!=null&&(y=f),4&h.__u||m.__k===h.__k?l=Xn(h,l,t):typeof h.type=="function"&&g!==void 0?l=g:f&&(l=f.nextSibling),h.__u&=-7);return r.__e=y,l}function vc(t,e,r,s,i){var n,o,a,l,u,d=r.length,c=d,m=0;for(t.__k=new Array(i),n=0;n<i;n++)(o=e[n])!=null&&typeof o!="boolean"&&typeof o!="function"?(l=n+m,(o=t.__k[n]=typeof o=="string"||typeof o=="number"||typeof o=="bigint"||o.constructor==String?Sr(null,o,null,null,null):ar(o)?Sr(mt,{children:o},null,null,null):o.constructor==null&&o.__b>0?Sr(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o).__=t,o.__b=t.__b+1,a=null,(u=o.__i=_c(o,r,l,c))!=-1&&(c--,(a=r[u])&&(a.__u|=2)),a==null||a.__v==null?(u==-1&&(i>d?m--:i<d&&m++),typeof o.type!="function"&&(o.__u|=4)):u!=l&&(u==l-1?m--:u==l+1?m++:(u>l?m--:m++,o.__u|=4))):t.__k[n]=null;if(c)for(n=0;n<d;n++)(a=r[n])!=null&&!(2&a.__u)&&(a.__e==s&&(s=gt(a)),Zn(a,a));return s}function Xn(t,e,r){var s,i;if(typeof t.type=="function"){for(s=t.__k,i=0;s&&i<s.length;i++)s[i]&&(s[i].__=t,e=Xn(s[i],e,r));return e}t.__e!=e&&(e&&t.type&&!r.contains(e)&&(e=gt(t)),r.insertBefore(t.__e,e||null),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function Ur(t,e){return e=e||[],t==null||typeof t=="boolean"||(ar(t)?t.some(function(r){Ur(r,e)}):e.push(t)),e}function _c(t,e,r,s){var i,n,o=t.key,a=t.type,l=e[r];if(l===null&&t.key==null||l&&o==l.key&&a==l.type&&!(2&l.__u))return r;if(s>(l!=null&&!(2&l.__u)?1:0))for(i=r-1,n=r+1;i>=0||n<e.length;){if(i>=0){if((l=e[i])&&!(2&l.__u)&&o==l.key&&a==l.type)return i;i--}if(n<e.length){if((l=e[n])&&!(2&l.__u)&&o==l.key&&a==l.type)return n;n++}}return-1}function Ri(t,e,r){e[0]=="-"?t.setProperty(e,r??""):t[e]=r==null?"":typeof r!="number"||yc.test(e)?r:r+"px"}function hr(t,e,r,s,i){var n,o;e:if(e=="style")if(typeof r=="string")t.style.cssText=r;else{if(typeof s=="string"&&(t.style.cssText=s=""),s)for(e in s)r&&e in r||Ri(t.style,e,"");if(r)for(e in r)s&&r[e]==s[e]||Ri(t.style,e,r[e])}else if(e[0]=="o"&&e[1]=="n")n=e!=(e=e.replace(Wn,"$1")),o=e.toLowerCase(),e=o in t||e=="onFocusOut"||e=="onFocusIn"?o.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+n]=r,r?s?r.u=s.u:(r.u=Js,t.addEventListener(e,n?xs:Cs,n)):t.removeEventListener(e,n?xs:Cs,n);else{if(i=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=r??"";break e}catch{}typeof r=="function"||(r==null||r===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&r==1?"":r))}}function Ci(t){return function(e){if(this.l){var r=this.l[e.type+t];if(e.t==null)e.t=Js++;else if(e.t<r.u)return;return r(R.event?R.event(e):e)}}}function Xs(t,e,r,s,i,n,o,a,l,u){var d,c,m,h,f,y,g,v,S,U,F,C,P,A,x,N,ne,te=e.type;if(e.constructor!=null)return null;128&r.__u&&(l=!!(32&r.__u),n=[a=e.__e=r.__e]),(d=R.__b)&&d(e);e:if(typeof te=="function")try{if(v=e.props,S="prototype"in te&&te.prototype.render,U=(d=te.contextType)&&s[d.__c],F=d?U?U.props.value:d.__:s,r.__c?g=(c=e.__c=r.__c).__=c.__E:(S?e.__c=c=new te(v,F):(e.__c=c=new Be(v,F),c.constructor=te,c.render=wc),U&&U.sub(c),c.props=v,c.state||(c.state={}),c.context=F,c.__n=s,m=c.__d=!0,c.__h=[],c._sb=[]),S&&c.__s==null&&(c.__s=c.state),S&&te.getDerivedStateFromProps!=null&&(c.__s==c.state&&(c.__s=je({},c.__s)),je(c.__s,te.getDerivedStateFromProps(v,c.__s))),h=c.props,f=c.state,c.__v=e,m)S&&te.getDerivedStateFromProps==null&&c.componentWillMount!=null&&c.componentWillMount(),S&&c.componentDidMount!=null&&c.__h.push(c.componentDidMount);else{if(S&&te.getDerivedStateFromProps==null&&v!==h&&c.componentWillReceiveProps!=null&&c.componentWillReceiveProps(v,F),!c.__e&&c.shouldComponentUpdate!=null&&c.shouldComponentUpdate(v,c.__s,F)===!1||e.__v==r.__v){for(e.__v!=r.__v&&(c.props=v,c.state=c.__s,c.__d=!1),e.__e=r.__e,e.__k=r.__k,e.__k.some(function(Se){Se&&(Se.__=e)}),C=0;C<c._sb.length;C++)c.__h.push(c._sb[C]);c._sb=[],c.__h.length&&o.push(c);break e}c.componentWillUpdate!=null&&c.componentWillUpdate(v,c.__s,F),S&&c.componentDidUpdate!=null&&c.__h.push(function(){c.componentDidUpdate(h,f,y)})}if(c.context=F,c.props=v,c.__P=t,c.__e=!1,P=R.__r,A=0,S){for(c.state=c.__s,c.__d=!1,P&&P(e),d=c.render(c.props,c.state,c.context),x=0;x<c._sb.length;x++)c.__h.push(c._sb[x]);c._sb=[]}else do c.__d=!1,P&&P(e),d=c.render(c.props,c.state,c.context),c.state=c.__s;while(c.__d&&++A<25);c.state=c.__s,c.getChildContext!=null&&(s=je(je({},s),c.getChildContext())),S&&!m&&c.getSnapshotBeforeUpdate!=null&&(y=c.getSnapshotBeforeUpdate(h,f)),N=d,d!=null&&d.type===mt&&d.key==null&&(N=Qn(d.props.children)),a=Kn(t,ar(N)?N:[N],e,r,s,i,n,o,a,l,u),c.base=e.__e,e.__u&=-161,c.__h.length&&o.push(c),g&&(c.__E=c.__=null)}catch(Se){if(e.__v=null,l||n!=null)if(Se.then){for(e.__u|=l?160:128;a&&a.nodeType==8&&a.nextSibling;)a=a.nextSibling;n[n.indexOf(a)]=null,e.__e=a}else for(ne=n.length;ne--;)Ks(n[ne]);else e.__e=r.__e,e.__k=r.__k;R.__e(Se,e,r)}else n==null&&e.__v==r.__v?(e.__k=r.__k,e.__e=r.__e):a=e.__e=bc(r.__e,e,r,s,i,n,o,l,u);return(d=R.diffed)&&d(e),128&e.__u?void 0:a}function Yn(t,e,r){for(var s=0;s<r.length;s++)Ys(r[s],r[++s],r[++s]);R.__c&&R.__c(e,t),t.some(function(i){try{t=i.__h,i.__h=[],t.some(function(n){n.call(i)})}catch(n){R.__e(n,i.__v)}})}function Qn(t){return typeof t!="object"||t==null||t.__b&&t.__b>0?t:ar(t)?t.map(Qn):je({},t)}function bc(t,e,r,s,i,n,o,a,l){var u,d,c,m,h,f,y,g=r.props,v=e.props,S=e.type;if(S=="svg"?i="http://www.w3.org/2000/svg":S=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),n!=null){for(u=0;u<n.length;u++)if((h=n[u])&&"setAttribute"in h==!!S&&(S?h.localName==S:h.nodeType==3)){t=h,n[u]=null;break}}if(t==null){if(S==null)return document.createTextNode(v);t=document.createElementNS(i,S,v.is&&v),a&&(R.__m&&R.__m(e,n),a=!1),n=null}if(S==null)g===v||a&&t.data==v||(t.data=v);else{if(n=n&&zr.call(t.childNodes),g=r.props||ir,!a&&n!=null)for(g={},u=0;u<t.attributes.length;u++)g[(h=t.attributes[u]).name]=h.value;for(u in g)if(h=g[u],u!="children"){if(u=="dangerouslySetInnerHTML")c=h;else if(!(u in v)){if(u=="value"&&"defaultValue"in v||u=="checked"&&"defaultChecked"in v)continue;hr(t,u,null,h,i)}}for(u in v)h=v[u],u=="children"?m=h:u=="dangerouslySetInnerHTML"?d=h:u=="value"?f=h:u=="checked"?y=h:a&&typeof h!="function"||g[u]===h||hr(t,u,h,g[u],i);if(d)a||c&&(d.__html==c.__html||d.__html==t.innerHTML)||(t.innerHTML=d.__html),e.__k=[];else if(c&&(t.innerHTML=""),Kn(e.type=="template"?t.content:t,ar(m)?m:[m],e,r,s,S=="foreignObject"?"http://www.w3.org/1999/xhtml":i,n,o,n?n[0]:r.__k&&gt(r,0),a,l),n!=null)for(u=n.length;u--;)Ks(n[u]);a||(u="value",S=="progress"&&f==null?t.removeAttribute("value"):f!=null&&(f!==t[u]||S=="progress"&&!f||S=="option"&&f!=g[u])&&hr(t,u,f,g[u],i),u="checked",y!=null&&y!=t[u]&&hr(t,u,y,g[u],i))}return t}function Ys(t,e,r){try{if(typeof t=="function"){var s=typeof t.__u=="function";s&&t.__u(),s&&e==null||(t.__u=t(e))}else t.current=e}catch(i){R.__e(i,r)}}function Zn(t,e,r){var s,i;if(R.unmount&&R.unmount(t),(s=t.ref)&&(s.current&&s.current!=t.__e||Ys(s,null,e)),(s=t.__c)!=null){if(s.componentWillUnmount)try{s.componentWillUnmount()}catch(n){R.__e(n,e)}s.base=s.__P=null}if(s=t.__k)for(i=0;i<s.length;i++)s[i]&&Zn(s[i],e,r||typeof t.type!="function");r||Ks(t.__e),t.__c=t.__=t.__e=void 0}function wc(t,e,r){return this.constructor(t,r)}function Sc(t,e,r){var s,i,n,o;e==document&&(e=document.documentElement),R.__&&R.__(t,e),i=(s=typeof r=="function")?null:r&&r.__k||e.__k,n=[],o=[],Xs(e,t=(!s&&r||e).__k=b(mt,null,[t]),i||ir,ir,e.namespaceURI,!s&&r?[r]:i?null:e.firstChild?zr.call(e.childNodes):null,n,!s&&r?r:i?i.__e:e.firstChild,s,o),Yn(n,t,o)}zr=Vn.slice,R={__e:function(t,e,r,s){for(var i,n,o;e=e.__;)if((i=e.__c)&&!i.__)try{if((n=i.constructor)&&n.getDerivedStateFromError!=null&&(i.setState(n.getDerivedStateFromError(t)),o=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(t,s||{}),o=i.__d),o)return i.__E=i}catch(a){t=a}throw t}},qn=0,Be.prototype.setState=function(t,e){var r;r=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=je({},this.state),typeof t=="function"&&(t=t(je({},r),this.props)),t&&je(r,t),t!=null&&this.__v&&(e&&this._sb.push(e),Ui(this))},Be.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),Ui(this))},Be.prototype.render=mt,tt=[],Hn=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Gn=function(t,e){return t.__v.__b-e.__v.__b},kr.__r=0,Wn=/(PointerCapture)$|Capture$/i,Js=0,Cs=Ci(!1),xs=Ci(!0);var we,ss,xi,eo=[],V=R,Mi=V.__b,$i=V.__r,Ni=V.diffed,Li=V.__c,ji=V.unmount,Bi=V.__;function Pc(){for(var t;t=eo.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(Pr),t.__H.__h.forEach(Ms),t.__H.__h=[]}catch(e){t.__H.__h=[],V.__e(e,t.__v)}}V.__b=function(t){we=null,Mi&&Mi(t)},V.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),Bi&&Bi(t,e)},V.__r=function(t){$i&&$i(t);var e=(we=t.__c).__H;e&&(ss===we?(e.__h=[],we.__h=[],e.__.forEach(function(r){r.__N&&(r.__=r.__N),r.u=r.__N=void 0})):(e.__h.forEach(Pr),e.__h.forEach(Ms),e.__h=[])),ss=we},V.diffed=function(t){Ni&&Ni(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(eo.push(e)!==1&&xi===V.requestAnimationFrame||((xi=V.requestAnimationFrame)||Ec)(Pc)),e.__H.__.forEach(function(r){r.u&&(r.__H=r.u),r.u=void 0})),ss=we=null},V.__c=function(t,e){e.some(function(r){try{r.__h.forEach(Pr),r.__h=r.__h.filter(function(s){return!s.__||Ms(s)})}catch(s){e.some(function(i){i.__h&&(i.__h=[])}),e=[],V.__e(s,r.__v)}}),Li&&Li(t,e)},V.unmount=function(t){ji&&ji(t);var e,r=t.__c;r&&r.__H&&(r.__H.__.forEach(function(s){try{Pr(s)}catch(i){e=i}}),r.__H=void 0,e&&V.__e(e,r.__v))};var Ii=typeof requestAnimationFrame=="function";function Ec(t){var e,r=function(){clearTimeout(s),Ii&&cancelAnimationFrame(e),setTimeout(t)},s=setTimeout(r,35);Ii&&(e=requestAnimationFrame(r))}function Pr(t){var e=we,r=t.__c;typeof r=="function"&&(t.__c=void 0,r()),we=e}function Ms(t){var e=we;t.__c=t.__(),we=e}function Tc(t,e){for(var r in e)t[r]=e[r];return t}function Di(t,e){for(var r in t)if(r!=="__source"&&!(r in e))return!0;for(var s in e)if(s!=="__source"&&t[s]!==e[s])return!0;return!1}function zi(t,e){this.props=t,this.context=e}(zi.prototype=new Be).isPureReactComponent=!0,zi.prototype.shouldComponentUpdate=function(t,e){return Di(this.props,t)||Di(this.state,e)};var qi=R.__b;R.__b=function(t){t.type&&t.type.__f&&t.ref&&(t.props.ref=t.ref,t.ref=null),qi&&qi(t)};var Ac=R.__e;R.__e=function(t,e,r,s){if(t.then){for(var i,n=e;n=n.__;)if((i=n.__c)&&i.__c)return e.__e==null&&(e.__e=r.__e,e.__k=r.__k),i.__c(t,e)}Ac(t,e,r,s)};var Hi=R.unmount;function to(t,e,r){return t&&(t.__c&&t.__c.__H&&(t.__c.__H.__.forEach(function(s){typeof s.__c=="function"&&s.__c()}),t.__c.__H=null),(t=Tc({},t)).__c!=null&&(t.__c.__P===r&&(t.__c.__P=e),t.__c.__e=!0,t.__c=null),t.__k=t.__k&&t.__k.map(function(s){return to(s,e,r)})),t}function ro(t,e,r){return t&&r&&(t.__v=null,t.__k=t.__k&&t.__k.map(function(s){return ro(s,e,r)}),t.__c&&t.__c.__P===e&&(t.__e&&r.appendChild(t.__e),t.__c.__e=!0,t.__c.__P=r)),t}function is(){this.__u=0,this.o=null,this.__b=null}function so(t){var e=t.__.__c;return e&&e.__a&&e.__a(t)}function fr(){this.i=null,this.l=null}R.unmount=function(t){var e=t.__c;e&&e.__R&&e.__R(),e&&32&t.__u&&(t.type=null),Hi&&Hi(t)},(is.prototype=new Be).__c=function(t,e){var r=e.__c,s=this;s.o==null&&(s.o=[]),s.o.push(r);var i=so(s.__v),n=!1,o=function(){n||(n=!0,r.__R=null,i?i(a):a())};r.__R=o;var a=function(){if(!--s.__u){if(s.state.__a){var l=s.state.__a;s.__v.__k[0]=ro(l,l.__c.__P,l.__c.__O)}var u;for(s.setState({__a:s.__b=null});u=s.o.pop();)u.forceUpdate()}};s.__u++||32&e.__u||s.setState({__a:s.__b=s.__v.__k[0]}),t.then(o,o)},is.prototype.componentWillUnmount=function(){this.o=[]},is.prototype.render=function(t,e){if(this.__b){if(this.__v.__k){var r=document.createElement("div"),s=this.__v.__k[0].__c;this.__v.__k[0]=to(this.__b,r,s.__O=s.__P)}this.__b=null}var i=e.__a&&b(mt,null,t.fallback);return i&&(i.__u&=-33),[b(mt,null,e.__a?null:t.children),i]};var Gi=function(t,e,r){if(++r[1]===r[0]&&t.l.delete(e),t.props.revealOrder&&(t.props.revealOrder[0]!=="t"||!t.l.size))for(r=t.i;r;){for(;r.length>3;)r.pop()();if(r[1]<r[0])break;t.i=r=r[2]}};(fr.prototype=new Be).__a=function(t){var e=this,r=so(e.__v),s=e.l.get(t);return s[0]++,function(i){var n=function(){e.props.revealOrder?(s.push(i),Gi(e,t,s)):i()};r?r(n):n()}},fr.prototype.render=function(t){this.i=null,this.l=new Map;var e=Ur(t.children);t.revealOrder&&t.revealOrder[0]==="b"&&e.reverse();for(var r=e.length;r--;)this.l.set(e[r],this.i=[1,0,this.i]);return t.children},fr.prototype.componentDidUpdate=fr.prototype.componentDidMount=function(){var t=this;this.l.forEach(function(e,r){Gi(t,r,e)})};var Oc=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,Fc=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,kc=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,Uc=/[A-Z0-9]/g,Rc=typeof document<"u",Cc=function(t){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(t)};function Wi(t,e,r){return e.__k==null&&(e.textContent=""),Sc(t,e),typeof r=="function"&&r(),t?t.__c:null}Be.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(t){Object.defineProperty(Be.prototype,t,{configurable:!0,get:function(){return this["UNSAFE_"+t]},set:function(e){Object.defineProperty(this,t,{configurable:!0,writable:!0,value:e})}})});var Vi=R.event;function xc(){}function Mc(){return this.cancelBubble}function $c(){return this.defaultPrevented}R.event=function(t){return Vi&&(t=Vi(t)),t.persist=xc,t.isPropagationStopped=Mc,t.isDefaultPrevented=$c,t.nativeEvent=t};var Nc={enumerable:!1,configurable:!0,get:function(){return this.class}},Ji=R.vnode;R.vnode=function(t){typeof t.type=="string"&&function(e){var r=e.props,s=e.type,i={},n=s.indexOf("-")===-1;for(var o in r){var a=r[o];if(!(o==="value"&&"defaultValue"in r&&a==null||Rc&&o==="children"&&s==="noscript"||o==="class"||o==="className")){var l=o.toLowerCase();o==="defaultValue"&&"value"in r&&r.value==null?o="value":o==="download"&&a===!0?a="":l==="translate"&&a==="no"?a=!1:l[0]==="o"&&l[1]==="n"?l==="ondoubleclick"?o="ondblclick":l!=="onchange"||s!=="input"&&s!=="textarea"||Cc(r.type)?l==="onfocus"?o="onfocusin":l==="onblur"?o="onfocusout":kc.test(o)&&(o=l):l=o="oninput":n&&Fc.test(o)?o=o.replace(Uc,"-$&").toLowerCase():a===null&&(a=void 0),l==="oninput"&&i[o=l]&&(o="oninputCapture"),i[o]=a}}s=="select"&&i.multiple&&Array.isArray(i.value)&&(i.value=Ur(r.children).forEach(function(u){u.props.selected=i.value.indexOf(u.props.value)!=-1})),s=="select"&&i.defaultValue!=null&&(i.value=Ur(r.children).forEach(function(u){u.props.selected=i.multiple?i.defaultValue.indexOf(u.props.value)!=-1:i.defaultValue==u.props.value})),r.class&&!r.className?(i.class=r.class,Object.defineProperty(i,"className",Nc)):(r.className&&!r.class||r.class&&r.className)&&(i.class=i.className=r.className),e.props=i}(t),t.$$typeof=Oc,Ji&&Ji(t)};var Ki=R.__r;R.__r=function(t){Ki&&Ki(t),t.__c};var Xi=R.diffed;R.diffed=function(t){Xi&&Xi(t);var e=t.props,r=t.__e;r!=null&&t.type==="textarea"&&"value"in e&&e.value!==r.value&&(r.value=e.value==null?"":e.value)};function Lc(t){return typeof t!="object"||t===null||!("nodeType"in t)?!1:t.nodeType===Node.ELEMENT_NODE}function jc(t,e){return e===void 0&&(e=document),typeof t=="string"?e.querySelector(t):Lc(t)?t:null}function io(t){for(var e;t&&!t.dir;)t=t.parentNode;return(e=t)==null?void 0:e.dir}class no{constructor(e,r){this.uppy=e,this.opts=r??{}}getPluginState(){const{plugins:e}=this.uppy.getState();return(e==null?void 0:e[this.id])||{}}setPluginState(e){const{plugins:r}=this.uppy.getState();this.uppy.setState({plugins:{...r,[this.id]:{...r[this.id],...e}}})}setOptions(e){this.opts={...this.opts,...e},this.setPluginState(void 0),this.i18nInit()}i18nInit(){const e=new xn([this.defaultLocale,this.uppy.locale,this.opts.locale]);this.i18n=e.translate.bind(e),this.i18nArray=e.translateArray.bind(e),this.setPluginState(void 0)}addTarget(e){throw new Error("Extend the addTarget method to add your plugin to another plugin's target")}install(){}uninstall(){}update(e){}afterUpdate(){}}function Yi(t,e){if(!{}.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var Bc=0;function Ic(t){return"__private_"+Bc+++"_"+t}function Dc(t){let e=null,r;return function(){for(var s=arguments.length,i=new Array(s),n=0;n<s;n++)i[n]=arguments[n];return r=i,e||(e=Promise.resolve().then(()=>(e=null,t(...r)))),e}}var xt=Ic("updateUI");class Rr extends no{constructor(){super(...arguments),Object.defineProperty(this,xt,{writable:!0,value:void 0})}getTargetPlugin(e){let r;if(typeof(e==null?void 0:e.addTarget)=="function")r=e,r instanceof Rr||console.warn(new Error("The provided plugin is not an instance of UIPlugin. This is an indication of a bug with the way Uppy is bundled.",{cause:{targetPlugin:r,UIPlugin:Rr}}));else if(typeof e=="function"){const s=e;this.uppy.iteratePlugins(i=>{i instanceof s&&(r=i)})}return r}mount(e,r){const s=r.id,i=jc(e);if(i){this.isTargetDOMEl=!0;const a=document.createElement("div");return a.classList.add("uppy-Root"),Yi(this,xt)[xt]=Dc(l=>{this.uppy.getPlugin(this.id)&&(Wi(this.render(l,a),a),this.afterUpdate())}),this.uppy.log(`Installing ${s} to a DOM element '${e}'`),this.opts.replaceTargetContent&&(i.innerHTML=""),Wi(this.render(this.uppy.getState(),a),a),this.el=a,i.appendChild(a),a.dir=this.opts.direction||io(a)||"ltr",this.onMount(),this.el}const n=this.getTargetPlugin(e);if(n)return this.uppy.log(`Installing ${s} to ${n.id}`),this.parent=n,this.el=n.addTarget(r),this.onMount(),this.el;this.uppy.log(`Not installing ${s}`);let o=`Invalid target option given to ${s}.`;throw typeof e=="function"?o+=" The given target is not a Plugin class. Please check that you're not specifying a React Component instead of a plugin. If you are using @uppy/* packages directly, make sure you have only 1 version of @uppy/core installed: run `npm ls @uppy/core` on the command line and verify that all the versions match and are deduped correctly.":o+="If you meant to target an HTML element, please make sure that the element exists. Check that the <script> tag initializing Uppy is right before the closing </body> tag at the end of the page. (see https://github.com/transloadit/uppy/issues/1042)\n\nIf you meant to target a plugin, please confirm that your `import` statements or `require` calls are correct.",new Error(o)}render(e,r){throw new Error("Extend the render method to add your plugin to a DOM element")}update(e){if(this.el!=null){var r,s;(r=(s=Yi(this,xt))[xt])==null||r.call(s,e)}}unmount(){if(this.isTargetDOMEl){var e;(e=this.el)==null||e.remove()}this.onUnmount()}onMount(){}onUnmount(){}}const qr=Rr,Qs=Array.from;function zc(){const t=document.body;return!(!("draggable"in t)||!("ondragstart"in t&&"ondrop"in t)||!("FormData"in window)||!("FileReader"in window))}function oo(t,e,r,s){let{onSuccess:i}=s;t.readEntries(n=>{const o=[...e,...n];n.length?queueMicrotask(()=>{oo(t,o,r,{onSuccess:i})}):i(o)},n=>{r(n),i(e)})}function ao(t,e){return t==null?t:{kind:t.isFile?"file":t.isDirectory?"directory":void 0,name:t.name,getFile(){return new Promise((r,s)=>t.file(r,s))},async*values(){const r=t.createReader();yield*await new Promise(i=>{oo(r,[],e,{onSuccess:n=>i(n.map(o=>ao(o,e)))})})},isSameEntry:void 0}}function lo(t,e,r){try{return r===void 0&&(r=void 0),async function*(){const s=()=>`${e}/${t.name}`;if(t.kind==="file"){const i=await t.getFile();i!=null?(i.relativePath=e?s():null,yield i):r!=null&&(yield r)}else if(t.kind==="directory")for await(const i of t.values())yield*lo(i,e?s():t.name);else r!=null&&(yield r)}()}catch(s){return Promise.reject(s)}}async function*qc(t,e){const r=await Promise.all(Array.from(t.items,async s=>{let i;return i??(i=ao((()=>typeof s.getAsEntry=="function"?s.getAsEntry():s.webkitGetAsEntry())(),e)),{fileSystemHandle:i,lastResortFile:s.getAsFile()}}));for(const{lastResortFile:s,fileSystemHandle:i}of r)if(i!=null)try{yield*lo(i,"",s)}catch(n){s!=null?yield s:e(n)}else s!=null&&(yield s)}function Hc(t){const e=Qs(t.files);return Promise.resolve(e)}async function Gc(t,e){var r;const s=(r=e==null?void 0:e.logDropError)!=null?r:Function.prototype;try{const i=[];for await(const n of qc(t,s))i.push(n);return i}catch{return Hc(t)}}const Wc={strings:{dropHereOr:"Drop here or %{browse}",browse:"browse"}},Vc={version:"4.1.3"},Jc={inputName:"files[]",width:"100%",height:"100%"};class Hr extends qr{constructor(e,r){super(e,{...Jc,...r}),this.isDragDropSupported=zc(),this.addFiles=s=>{const i=s.map(n=>({source:this.id,name:n.name,type:n.type,data:n,meta:{relativePath:n.relativePath||null}}));try{this.uppy.addFiles(i)}catch(n){this.uppy.log(n)}},this.onInputChange=s=>{const i=Qs(s.currentTarget.files||[]);i.length>0&&(this.uppy.log("[DragDrop] Files selected through input"),this.addFiles(i)),s.currentTarget.value=""},this.handleDragOver=s=>{var i,n;s.preventDefault(),s.stopPropagation();const{types:o}=s.dataTransfer,a=o.some(u=>u==="Files"),{allowNewUpload:l}=this.uppy.getState();if(!a||!l){s.dataTransfer.dropEffect="none";return}s.dataTransfer.dropEffect="copy",this.setPluginState({isDraggingOver:!0}),(i=(n=this.opts).onDragOver)==null||i.call(n,s)},this.handleDragLeave=s=>{var i,n;s.preventDefault(),s.stopPropagation(),this.setPluginState({isDraggingOver:!1}),(i=(n=this.opts).onDragLeave)==null||i.call(n,s)},this.handleDrop=async s=>{var i,n;s.preventDefault(),s.stopPropagation(),this.setPluginState({isDraggingOver:!1});const o=l=>{this.uppy.log(l,"error")},a=await Gc(s.dataTransfer,{logDropError:o});a.length>0&&(this.uppy.log("[DragDrop] Files dropped"),this.addFiles(a)),(i=(n=this.opts).onDrop)==null||i.call(n,s)},this.type="acquirer",this.id=this.opts.id||"DragDrop",this.title="Drag & Drop",this.defaultLocale=Wc,this.i18nInit()}renderHiddenFileInput(){var e;const{restrictions:r}=this.uppy.opts;return b("input",{className:"uppy-DragDrop-input",type:"file",hidden:!0,ref:s=>{this.fileInputRef=s},name:this.opts.inputName,multiple:r.maxNumberOfFiles!==1,accept:(e=r.allowedFileTypes)==null?void 0:e.join(", "),onChange:this.onInputChange})}static renderArrowSvg(){return b("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-DragDrop-arrow",width:"16",height:"16",viewBox:"0 0 16 16"},b("path",{d:"M11 10V0H5v10H2l6 6 6-6h-3zm0 0",fillRule:"evenodd"}))}renderLabel(){return b("div",{className:"uppy-DragDrop-label"},this.i18nArray("dropHereOr",{browse:b("span",{className:"uppy-DragDrop-browse"},this.i18n("browse"))}))}renderNote(){return b("span",{className:"uppy-DragDrop-note"},this.opts.note)}render(){const e=`uppy-u-reset
      uppy-DragDrop-container
      ${this.isDragDropSupported?"uppy-DragDrop--isDragDropSupported":""}
      ${this.getPluginState().isDraggingOver?"uppy-DragDrop--isDraggingOver":""}
    `,r={width:this.opts.width,height:this.opts.height};return b("button",{type:"button",className:e,style:r,onClick:()=>this.fileInputRef.click(),onDragOver:this.handleDragOver,onDragLeave:this.handleDragLeave,onDrop:this.handleDrop},this.renderHiddenFileInput(),b("div",{className:"uppy-DragDrop-inner"},Hr.renderArrowSvg(),this.renderLabel(),this.renderNote()))}install(){const{target:e}=this.opts;this.setPluginState({isDraggingOver:!1}),e&&this.mount(e,this)}uninstall(){this.unmount()}}Hr.VERSION=Vc.version;function Qi(t,e,r,s){return r===0||t===e?t:s===0?e:t+(e-t)*2**(-s/r)}const be={STATE_ERROR:"error",STATE_WAITING:"waiting",STATE_PREPROCESSING:"preprocessing",STATE_UPLOADING:"uploading",STATE_POSTPROCESSING:"postprocessing",STATE_COMPLETE:"complete"};var uo={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(t){(function(){var e={}.hasOwnProperty;function r(){for(var n="",o=0;o<arguments.length;o++){var a=arguments[o];a&&(n=i(n,s(a)))}return n}function s(n){if(typeof n=="string"||typeof n=="number")return n;if(typeof n!="object")return"";if(Array.isArray(n))return r.apply(null,n);if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]"))return n.toString();var o="";for(var a in n)e.call(n,a)&&n[a]&&(o=i(o,a));return o}function i(n,o){return o?n?n+" "+o:n+o:n}t.exports?(r.default=r,t.exports=r):window.classNames=r})()})(uo);var Kc=uo.exports;const Cr=_t(Kc);function ns(t){const e=[];let r="indeterminate",s;for(const{progress:n}of Object.values(t)){const{preprocess:o,postprocess:a}=n;s==null&&(o||a)&&({mode:r,message:s}=o||a),(o==null?void 0:o.mode)==="determinate"&&e.push(o.value),(a==null?void 0:a.mode)==="determinate"&&e.push(a.value)}const i=e.reduce((n,o)=>n+o/e.length,0);return{mode:r,message:s,value:i}}function Xc(t){const e=Math.floor(t/3600)%24,r=Math.floor(t/60)%60,s=Math.floor(t%60);return{hours:e,minutes:r,seconds:s}}function Yc(t){const e=Xc(t),r=e.hours===0?"":`${e.hours}h`,s=e.minutes===0?"":`${e.hours===0?e.minutes:` ${e.minutes.toString(10).padStart(2,"0")}`}m`,i=e.hours!==0?"":`${e.minutes===0?e.seconds:` ${e.seconds.toString(10).padStart(2,"0")}`}s`;return`${r}${s}${i}`}const Qc="",Zi=()=>` ${Qc} `;function Zc(t){const{newFiles:e,isUploadStarted:r,recoveredState:s,i18n:i,uploadState:n,isSomeGhost:o,startUpload:a}=t,l=Cr("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--upload",{"uppy-c-btn-primary":n===be.STATE_WAITING},{"uppy-StatusBar-actionBtn--disabled":o}),u=e&&r&&!s?i("uploadXNewFiles",{smart_count:e}):i("uploadXFiles",{smart_count:e});return b("button",{type:"button",className:l,"aria-label":i("uploadXFiles",{smart_count:e}),onClick:a,disabled:o,"data-uppy-super-focusable":!0},u)}function ed(t){const{i18n:e,uppy:r}=t;return b("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--retry","aria-label":e("retryUpload"),onClick:()=>r.retryAll().catch(()=>{}),"data-uppy-super-focusable":!0,"data-cy":"retry"},b("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"8",height:"10",viewBox:"0 0 8 10"},b("path",{d:"M4 2.408a2.75 2.75 0 1 0 2.75 2.75.626.626 0 0 1 1.25.018v.023a4 4 0 1 1-4-4.041V.25a.25.25 0 0 1 .389-.208l2.299 1.533a.25.25 0 0 1 0 .416l-2.3 1.533A.25.25 0 0 1 4 3.316v-.908z"})),e("retry"))}function td(t){const{i18n:e,uppy:r}=t;return b("button",{type:"button",className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",title:e("cancel"),"aria-label":e("cancel"),onClick:()=>r.cancelAll(),"data-cy":"cancel","data-uppy-super-focusable":!0},b("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16"},b("g",{fill:"none",fillRule:"evenodd"},b("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),b("path",{fill:"#FFF",d:"M9.283 8l2.567 2.567-1.283 1.283L8 9.283 5.433 11.85 4.15 10.567 6.717 8 4.15 5.433 5.433 4.15 8 6.717l2.567-2.567 1.283 1.283z"}))))}function rd(t){const{isAllPaused:e,i18n:r,isAllComplete:s,resumableUploads:i,uppy:n}=t,o=r(e?"resume":"pause");function a(){if(!s){if(!i){n.cancelAll();return}if(e){n.resumeAll();return}n.pauseAll()}}return b("button",{title:o,"aria-label":o,className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",type:"button",onClick:a,"data-cy":"togglePauseResume","data-uppy-super-focusable":!0},b("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16"},b("g",{fill:"none",fillRule:"evenodd"},b("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),b("path",{fill:"#FFF",d:e?"M6 4.25L11.5 8 6 11.75z":"M5 4.5h2v7H5v-7zm4 0h2v7H9v-7z"}))))}function sd(t){const{i18n:e,doneButtonHandler:r}=t;return b("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--done",onClick:r,"data-uppy-super-focusable":!0},e("done"))}function co(){return b("svg",{className:"uppy-StatusBar-spinner","aria-hidden":"true",focusable:"false",width:"14",height:"14"},b("path",{d:"M13.983 6.547c-.12-2.509-1.64-4.893-3.939-5.936-2.48-1.127-5.488-.656-7.556 1.094C.524 3.367-.398 6.048.162 8.562c.556 2.495 2.46 4.52 4.94 5.183 2.932.784 5.61-.602 7.256-3.015-1.493 1.993-3.745 3.309-6.298 2.868-2.514-.434-4.578-2.349-5.153-4.84a6.226 6.226 0 0 1 2.98-6.778C6.34.586 9.74 1.1 11.373 3.493c.407.596.693 1.282.842 1.988.127.598.073 1.197.161 1.794.078.525.543 1.257 1.15.864.525-.341.49-1.05.456-1.592-.007-.15.02.3 0 0",fillRule:"evenodd"}))}function id(t){const{progress:e}=t,{value:r,mode:s,message:i}=e,n="";return b("div",{className:"uppy-StatusBar-content"},b(co,null),s==="determinate"?`${Math.round(r*100)}% ${n} `:"",i)}function nd(t){const{numUploads:e,complete:r,totalUploadedSize:s,totalSize:i,totalETA:n,i18n:o}=t,a=e>1,l=ft(s);return b("div",{className:"uppy-StatusBar-statusSecondary"},a&&o("filesUploadedOfTotal",{complete:r,smart_count:e}),b("span",{className:"uppy-StatusBar-additionalInfo"},a&&Zi(),i!=null?o("dataUploadedOfTotal",{complete:l,total:ft(i)}):o("dataUploadedOfUnknown",{complete:l}),Zi(),n!=null&&o("xTimeLeft",{time:Yc(n)})))}function po(t){const{i18n:e,complete:r,numUploads:s}=t;return b("div",{className:"uppy-StatusBar-statusSecondary"},e("filesUploadedOfTotal",{complete:r,smart_count:s}))}function od(t){const{i18n:e,newFiles:r,startUpload:s}=t,i=Cr("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--uploadNewlyAdded");return b("div",{className:"uppy-StatusBar-statusSecondary"},b("div",{className:"uppy-StatusBar-statusSecondaryHint"},e("xMoreFilesAdded",{smart_count:r})),b("button",{type:"button",className:i,"aria-label":e("uploadXFiles",{smart_count:r}),onClick:s},e("upload")))}function ad(t){const{i18n:e,supportsUploadProgress:r,totalProgress:s,showProgressDetails:i,isUploadStarted:n,isAllComplete:o,isAllPaused:a,newFiles:l,numUploads:u,complete:d,totalUploadedSize:c,totalSize:m,totalETA:h,startUpload:f}=t,y=l&&n;if(!n||o)return null;const g=e(a?"paused":"uploading");function v(){return!a&&!y&&i?r?b(nd,{numUploads:u,complete:d,totalUploadedSize:c,totalSize:m,totalETA:h,i18n:e}):b(po,{i18n:e,complete:d,numUploads:u}):null}return b("div",{className:"uppy-StatusBar-content","aria-label":g,title:g},a?null:b(co,null),b("div",{className:"uppy-StatusBar-status"},b("div",{className:"uppy-StatusBar-statusPrimary"},r&&s!==0?`${g}: ${s}%`:g),v(),y?b(od,{i18n:e,newFiles:l,startUpload:f}):null))}function ld(t){const{i18n:e}=t;return b("div",{className:"uppy-StatusBar-content",role:"status",title:e("complete")},b("div",{className:"uppy-StatusBar-status"},b("div",{className:"uppy-StatusBar-statusPrimary"},b("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"15",height:"11",viewBox:"0 0 15 11"},b("path",{d:"M.414 5.843L1.627 4.63l3.472 3.472L13.202 0l1.212 1.213L5.1 10.528z"})),e("complete"))))}function ud(t){const{error:e,i18n:r,complete:s,numUploads:i}=t;function n(){const o=`${r("uploadFailed")} 

 ${e}`;alert(o)}return b("div",{className:"uppy-StatusBar-content",title:r("uploadFailed")},b("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"11",height:"11",viewBox:"0 0 11 11"},b("path",{d:"M4.278 5.5L0 1.222 1.222 0 5.5 4.278 9.778 0 11 1.222 6.722 5.5 11 9.778 9.778 11 5.5 6.722 1.222 11 0 9.778z"})),b("div",{className:"uppy-StatusBar-status"},b("div",{className:"uppy-StatusBar-statusPrimary"},r("uploadFailed"),b("button",{className:"uppy-u-reset uppy-StatusBar-details","aria-label":r("showErrorDetails"),"data-microtip-position":"top-right","data-microtip-size":"medium",onClick:n,type:"button"},"?")),b(po,{i18n:r,complete:s,numUploads:i})))}const{STATE_ERROR:en,STATE_WAITING:cd,STATE_PREPROCESSING:os,STATE_UPLOADING:mr,STATE_POSTPROCESSING:as,STATE_COMPLETE:gr}=be;function dd(t){let{newFiles:e,allowNewUpload:r,isUploadInProgress:s,isAllPaused:i,resumableUploads:n,error:o,hideUploadButton:a=void 0,hidePauseResumeButton:l=!1,hideCancelButton:u=!1,hideRetryButton:d=!1,recoveredState:c,uploadState:m,totalProgress:h,files:f,supportsUploadProgress:y,hideAfterFinish:g=!1,isSomeGhost:v,doneButtonHandler:S=void 0,isUploadStarted:U,i18n:F,startUpload:C,uppy:P,isAllComplete:A,showProgressDetails:x=void 0,numUploads:N,complete:ne,totalSize:te,totalETA:Se,totalUploadedSize:wt}=t;function De(){switch(m){case as:case os:{const ur=ns(f);return ur.mode==="determinate"?ur.value*100:h}case en:return null;case mr:return y?h:null;default:return h}}function lr(){switch(m){case as:case os:{const{mode:ur}=ns(f);return ur==="indeterminate"}case mr:return!y;default:return!1}}const pt=De(),ze=pt??100,qe=!o&&e&&(!s&&!i||c)&&r&&!a,Pe=!u&&m!==cd&&m!==gr,He=n&&!l&&m===mr,ti=o&&!A&&!d,ri=S&&m===gr,To=Cr("uppy-StatusBar-progress",{"is-indeterminate":lr()}),Ao=Cr("uppy-StatusBar",`is-${m}`,{"has-ghosts":v}),si=(()=>{switch(m){case os:case as:return b(id,{progress:ns(f)});case gr:return b(ld,{i18n:F});case en:return b(ud,{error:o,i18n:F,numUploads:N,complete:ne});case mr:return b(ad,{i18n:F,supportsUploadProgress:y,totalProgress:h,showProgressDetails:x,isUploadStarted:U,isAllComplete:A,isAllPaused:i,newFiles:e,numUploads:N,complete:ne,totalUploadedSize:wt,totalSize:te,totalETA:Se,startUpload:C});default:return null}})();return!(qe||ti||He||Pe||ri)&&!si||m===gr&&g?null:b("div",{className:Ao},b("div",{className:To,style:{width:`${ze}%`},role:"progressbar","aria-label":`${ze}%`,"aria-valuetext":`${ze}%`,"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":pt}),si,b("div",{className:"uppy-StatusBar-actions"},qe?b(Zc,{newFiles:e,isUploadStarted:U,recoveredState:c,i18n:F,isSomeGhost:v,startUpload:C,uploadState:m}):null,ti?b(ed,{i18n:F,uppy:P}):null,He?b(rd,{isAllPaused:i,i18n:F,isAllComplete:A,resumableUploads:n,uppy:P}):null,Pe?b(td,{i18n:F,uppy:P}):null,ri?b(sd,{i18n:F,doneButtonHandler:S}):null))}const pd={strings:{uploading:"Uploading",complete:"Complete",uploadFailed:"Upload failed",paused:"Paused",retry:"Retry",cancel:"Cancel",pause:"Pause",resume:"Resume",done:"Done",filesUploadedOfTotal:{0:"%{complete} of %{smart_count} file uploaded",1:"%{complete} of %{smart_count} files uploaded"},dataUploadedOfTotal:"%{complete} of %{total}",dataUploadedOfUnknown:"%{complete} of unknown",xTimeLeft:"%{time} left",uploadXFiles:{0:"Upload %{smart_count} file",1:"Upload %{smart_count} files"},uploadXNewFiles:{0:"Upload +%{smart_count} file",1:"Upload +%{smart_count} files"},upload:"Upload",retryUpload:"Retry upload",xMoreFilesAdded:{0:"%{smart_count} more file added",1:"%{smart_count} more files added"},showErrorDetails:"Show error details"}};function L(t,e){if(!{}.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var hd=0;function bt(t){return"__private_"+hd+++"_"+t}const fd={version:"4.1.3"},md=2e3,gd=2e3;function yd(t,e,r,s){if(t)return be.STATE_ERROR;if(e)return be.STATE_COMPLETE;if(r)return be.STATE_WAITING;let i=be.STATE_WAITING;const n=Object.keys(s);for(let o=0;o<n.length;o++){const{progress:a}=s[n[o]];if(a.uploadStarted&&!a.uploadComplete)return be.STATE_UPLOADING;a.preprocess&&(i=be.STATE_PREPROCESSING),a.postprocess&&i!==be.STATE_PREPROCESSING&&(i=be.STATE_POSTPROCESSING)}return i}const vd={hideUploadButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideCancelButton:!1,showProgressDetails:!1,hideAfterFinish:!0,doneButtonHandler:null};var he=bt("lastUpdateTime"),ge=bt("previousUploadedBytes"),xe=bt("previousSpeed"),ae=bt("previousETA"),ls=bt("computeSmoothETA"),Mt=bt("onUploadStart");class ho extends qr{constructor(e,r){super(e,{...vd,...r}),Object.defineProperty(this,ls,{value:_d}),Object.defineProperty(this,he,{writable:!0,value:void 0}),Object.defineProperty(this,ge,{writable:!0,value:void 0}),Object.defineProperty(this,xe,{writable:!0,value:void 0}),Object.defineProperty(this,ae,{writable:!0,value:void 0}),this.startUpload=()=>this.uppy.upload().catch(()=>{}),Object.defineProperty(this,Mt,{writable:!0,value:()=>{const{recoveredState:s}=this.uppy.getState();if(L(this,xe)[xe]=null,L(this,ae)[ae]=null,s){L(this,ge)[ge]=Object.values(s.files).reduce((i,n)=>{let{progress:o}=n;return i+o.bytesUploaded},0),this.uppy.emit("restore-confirmed");return}L(this,he)[he]=performance.now(),L(this,ge)[ge]=0}}),this.id=this.opts.id||"StatusBar",this.title="StatusBar",this.type="progressindicator",this.defaultLocale=pd,this.i18nInit(),this.render=this.render.bind(this),this.install=this.install.bind(this)}render(e){const{capabilities:r,files:s,allowNewUpload:i,totalProgress:n,error:o,recoveredState:a}=e,{newFiles:l,startedFiles:u,completeFiles:d,isUploadStarted:c,isAllComplete:m,isAllPaused:h,isUploadInProgress:f,isSomeGhost:y}=this.uppy.getObjectOfFilesPerState(),g=a?Object.values(s):l,v=!!r.resumableUploads,S=r.uploadProgress!==!1;let U=null,F=0;u.every(P=>P.progress.bytesTotal!=null&&P.progress.bytesTotal!==0)?(U=0,u.forEach(P=>{U+=P.progress.bytesTotal||0,F+=P.progress.bytesUploaded||0})):u.forEach(P=>{F+=P.progress.bytesUploaded||0});const C=L(this,ls)[ls]({uploaded:F,total:U});return dd({error:o,uploadState:yd(o,m,a,e.files||{}),allowNewUpload:i,totalProgress:n,totalSize:U,totalUploadedSize:F,isAllComplete:!1,isAllPaused:h,isUploadStarted:c,isUploadInProgress:f,isSomeGhost:y,recoveredState:a,complete:d.length,newFiles:g.length,numUploads:u.length,totalETA:C,files:s,i18n:this.i18n,uppy:this.uppy,startUpload:this.startUpload,doneButtonHandler:this.opts.doneButtonHandler,resumableUploads:v,supportsUploadProgress:S,showProgressDetails:this.opts.showProgressDetails,hideUploadButton:this.opts.hideUploadButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,hideCancelButton:this.opts.hideCancelButton,hideAfterFinish:this.opts.hideAfterFinish})}onMount(){const e=this.el;io(e)||(e.dir="ltr")}install(){const{target:e}=this.opts;e&&this.mount(e,this),this.uppy.on("upload",L(this,Mt)[Mt]),L(this,he)[he]=performance.now(),L(this,ge)[ge]=this.uppy.getFiles().reduce((r,s)=>r+s.progress.bytesUploaded,0)}uninstall(){this.unmount(),this.uppy.off("upload",L(this,Mt)[Mt])}}function _d(t){var e,r;if(t.total==null||t.total===0)return null;const s=t.total-t.uploaded;if(s<=0)return null;(r=(e=L(this,he))[he])!=null||(e[he]=performance.now());const i=performance.now()-L(this,he)[he];if(i===0){var n;return Math.round(((n=L(this,ae)[ae])!=null?n:0)/100)/10}const o=t.uploaded-L(this,ge)[ge];if(L(this,ge)[ge]=t.uploaded,o<=0){var a;return Math.round(((a=L(this,ae)[ae])!=null?a:0)/100)/10}const l=o/i,u=L(this,xe)[xe]==null?l:Qi(l,L(this,xe)[xe],md,i);L(this,xe)[xe]=u;const d=s/u,c=Math.max(L(this,ae)[ae]-i,0),m=L(this,ae)[ae]==null?d:Qi(d,c,gd,i);return L(this,ae)[ae]=m,L(this,he)[he]=performance.now(),Math.round(m/100)/10}ho.VERSION=fd.version;const bd={version:"4.2.1"},wd={fixed:!1,hideAfterFinish:!0};class fo extends qr{constructor(e,r){super(e,{...wd,...r}),this.id=this.opts.id||"ProgressBar",this.title="Progress Bar",this.type="progressindicator",this.render=this.render.bind(this)}render(e){const{totalProgress:r}=e,s=(r===0||r===100)&&this.opts.hideAfterFinish;return b("div",{className:"uppy uppy-ProgressBar",style:{position:this.opts.fixed?"fixed":"initial"},"aria-hidden":s},b("div",{className:"uppy-ProgressBar-inner",style:{width:`${r}%`}}),b("div",{className:"uppy-ProgressBar-percentage"},r))}install(){const{target:e}=this.opts;e&&this.mount(e,this)}uninstall(){this.unmount()}}fo.VERSION=bd.version;const Sd={strings:{chooseFiles:"Choose files"}},Pd={version:"4.1.3"},Ed={pretty:!0,inputName:"files[]"};class mo extends qr{constructor(e,r){super(e,{...Ed,...r}),this.input=null,this.id=this.opts.id||"FileInput",this.title="File Input",this.type="acquirer",this.defaultLocale=Sd,this.i18nInit(),this.render=this.render.bind(this),this.handleInputChange=this.handleInputChange.bind(this),this.handleClick=this.handleClick.bind(this)}addFiles(e){const r=e.map(s=>({source:this.id,name:s.name,type:s.type,data:s}));try{this.uppy.addFiles(r)}catch(s){this.uppy.log(s)}}handleInputChange(e){this.uppy.log("[FileInput] Something selected through input...");const r=Qs(e.currentTarget.files||[]);this.addFiles(r),e.currentTarget.value=""}handleClick(){this.input.click()}render(){var e;const r={width:"0.1px",height:"0.1px",opacity:0,overflow:"hidden",position:"absolute",zIndex:-1},{restrictions:s}=this.uppy.opts;return b("div",{className:"uppy-FileInput-container"},b("input",{className:"uppy-FileInput-input",style:this.opts.pretty?r:void 0,type:"file",name:this.opts.inputName,onChange:this.handleInputChange,multiple:s.maxNumberOfFiles!==1,accept:(e=s.allowedFileTypes)==null?void 0:e.join(", "),ref:i=>{this.input=i}}),this.opts.pretty&&b("button",{className:"uppy-FileInput-btn",type:"button",onClick:this.handleClick},this.i18n("chooseFiles")))}install(){const{target:e}=this.opts;e&&this.mount(e,this)}uninstall(){this.unmount()}}mo.VERSION=Pd.version;class Td extends Error{constructor(){super(...arguments),this.name="UserFacingApiError"}}var go={};function fe(t,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(t)),this._timeouts=t,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}var Ad=fe;fe.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};fe.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};fe.prototype.retry=function(t){if(this._timeout&&clearTimeout(this._timeout),!t)return!1;var e=new Date().getTime();if(t&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(t),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(t);var r=this._timeouts.shift();if(r===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1);else return!1;var s=this;return this._timer=setTimeout(function(){s._attempts++,s._operationTimeoutCb&&(s._timeout=setTimeout(function(){s._operationTimeoutCb(s._attempts)},s._operationTimeout),s._options.unref&&s._timeout.unref()),s._fn(s._attempts)},r),this._options.unref&&this._timer.unref(),!0};fe.prototype.attempt=function(t,e){this._fn=t,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};fe.prototype.try=function(t){console.log("Using RetryOperation.try() is deprecated"),this.attempt(t)};fe.prototype.start=function(t){console.log("Using RetryOperation.start() is deprecated"),this.attempt(t)};fe.prototype.start=fe.prototype.try;fe.prototype.errors=function(){return this._errors};fe.prototype.attempts=function(){return this._attempts};fe.prototype.mainError=function(){if(this._errors.length===0)return null;for(var t={},e=null,r=0,s=0;s<this._errors.length;s++){var i=this._errors[s],n=i.message,o=(t[n]||0)+1;t[n]=o,o>=r&&(e=i,r=o)}return e};(function(t){var e=Ad;t.operation=function(r){var s=t.timeouts(r);return new e(s,{forever:r&&(r.forever||r.retries===1/0),unref:r&&r.unref,maxRetryTime:r&&r.maxRetryTime})},t.timeouts=function(r){if(r instanceof Array)return[].concat(r);var s={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var i in r)s[i]=r[i];if(s.minTimeout>s.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var n=[],o=0;o<s.retries;o++)n.push(this.createTimeout(o,s));return r&&r.forever&&!n.length&&n.push(this.createTimeout(o,s)),n.sort(function(a,l){return a-l}),n},t.createTimeout=function(r,s){var i=s.randomize?Math.random()+1:1,n=Math.round(i*Math.max(s.minTimeout,1)*Math.pow(s.factor,r));return n=Math.min(n,s.maxTimeout),n},t.wrap=function(r,s,i){if(s instanceof Array&&(i=s,s=null),!i){i=[];for(var n in r)typeof r[n]=="function"&&i.push(n)}for(var o=0;o<i.length;o++){var a=i[o],l=r[a];r[a]=(function(d){var c=t.operation(s),m=Array.prototype.slice.call(arguments,1),h=m.pop();m.push(function(f){c.retry(f)||(f&&(arguments[0]=c.mainError()),h.apply(this,arguments))}),c.attempt(function(){d.apply(r,m)})}).bind(r,l),r[a].options=s}}})(go);var Od=go;const Fd=_t(Od),kd=Object.prototype.toString,Ud=t=>kd.call(t)==="[object Error]",Rd=new Set(["network error","Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Load failed","Network request failed","fetch failed","terminated"]);function Cd(t){return t&&Ud(t)&&t.name==="TypeError"&&typeof t.message=="string"?t.message==="Load failed"?t.stack===void 0:Rd.has(t.message):!1}class $s extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}const tn=(t,e,r)=>{const s=r.retries-(e-1);return t.attemptNumber=e,t.retriesLeft=s,t};async function yo(t,e){return new Promise((r,s)=>{e={...e},e.onFailedAttempt??(e.onFailedAttempt=()=>{}),e.shouldRetry??(e.shouldRetry=()=>!0),e.retries??(e.retries=10);const i=Fd.operation(e),n=()=>{var a;i.stop(),s((a=e.signal)==null?void 0:a.reason)};e.signal&&!e.signal.aborted&&e.signal.addEventListener("abort",n,{once:!0});const o=()=>{var a;(a=e.signal)==null||a.removeEventListener("abort",n),i.stop()};i.attempt(async a=>{try{const l=await t(a);o(),r(l)}catch(l){try{if(!(l instanceof Error))throw new TypeError(`Non-error was thrown: "${l}". You should only throw errors.`);if(l instanceof $s)throw l.originalError;if(l instanceof TypeError&&!Cd(l))throw l;if(tn(l,a,e),await e.shouldRetry(l)||(i.stop(),s(l)),await e.onFailedAttempt(l),!i.retry(l))throw i.mainError()}catch(u){tn(u,a,e),o(),s(u)}}})})}class xd extends Error{constructor(e,r){r===void 0&&(r=null),super("This looks like a network error, the endpoint might be blocked by an internet provider or a firewall."),this.cause=e,this.isNetworkError=!0,this.request=r}}function Md(){return fetch(...arguments).catch(t=>{throw t.name==="AbortError"?t:new xd(t)})}function vo(t,e){return Object.prototype.hasOwnProperty.call(t,e)}class $d extends Error{constructor(e,r){super(e),this.cause=r==null?void 0:r.cause,this.cause&&vo(this.cause,"isNetworkError")?this.isNetworkError=this.cause.isNetworkError:this.isNetworkError=!1}}function Nd(t){var e;const s=(e=/^(?:https?:\/\/|\/\/)?(?:[^@\n]+@)?([^\n]+)/i.exec(t))==null?void 0:e[1];return`${/^http:\/\//i.test(t)?"ws":"wss"}://${s}`}class Ld extends Error{constructor(){super("Authorization required"),this.name="AuthError",this.isAuthError=!0}}function Te(t,e){if(!{}.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var jd=0;function Gr(t){return"__private_"+jd+++"_"+t}const Bd={version:"4.4.2"};function Id(t){return t.replace(/\/$/,"")}const _o=10,Dd=5*60*1e3,zd=401;class qd extends Error{constructor(e){let{statusCode:r,message:s}=e;super(s),this.name="HttpError",this.statusCode=r}}async function Hd(t){if(t.status===zd)throw new Ld;if(t.ok)return t.json();let e=`Failed request with status: ${t.status}. ${t.statusText}`,r;try{r=await t.json(),r.message&&(e=`${e} message: ${r.message}`),r.requestId&&(e=`${e} request-Id: ${r.requestId}`)}catch(s){throw new Error(e,{cause:s})}throw t.status>=400&&t.status<=499&&r.message?new Td(r.message):new qd({statusCode:t.status,message:e})}function Gd(t,e,r){const{progress:s,bytesUploaded:i,bytesTotal:n}=e;if(s){var o;t.uppy.log(`Upload progress: ${s}`),t.uppy.emit("upload-progress",r,{uploadStarted:(o=r.progress.uploadStarted)!=null?o:0,bytesUploaded:i,bytesTotal:n})}}var Ae=Gr("companionHeaders"),$t=Gr("getUrl"),us=Gr("requestSocketToken"),Nt=Gr("awaitRemoteFileUpload");class bo{constructor(e,r){Object.defineProperty(this,Nt,{value:Vd}),Object.defineProperty(this,$t,{value:Wd}),Object.defineProperty(this,Ae,{writable:!0,value:void 0}),Object.defineProperty(this,us,{writable:!0,value:async s=>{var i;let{file:n,postBody:o,signal:a}=s;if(((i=n.remote)==null?void 0:i.url)==null)throw new Error("Cannot connect to an undefined URL");return(await this.post(n.remote.url,{...n.remote.body,...o},{signal:a})).token}}),this.uppy=e,this.opts=r,this.onReceiveResponse=this.onReceiveResponse.bind(this),Te(this,Ae)[Ae]=r.companionHeaders}setCompanionHeaders(e){Te(this,Ae)[Ae]=e}[Symbol.for("uppy test: getCompanionHeaders")](){return Te(this,Ae)[Ae]}get hostname(){const{companion:e}=this.uppy.getState(),r=this.opts.companionUrl;return Id(e&&e[r]?e[r]:r)}async headers(e){return e===void 0&&(e=!1),{...{Accept:"application/json",...e?void 0:{"Content-Type":"application/json"}},...Te(this,Ae)[Ae]}}onReceiveResponse(e){const{headers:r}=e,i=this.uppy.getState().companion||{},n=this.opts.companionUrl;r.has("i-am")&&r.get("i-am")!==i[n]&&this.uppy.setState({companion:{...i,[n]:r.get("i-am")}})}async request(e){let{path:r,method:s="GET",data:i,skipPostResponse:n,signal:o}=e;try{const a=await this.headers(!i),l=await Md(Te(this,$t)[$t](r),{method:s,signal:o,headers:a,credentials:this.opts.companionCookiesRule||"same-origin",body:i?JSON.stringify(i):null});return n||this.onReceiveResponse(l),await Hd(l)}catch(a){throw a.isAuthError||a.name==="UserFacingApiError"||a.name==="AbortError"?a:new $d(`Could not ${s} ${Te(this,$t)[$t](r)}`,{cause:a})}}async get(e,r){return this.request({...r,path:e})}async post(e,r,s){return this.request({...s,path:e,method:"POST",data:r})}async delete(e,r,s){return this.request({...s,path:e,method:"DELETE",data:r})}async uploadRemoteFile(e,r,s){var i=this;try{const{signal:n,getQueue:o}=s||{};return await yo(async()=>{var a;const l=(a=this.uppy.getFile(e.id))==null?void 0:a.serverToken;if(l!=null)return this.uppy.log(`Connecting to exiting websocket ${l}`),Te(this,Nt)[Nt]({file:e,queue:o(),signal:n});const d=await o().wrapPromiseFunction(async function(){try{return await Te(i,us)[us](...arguments)}catch(c){if(c.isAuthError)throw new $s(c);if(c.cause==null)throw c;const m=c.cause,h=()=>[408,409,429,418,423].includes(m.statusCode)||m.statusCode>=500&&m.statusCode<=599&&![501,505].includes(m.statusCode);throw m.name==="HttpError"&&!h()?new $s(m):m}},{priority:-1})({file:e,postBody:r,signal:n}).abortOn(n);if(this.uppy.getFile(e.id))return this.uppy.setFileState(e.id,{serverToken:d}),Te(this,Nt)[Nt]({file:this.uppy.getFile(e.id),queue:o(),signal:n})},{retries:_o,signal:n,onFailedAttempt:a=>this.uppy.log(`Retrying upload due to: ${a.message}`,"warning")})}catch(n){if(n.name==="AbortError")return;throw this.uppy.emit("upload-error",e,n),n}}}function Wd(t){return/^(https?:|)\/\//.test(t)?t:`${this.hostname}/${t}`}async function Vd(t){let{file:e,queue:r,signal:s}=t,i;const{capabilities:n}=this.uppy.getState();try{return await new Promise((o,a)=>{const l=e.serverToken,u=Nd(e.remote.companionUrl);let d,c,m,{isPaused:h}=e;const f=(A,x)=>{if(d==null||d.readyState!==d.OPEN){var N;this.uppy.log(`Cannot send "${A}" to socket ${e.id} because the socket state was ${String((N=d)==null?void 0:N.readyState)}`,"warning");return}d.send(JSON.stringify({action:A,payload:x??{}}))};function y(){n.resumableUploads&&f(h?"pause":"resume")}const g=async()=>{c&&c.abort(),c=new AbortController;const A=N=>{var ne;this.uppy.setFileState(e.id,{serverToken:null}),(ne=c)==null||ne.abort==null||ne.abort(),a(N)};function x(){clearTimeout(m),!h&&(m=setTimeout(()=>A(new Error("Timeout waiting for message from Companion socket")),Dd))}try{await r.wrapPromiseFunction(async()=>{await yo(async()=>new Promise((ne,te)=>{d=new WebSocket(`${u}/api/${l}`),x(),d.addEventListener("close",()=>{d=void 0,te(new Error("Socket closed unexpectedly"))}),d.addEventListener("error",wt=>{var De;this.uppy.log(`Companion socket error ${JSON.stringify(wt)}, closing socket`,"warning"),(De=d)==null||De.close()}),d.addEventListener("open",()=>{y()}),d.addEventListener("message",wt=>{x();try{const{action:qe,payload:Pe}=JSON.parse(wt.data);switch(qe){case"progress":{Gd(this,Pe,this.uppy.getFile(e.id));break}case"success":{var De,lr,pt,ze;const He=(De=Pe.response)==null?void 0:De.responseText;this.uppy.emit("upload-success",this.uppy.getFile(e.id),{uploadURL:Pe.url,status:(lr=(pt=Pe.response)==null?void 0:pt.status)!=null?lr:200,body:He?JSON.parse(He):void 0}),(ze=c)==null||ze.abort==null||ze.abort(),o();break}case"error":{const{message:He}=Pe.error;throw Object.assign(new Error(He),{cause:Pe.error})}default:this.uppy.log(`Companion socket unknown action ${qe}`,"warning")}}catch(qe){A(qe)}});const Se=()=>{this.uppy.log(`Closing socket ${e.id}`),clearTimeout(m),d&&d.close(),d=void 0};c.signal.addEventListener("abort",()=>{Se()})}),{retries:_o,signal:c.signal,onFailedAttempt:()=>{c.signal.aborted||this.uppy.log(`Retrying websocket ${e.id}`)}})})().abortOn(c.signal)}catch(N){if(c.signal.aborted)return;A(N)}},v=A=>{n.resumableUploads&&(h=A,d&&y())},S=A=>{var x;n.individualCancellation&&A.id===e.id&&(f("cancel"),(x=c)==null||x.abort==null||x.abort(),this.uppy.log(`upload ${e.id} was removed`),o())},U=()=>{var A;f("cancel"),(A=c)==null||A.abort==null||A.abort(),this.uppy.log(`upload ${e.id} was canceled`),o()},F=(A,x)=>{(A==null?void 0:A.id)===e.id&&v(x)},C=()=>v(!0),P=()=>v(!1);this.uppy.on("file-removed",S),this.uppy.on("cancel-all",U),this.uppy.on("upload-pause",F),this.uppy.on("pause-all",C),this.uppy.on("resume-all",P),i=()=>{this.uppy.off("file-removed",S),this.uppy.off("cancel-all",U),this.uppy.off("upload-pause",F),this.uppy.off("pause-all",C),this.uppy.off("resume-all",P)},s.addEventListener("abort",()=>{var A;(A=c)==null||A.abort()}),g()})}finally{i==null||i()}}bo.VERSION=Bd.version;function Oe(t,e){if(!{}.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var Jd=0;function wo(t){return"__private_"+Jd+++"_"+t}var K=wo("uppy"),Lt=wo("events");class Kd{constructor(e){Object.defineProperty(this,K,{writable:!0,value:void 0}),Object.defineProperty(this,Lt,{writable:!0,value:[]}),Oe(this,K)[K]=e}on(e,r){return Oe(this,Lt)[Lt].push([e,r]),Oe(this,K)[K].on(e,r)}remove(){for(const[e,r]of Oe(this,Lt)[Lt].splice(0))Oe(this,K)[K].off(e,r)}onFilePause(e,r){this.on("upload-pause",(s,i)=>{e===(s==null?void 0:s.id)&&r(i)})}onFileRemove(e,r){this.on("file-removed",s=>{e===s.id&&r(s.id)})}onPause(e,r){this.on("upload-pause",(s,i)=>{e===(s==null?void 0:s.id)&&r(i)})}onRetry(e,r){this.on("upload-retry",s=>{e===(s==null?void 0:s.id)&&r()})}onRetryAll(e,r){this.on("retry-all",()=>{Oe(this,K)[K].getFile(e)&&r()})}onPauseAll(e,r){this.on("pause-all",()=>{Oe(this,K)[K].getFile(e)&&r()})}onCancelAll(e,r){var s=this;this.on("cancel-all",function(){Oe(s,K)[K].getFile(e)&&r(...arguments)})}onResumeAll(e,r){this.on("resume-all",()=>{Oe(this,K)[K].getFile(e)&&r()})}}function T(t,e){if(!{}.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var Xd=0;function se(t){return"__private_"+Xd+++"_"+t}function Yd(t){return new Error("Cancelled",{cause:t})}function rn(t){if(t!=null){var e;const r=()=>this.abort(t.reason);t.addEventListener("abort",r,{once:!0});const s=()=>{t.removeEventListener("abort",r)};(e=this.then)==null||e.call(this,s,s)}return this}var le=se("activeRequests"),Z=se("queuedHandlers"),oe=se("paused"),Ge=se("pauseTimer"),X=se("downLimit"),We=se("upperLimit"),Fe=se("rateLimitingTimer"),Zt=se("call"),Le=se("queueNext"),Ns=se("next"),cs=se("queue"),Ls=se("dequeue"),ds=se("resume"),Ve=se("increaseLimit");class Qd{constructor(e){Object.defineProperty(this,Ls,{value:sp}),Object.defineProperty(this,cs,{value:rp}),Object.defineProperty(this,Ns,{value:tp}),Object.defineProperty(this,Le,{value:ep}),Object.defineProperty(this,Zt,{value:Zd}),Object.defineProperty(this,le,{writable:!0,value:0}),Object.defineProperty(this,Z,{writable:!0,value:[]}),Object.defineProperty(this,oe,{writable:!0,value:!1}),Object.defineProperty(this,Ge,{writable:!0,value:void 0}),Object.defineProperty(this,X,{writable:!0,value:1}),Object.defineProperty(this,We,{writable:!0,value:void 0}),Object.defineProperty(this,Fe,{writable:!0,value:void 0}),Object.defineProperty(this,ds,{writable:!0,value:()=>this.resume()}),Object.defineProperty(this,Ve,{writable:!0,value:()=>{if(T(this,oe)[oe]){T(this,Fe)[Fe]=setTimeout(T(this,Ve)[Ve],0);return}T(this,X)[X]=this.limit,this.limit=Math.ceil((T(this,We)[We]+T(this,X)[X])/2);for(let r=T(this,X)[X];r<=this.limit;r++)T(this,Le)[Le]();T(this,We)[We]-T(this,X)[X]>3?T(this,Fe)[Fe]=setTimeout(T(this,Ve)[Ve],2e3):T(this,X)[X]=Math.floor(T(this,X)[X]/2)}}),typeof e!="number"||e===0?this.limit=1/0:this.limit=e}run(e,r){return!T(this,oe)[oe]&&T(this,le)[le]<this.limit?T(this,Zt)[Zt](e):T(this,cs)[cs](e,r)}wrapSyncFunction(e,r){var s=this;return function(){for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];const a=s.run(()=>(e(...n),queueMicrotask(()=>a.done()),()=>{}),r);return{abortOn:rn,abort(){a.abort()}}}}wrapPromiseFunction(e,r){var s=this;return function(){for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];let a;const l=new Promise((u,d)=>{a=s.run(()=>{let c,m;try{m=Promise.resolve(e(...n))}catch(h){m=Promise.reject(h)}return m.then(h=>{c?d(c):(a.done(),u(h))},h=>{c?d(c):(a.done(),d(h))}),h=>{c=Yd(h)}},r)});return l.abort=u=>{a.abort(u)},l.abortOn=rn,l}}resume(){T(this,oe)[oe]=!1,clearTimeout(T(this,Ge)[Ge]);for(let e=0;e<this.limit;e++)T(this,Le)[Le]()}pause(e){e===void 0&&(e=null),T(this,oe)[oe]=!0,clearTimeout(T(this,Ge)[Ge]),e!=null&&(T(this,Ge)[Ge]=setTimeout(T(this,ds)[ds],e))}rateLimit(e){clearTimeout(T(this,Fe)[Fe]),this.pause(e),this.limit>1&&Number.isFinite(this.limit)&&(T(this,We)[We]=this.limit-1,this.limit=T(this,X)[X],T(this,Fe)[Fe]=setTimeout(T(this,Ve)[Ve],e))}get isPaused(){return T(this,oe)[oe]}}function Zd(t){T(this,le)[le]+=1;let e=!1,r;try{r=t()}catch(s){throw T(this,le)[le]-=1,s}return{abort:s=>{e||(e=!0,T(this,le)[le]-=1,r==null||r(s),T(this,Le)[Le]())},done:()=>{e||(e=!0,T(this,le)[le]-=1,T(this,Le)[Le]())}}}function ep(){queueMicrotask(()=>T(this,Ns)[Ns]())}function tp(){if(T(this,oe)[oe]||T(this,le)[le]>=this.limit||T(this,Z)[Z].length===0)return;const t=T(this,Z)[Z].shift();if(t==null)throw new Error("Invariant violation: next is null");const e=T(this,Zt)[Zt](t.fn);t.abort=e.abort,t.done=e.done}function rp(t,e){const r={fn:t,priority:(e==null?void 0:e.priority)||0,abort:()=>{T(this,Ls)[Ls](r)},done:()=>{throw new Error("Cannot mark a queued request as done: this indicates a bug")}},s=T(this,Z)[Z].findIndex(i=>r.priority>i.priority);return s===-1?T(this,Z)[Z].push(r):T(this,Z)[Z].splice(s,0,r),r}function sp(t){const e=T(this,Z)[Z].indexOf(t);e!==-1&&T(this,Z)[Z].splice(e,1)}function ip(t){const e=r=>"error"in r&&!!r.error;return t.filter(r=>!e(r))}function np(t){return t.filter(e=>{var r;return!((r=e.progress)!=null&&r.uploadStarted)||!e.isRestored})}const{AbortController:ps}=globalThis,So=function(t,e){t===void 0&&(t="Aborted");const r=new DOMException(t,"AbortError");return e!=null&&vo(e,"cause")&&Object.defineProperty(r,"cause",{__proto__:null,configurable:!0,writable:!0,value:e.cause}),r};function sn(t,e){return t===!0?Object.keys(e):Array.isArray(t)?t:[]}function w(t,e){if(!{}.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var op=0;function I(t){return"__private_"+op+++"_"+t}const ap=1024*1024,nn={getChunkSize(t){return Math.ceil(t.size/1e4)},onProgress(){},onPartComplete(){},onSuccess(){},onError(t){throw t}};function lp(t){if(typeof t=="string")return parseInt(t,10);if(typeof t=="number")return t;throw new TypeError("Expected a number")}const Er=Symbol("pausing upload, not an actual error");var W=I("abortController"),B=I("chunks"),Q=I("chunkState"),ue=I("data"),de=I("file"),er=I("uploadHasStarted"),jt=I("onError"),ct=I("onSuccess"),Me=I("shouldUseMultipart"),rt=I("isRestoring"),nr=I("onReject"),Xe=I("maxMultipartParts"),Kt=I("minPartSize"),hs=I("initChunks"),fs=I("createUpload"),Bt=I("resumeUpload"),Xt=I("onPartProgress"),Yt=I("onPartComplete"),ms=I("abortUpload");class up{constructor(e,r){var s,i;Object.defineProperty(this,ms,{value:hp}),Object.defineProperty(this,Bt,{value:pp}),Object.defineProperty(this,fs,{value:dp}),Object.defineProperty(this,hs,{value:cp}),Object.defineProperty(this,W,{writable:!0,value:new ps}),Object.defineProperty(this,B,{writable:!0,value:[]}),Object.defineProperty(this,Q,{writable:!0,value:[]}),Object.defineProperty(this,ue,{writable:!0,value:void 0}),Object.defineProperty(this,de,{writable:!0,value:void 0}),Object.defineProperty(this,er,{writable:!0,value:!1}),Object.defineProperty(this,jt,{writable:!0,value:void 0}),Object.defineProperty(this,ct,{writable:!0,value:void 0}),Object.defineProperty(this,Me,{writable:!0,value:void 0}),Object.defineProperty(this,rt,{writable:!0,value:void 0}),Object.defineProperty(this,nr,{writable:!0,value:n=>(n==null?void 0:n.cause)===Er?null:w(this,jt)[jt](n)}),Object.defineProperty(this,Xe,{writable:!0,value:1e4}),Object.defineProperty(this,Kt,{writable:!0,value:5*ap}),Object.defineProperty(this,Xt,{writable:!0,value:n=>o=>{if(!o.lengthComputable)return;w(this,Q)[Q][n].uploaded=lp(o.loaded);const a=w(this,Q)[Q].reduce((l,u)=>l+u.uploaded,0);this.options.onProgress(a,w(this,ue)[ue].size)}}),Object.defineProperty(this,Yt,{writable:!0,value:n=>o=>{w(this,B)[B][n]=null,w(this,Q)[Q][n].etag=o,w(this,Q)[Q][n].done=!0;const a={PartNumber:n+1,ETag:o};this.options.onPartComplete(a)}}),this.options={...nn,...r},(i=(s=this.options).getChunkSize)!=null||(s.getChunkSize=nn.getChunkSize),w(this,ue)[ue]=e,w(this,de)[de]=r.file,w(this,ct)[ct]=this.options.onSuccess,w(this,jt)[jt]=this.options.onError,w(this,Me)[Me]=this.options.shouldUseMultipart,w(this,rt)[rt]=r.uploadId&&r.key,w(this,hs)[hs]()}start(){w(this,er)[er]?(w(this,W)[W].signal.aborted||w(this,W)[W].abort(Er),w(this,W)[W]=new ps,w(this,Bt)[Bt]()):w(this,rt)[rt]?(this.options.companionComm.restoreUploadFile(w(this,de)[de],{uploadId:this.options.uploadId,key:this.options.key}),w(this,Bt)[Bt]()):w(this,fs)[fs]()}pause(){w(this,W)[W].abort(Er),w(this,W)[W]=new ps}abort(e){e!=null&&e.really?w(this,ms)[ms]():this.pause()}[Symbol.for("uppy test: getChunkState")](){return w(this,Q)[Q]}}function cp(){const t=w(this,ue)[ue].size,e=typeof w(this,Me)[Me]=="function"?w(this,Me)[Me](w(this,de)[de]):!!w(this,Me)[Me];if(e&&t>w(this,Kt)[Kt]){let r=Math.max(this.options.getChunkSize(w(this,ue)[ue]),w(this,Kt)[Kt]),s=Math.floor(t/r);s>w(this,Xe)[Xe]&&(s=w(this,Xe)[Xe],r=t/w(this,Xe)[Xe]),w(this,B)[B]=Array(s);for(let i=0,n=0;i<t;i+=r,n++){const o=Math.min(t,i+r),a=()=>{const l=i;return w(this,ue)[ue].slice(l,o)};if(w(this,B)[B][n]={getData:a,onProgress:w(this,Xt)[Xt](n),onComplete:w(this,Yt)[Yt](n),shouldUseMultipart:e},w(this,rt)[rt]){const l=i+r>t?t-i:r;w(this,B)[B][n].setAsUploaded=()=>{w(this,B)[B][n]=null,w(this,Q)[Q][n].uploaded=l}}}}else w(this,B)[B]=[{getData:()=>w(this,ue)[ue],onProgress:w(this,Xt)[Xt](0),onComplete:w(this,Yt)[Yt](0),shouldUseMultipart:e}];w(this,Q)[Q]=w(this,B)[B].map(()=>({uploaded:0}))}function dp(){this.options.companionComm.uploadFile(w(this,de)[de],w(this,B)[B],w(this,W)[W].signal).then(w(this,ct)[ct],w(this,nr)[nr]),w(this,er)[er]=!0}function pp(){this.options.companionComm.resumeUploadFile(w(this,de)[de],w(this,B)[B],w(this,W)[W].signal).then(w(this,ct)[ct],w(this,nr)[nr])}function hp(){w(this,W)[W].abort(),this.options.companionComm.abortFileUpload(w(this,de)[de]).catch(t=>this.options.log(t))}function J(t){if(t!=null&&t.aborted)throw So("The operation was aborted",{cause:t.reason})}function fp(t){let{method:e="PUT",CanonicalUri:r="/",CanonicalQueryString:s="",SignedHeaders:i,HashedPayload:n}=t;const o=Object.keys(i).map(a=>a.toLowerCase()).sort();return[e,r,s,...o.map(a=>`${a}:${i[a]}`),"",o.join(";"),n].join(`
`)}const Zs=new TextEncoder,ei={name:"HMAC",hash:"SHA-256"};async function mp(t){const{subtle:e}=globalThis.crypto;return e.digest(ei.hash,Zs.encode(t))}async function gp(t){const{subtle:e}=globalThis.crypto;return e.importKey("raw",typeof t=="string"?Zs.encode(t):t,ei,!1,["sign"])}function on(t){const e=new Uint8Array(t);let r="";for(let s=0;s<e.length;s++)r+=e[s].toString(16).padStart(2,"0");return r}async function It(t,e){const{subtle:r}=globalThis.crypto;return r.sign(ei,await gp(t),Zs.encode(e))}async function yp(t){let{accountKey:e,accountSecret:r,sessionToken:s,bucketName:i,Key:n,Region:o,expires:a,uploadId:l,partNumber:u}=t;const d="s3",c=`${d}.${o}.amazonaws.com`,m=`/${i}/${encodeURI(n).replace(/[;?:@&=+$,#!'()*]/g,ne=>`%${ne.charCodeAt(0).toString(16).toUpperCase()}`)}`,h="UNSIGNED-PAYLOAD",f=new Date().toISOString().replace(/[-:]|\.\d+/g,""),y=f.slice(0,8),g=`${y}/${o}/${d}/aws4_request`,v=new URL(`https://${c}${m}`);v.searchParams.set("X-Amz-Algorithm","AWS4-HMAC-SHA256"),v.searchParams.set("X-Amz-Content-Sha256",h),v.searchParams.set("X-Amz-Credential",`${e}/${g}`),v.searchParams.set("X-Amz-Date",f),v.searchParams.set("X-Amz-Expires",a),v.searchParams.set("X-Amz-Security-Token",s),v.searchParams.set("X-Amz-SignedHeaders","host"),u&&v.searchParams.set("partNumber",u),l&&v.searchParams.set("uploadId",l),v.searchParams.set("x-id",u&&l?"UploadPart":"PutObject");const S=fp({CanonicalUri:m,CanonicalQueryString:v.search.slice(1),SignedHeaders:{host:c},HashedPayload:h}),U=on(await mp(S)),F=["AWS4-HMAC-SHA256",f,g,U].join(`
`),C=await It(`AWS4${r}`,y),P=await It(C,o),A=await It(P,d),x=await It(A,"aws4_request"),N=on(await It(x,F));return v.searchParams.set("X-Amz-Signature",N),v}function O(t,e){if(!{}.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var vp=0;function ee(t){return"__private_"+vp+++"_"+t}function _p(t){const e=new URL(t);return e.search="",e.hash="",e.href}var Dt=ee("abortMultipartUpload"),z=ee("cache"),zt=ee("createMultipartUpload"),qt=ee("fetchSignature"),tr=ee("getUploadParameters"),Ht=ee("listParts"),Ye=ee("previousRetryDelay"),st=ee("requests"),Je=ee("retryDelays"),Ke=ee("sendCompletionRequest"),Ce=ee("setS3MultipartState"),it=ee("uploadPartBytes"),H=ee("getFile"),gs=ee("shouldRetry"),Gt=ee("nonMultipartUpload");class bp{constructor(e,r,s,i){Object.defineProperty(this,Gt,{value:Sp}),Object.defineProperty(this,gs,{value:wp}),Object.defineProperty(this,Dt,{writable:!0,value:void 0}),Object.defineProperty(this,z,{writable:!0,value:new WeakMap}),Object.defineProperty(this,zt,{writable:!0,value:void 0}),Object.defineProperty(this,qt,{writable:!0,value:void 0}),Object.defineProperty(this,tr,{writable:!0,value:void 0}),Object.defineProperty(this,Ht,{writable:!0,value:void 0}),Object.defineProperty(this,Ye,{writable:!0,value:void 0}),Object.defineProperty(this,st,{writable:!0,value:void 0}),Object.defineProperty(this,Je,{writable:!0,value:void 0}),Object.defineProperty(this,Ke,{writable:!0,value:void 0}),Object.defineProperty(this,Ce,{writable:!0,value:void 0}),Object.defineProperty(this,it,{writable:!0,value:void 0}),Object.defineProperty(this,H,{writable:!0,value:void 0}),O(this,st)[st]=e,O(this,Ce)[Ce]=s,O(this,H)[H]=i,this.setOptions(r)}setOptions(e){const r=O(this,st)[st];if("abortMultipartUpload"in e&&(O(this,Dt)[Dt]=r.wrapPromiseFunction(e.abortMultipartUpload,{priority:1})),"createMultipartUpload"in e&&(O(this,zt)[zt]=r.wrapPromiseFunction(e.createMultipartUpload,{priority:-1})),"signPart"in e&&(O(this,qt)[qt]=r.wrapPromiseFunction(e.signPart)),"listParts"in e&&(O(this,Ht)[Ht]=r.wrapPromiseFunction(e.listParts)),"completeMultipartUpload"in e&&(O(this,Ke)[Ke]=r.wrapPromiseFunction(e.completeMultipartUpload,{priority:1})),"retryDelays"in e){var s;O(this,Je)[Je]=(s=e.retryDelays)!=null?s:[]}"uploadPartBytes"in e&&(O(this,it)[it]=r.wrapPromiseFunction(e.uploadPartBytes,{priority:1/0})),"getUploadParameters"in e&&(O(this,tr)[tr]=r.wrapPromiseFunction(e.getUploadParameters))}async getUploadId(e,r){let s;for(;(s=O(this,z)[z].get(e.data))!=null;)try{return await s}catch{}const i=O(this,zt)[zt](O(this,H)[H](e),r),n=()=>{i.abort(r.reason),O(this,z)[z].delete(e.data)};return r.addEventListener("abort",n,{once:!0}),O(this,z)[z].set(e.data,i),i.then(async o=>{r.removeEventListener("abort",n),O(this,Ce)[Ce](e,o),O(this,z)[z].set(e.data,o)},()=>{r.removeEventListener("abort",n),O(this,z)[z].delete(e.data)}),i}async abortFileUpload(e){const r=O(this,z)[z].get(e.data);if(r==null)return;O(this,z)[z].delete(e.data),O(this,Ce)[Ce](e,Object.create(null));let s;try{s=await r}catch{return}await O(this,Dt)[Dt](O(this,H)[H](e),s)}async uploadFile(e,r,s){if(J(s),r.length===1&&!r[0].shouldUseMultipart)return O(this,Gt)[Gt](e,r[0],s);const{uploadId:i,key:n}=await this.getUploadId(e,s);J(s);try{const o=await Promise.all(r.map((a,l)=>this.uploadChunk(e,l+1,a,s)));return J(s),await O(this,Ke)[Ke](O(this,H)[H](e),{key:n,uploadId:i,parts:o,signal:s},s).abortOn(s)}catch(o){throw(o==null?void 0:o.cause)!==Er&&(o==null?void 0:o.name)!=="AbortError"&&this.abortFileUpload(e),o}}restoreUploadFile(e,r){O(this,z)[z].set(e.data,r)}async resumeUploadFile(e,r,s){if(J(s),r.length===1&&r[0]!=null&&!r[0].shouldUseMultipart)return O(this,Gt)[Gt](e,r[0],s);const{uploadId:i,key:n}=await this.getUploadId(e,s);J(s);const o=await O(this,Ht)[Ht](O(this,H)[H](e),{uploadId:i,key:n,signal:s},s).abortOn(s);J(s);const a=await Promise.all(r.map((l,u)=>{const d=u+1,c=o.find(m=>{let{PartNumber:h}=m;return h===d});return c==null?this.uploadChunk(e,d,l,s):(l==null||l.setAsUploaded==null||l.setAsUploaded(),{PartNumber:d,ETag:c.ETag})}));return J(s),O(this,Ke)[Ke](O(this,H)[H](e),{key:n,uploadId:i,parts:a,signal:s},s).abortOn(s)}async uploadChunk(e,r,s,i){J(i);const{uploadId:n,key:o}=await this.getUploadId(e,i),a=O(this,Je)[Je].values(),l=O(this,Je)[Je].values(),u=()=>{const d=a.next();return d==null||d.done?null:d.value};for(;;){J(i);const d=s.getData(),{onProgress:c,onComplete:m}=s;let h;try{h=await O(this,qt)[qt](O(this,H)[H](e),{uploadId:n,key:o,partNumber:r,body:d,signal:i}).abortOn(i)}catch(f){const y=u();if(y==null||i.aborted)throw f;await new Promise(g=>setTimeout(g,y));continue}J(i);try{return{PartNumber:r,...await O(this,it)[it]({signature:h,body:d,size:d.size,onProgress:c,onComplete:m,signal:i}).abortOn(i)}}catch(f){if(!await O(this,gs)[gs](f,l))throw f}}}}async function wp(t,e){var r;const s=O(this,st)[st],i=t==null||(r=t.source)==null?void 0:r.status;if(i==null)return!1;if(i===403&&t.message==="Request has expired"){if(!s.isPaused){if(s.limit===1||O(this,Ye)[Ye]==null){const n=e.next();if(n==null||n.done)return!1;O(this,Ye)[Ye]=n.value}s.rateLimit(0),await new Promise(n=>setTimeout(n,O(this,Ye)[Ye]))}}else if(i===429){if(!s.isPaused){const n=e.next();if(n==null||n.done)return!1;s.rateLimit(n.value)}}else{if(i>400&&i<500&&i!==409)return!1;if(typeof navigator<"u"&&navigator.onLine===!1)s.isPaused||(s.pause(),window.addEventListener("online",()=>{s.resume()},{once:!0}));else{const n=e.next();if(n==null||n.done)return!1;await new Promise(o=>setTimeout(o,n.value))}}return!0}async function Sp(t,e,r){var s;const{method:i="POST",url:n,fields:o,headers:a}=await O(this,tr)[tr](O(this,H)[H](t),{signal:r}).abortOn(r);let l;const u=e.getData();if(i.toUpperCase()==="POST"){const f=new FormData;Object.entries(o).forEach(y=>{let[g,v]=y;return f.set(g,v)}),f.set("file",u),l=f}else l=u;const{onProgress:d,onComplete:c}=e,m=await O(this,it)[it]({signature:{url:n,headers:a,method:i},body:l,size:u.size,onProgress:d,onComplete:c,signal:r}).abortOn(r),h=o==null?void 0:o.key;return O(this,Ce)[Ce](t,{key:h}),{...m,location:(s=m.location)!=null?s:_p(n),bucket:o==null?void 0:o.bucket,key:h}}function E(t,e){if(!{}.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var Pp=0;function ie(t){return"__private_"+Pp+++"_"+t}const Ep={version:"4.2.3"};function ht(t){if(t!=null&&t.error){const e=new Error(t.message);throw Object.assign(e,t.error),e}return t}function Po(t){const e=t.Expiration;if(e){const r=Math.floor((new Date(e)-Date.now())/1e3);if(r>9)return r}}function an(t){let{meta:e,allowedMetaFields:r,querify:s=!1}=t;const i=r??Object.keys(e);return e?Object.fromEntries(i.filter(n=>e[n]!=null).map(n=>{const o=s?`metadata[${n}]`:n,a=String(e[n]);return[o,a]})):{}}const Tp={allowedMetaFields:!0,limit:6,getTemporarySecurityCredentials:!1,shouldUseMultipart:t=>(t.size||0)>100*1024*1024,retryDelays:[0,1e3,3e3,5e3]};var nt=ie("companionCommunicationQueue"),$=ie("client"),Wt=ie("setClient"),Y=ie("assertHost"),q=ie("cachedTemporaryCredentials"),ys=ie("getTemporarySecurityCredentials"),vs=ie("setS3MultipartState"),ut=ie("getFile"),_s=ie("uploadLocalFile"),bs=ie("getCompanionClientArgs"),Vt=ie("upload"),ot=ie("setCompanionHeaders"),ke=ie("setResumableUploadsCapability"),Jt=ie("resetResumableCapability");class Wr extends no{constructor(e,r){var s;super(e,{...Tp,uploadPartBytes:Wr.uploadPartBytes,createMultipartUpload:null,listParts:null,abortMultipartUpload:null,completeMultipartUpload:null,signPart:null,getUploadParameters:null,...r}),Object.defineProperty(this,bs,{value:Up}),Object.defineProperty(this,_s,{value:kp}),Object.defineProperty(this,ys,{value:Fp}),Object.defineProperty(this,Y,{value:Op}),Object.defineProperty(this,Wt,{value:Ap}),Object.defineProperty(this,nt,{writable:!0,value:void 0}),Object.defineProperty(this,$,{writable:!0,value:void 0}),Object.defineProperty(this,q,{writable:!0,value:void 0}),Object.defineProperty(this,vs,{writable:!0,value:(n,o)=>{let{key:a,uploadId:l}=o;const u=this.uppy.getFile(n.id);u!=null&&this.uppy.setFileState(n.id,{s3Multipart:{...u.s3Multipart,key:a,uploadId:l}})}}),Object.defineProperty(this,ut,{writable:!0,value:n=>this.uppy.getFile(n.id)||n}),Object.defineProperty(this,Vt,{writable:!0,value:async n=>{if(n.length===0)return;const o=this.uppy.getFilesByIds(n),a=ip(o),l=np(a);this.uppy.emit("upload-start",l);const u=a.map(c=>{if(c.isRemote){const m=()=>this.requests;E(this,ke)[ke](!1);const h=new AbortController,f=g=>{g.id===c.id&&h.abort()};this.uppy.on("file-removed",f);const y=this.uppy.getRequestClientForFile(c).uploadRemoteFile(c,E(this,bs)[bs](c),{signal:h.signal,getQueue:m});return this.requests.wrapSyncFunction(()=>{this.uppy.off("file-removed",f)},{priority:-1})(),y}return E(this,_s)[_s](c)}),d=await Promise.allSettled(u);return E(this,ke)[ke](!0),d}}),Object.defineProperty(this,ot,{writable:!0,value:()=>{var n;(n=E(this,$)[$])==null||n.setCompanionHeaders(this.opts.headers)}}),Object.defineProperty(this,ke,{writable:!0,value:n=>{const{capabilities:o}=this.uppy.getState();this.uppy.setState({capabilities:{...o,resumableUploads:n}})}}),Object.defineProperty(this,Jt,{writable:!0,value:()=>{E(this,ke)[ke](!0)}}),this.type="uploader",this.id=this.opts.id||"AwsS3Multipart",E(this,Wt)[Wt](r);const i={createMultipartUpload:this.createMultipartUpload,listParts:this.listParts,abortMultipartUpload:this.abortMultipartUpload,completeMultipartUpload:this.completeMultipartUpload,signPart:r!=null&&r.getTemporarySecurityCredentials?this.createSignedURL:this.signPart,getUploadParameters:r!=null&&r.getTemporarySecurityCredentials?this.createSignedURL:this.getUploadParameters};for(const n of Object.keys(i))this.opts[n]==null&&(this.opts[n]=i[n].bind(this));this.requests=(s=this.opts.rateLimitedQueue)!=null?s:new Qd(this.opts.limit),E(this,nt)[nt]=new bp(this.requests,this.opts,E(this,vs)[vs],E(this,ut)[ut]),this.uploaders=Object.create(null),this.uploaderEvents=Object.create(null)}[Symbol.for("uppy test: getClient")](){return E(this,$)[$]}setOptions(e){E(this,nt)[nt].setOptions(e),super.setOptions(e),E(this,Wt)[Wt](e)}resetUploaderReferences(e,r){this.uploaders[e]&&(this.uploaders[e].abort({really:(r==null?void 0:r.abort)||!1}),this.uploaders[e]=null),this.uploaderEvents[e]&&(this.uploaderEvents[e].remove(),this.uploaderEvents[e]=null)}createMultipartUpload(e,r){E(this,Y)[Y]("createMultipartUpload"),J(r);const s=sn(this.opts.allowedMetaFields,e.meta),i=an({meta:e.meta,allowedMetaFields:s});return E(this,$)[$].post("s3/multipart",{filename:e.name,type:e.type,metadata:i},{signal:r}).then(ht)}listParts(e,r,s){var i;let{key:n,uploadId:o,signal:a}=r;(i=a)!=null||(a=s),E(this,Y)[Y]("listParts"),J(a);const l=encodeURIComponent(n);return E(this,$)[$].get(`s3/multipart/${encodeURIComponent(o)}?key=${l}`,{signal:a}).then(ht)}completeMultipartUpload(e,r,s){var i;let{key:n,uploadId:o,parts:a,signal:l}=r;(i=l)!=null||(l=s),E(this,Y)[Y]("completeMultipartUpload"),J(l);const u=encodeURIComponent(n),d=encodeURIComponent(o);return E(this,$)[$].post(`s3/multipart/${d}/complete?key=${u}`,{parts:a.map(c=>{let{ETag:m,PartNumber:h}=c;return{ETag:m,PartNumber:h}})},{signal:l}).then(ht)}async createSignedURL(e,r){const s=await E(this,ys)[ys](r),i=Po(s.credentials)||604800,{uploadId:n,key:o,partNumber:a}=r;return{method:"PUT",expires:i,fields:{},url:`${await yp({accountKey:s.credentials.AccessKeyId,accountSecret:s.credentials.SecretAccessKey,sessionToken:s.credentials.SessionToken,expires:i,bucketName:s.bucket,Region:s.region,Key:o??`${crypto.randomUUID()}-${e.name}`,uploadId:n,partNumber:a})}`,headers:{"Content-Type":e.type}}}signPart(e,r){let{uploadId:s,key:i,partNumber:n,signal:o}=r;if(E(this,Y)[Y]("signPart"),J(o),s==null||i==null||n==null)throw new Error("Cannot sign without a key, an uploadId, and a partNumber");const a=encodeURIComponent(i);return E(this,$)[$].get(`s3/multipart/${encodeURIComponent(s)}/${n}?key=${a}`,{signal:o}).then(ht)}abortMultipartUpload(e,r){let{key:s,uploadId:i,signal:n}=r;E(this,Y)[Y]("abortMultipartUpload");const o=encodeURIComponent(s),a=encodeURIComponent(i);return E(this,$)[$].delete(`s3/multipart/${a}?key=${o}`,void 0,{signal:n}).then(ht)}getUploadParameters(e,r){E(this,Y)[Y]("getUploadParameters");const{meta:s}=e,{type:i,name:n}=s,o=sn(this.opts.allowedMetaFields,e.meta),a=an({meta:s,allowedMetaFields:o,querify:!0}),l=new URLSearchParams({filename:n,type:i,...a});return E(this,$)[$].get(`s3/params?${l}`,r)}static async uploadPartBytes(e){let{signature:{url:r,expires:s,headers:i,method:n="PUT"},body:o,size:a=o.size,onProgress:l,onComplete:u,signal:d}=e;if(J(d),r==null)throw new Error("Cannot upload to an undefined URL");return new Promise((c,m)=>{const h=new XMLHttpRequest;h.open(n,r,!0),i&&Object.keys(i).forEach(g=>{h.setRequestHeader(g,i[g])}),h.responseType="text",typeof s=="number"&&(h.timeout=s*1e3);function f(){h.abort()}function y(){d==null||d.removeEventListener("abort",f)}d==null||d.addEventListener("abort",f),h.upload.addEventListener("progress",g=>{l(g)}),h.addEventListener("abort",()=>{y(),m(So())}),h.addEventListener("timeout",()=>{y();const g=new Error("Request has expired");g.source={status:403},m(g)}),h.addEventListener("load",()=>{if(y(),h.status===403&&h.responseText.includes("<Message>Request has expired</Message>")){const F=new Error("Request has expired");F.source=h,m(F);return}if(h.status<200||h.status>=300){const F=new Error("Non 2xx");F.source=h,m(F);return}l==null||l({loaded:a,lengthComputable:!0});const g=h.getAllResponseHeaders().trim().split(/[\r\n]+/),v={__proto__:null};for(const F of g){const C=F.split(": "),P=C.shift(),A=C.join(": ");v[P]=A}const{etag:S,location:U}=v;if(n.toUpperCase()==="POST"&&U==null&&console.error("@uppy/aws-s3: Could not read the Location header. This likely means CORS is not configured correctly on the S3 Bucket. See https://uppy.io/docs/aws-s3/#setting-up-your-s3-bucket"),S==null){console.error("@uppy/aws-s3: Could not read the ETag header. This likely means CORS is not configured correctly on the S3 Bucket. See https://uppy.io/docs/aws-s3/#setting-up-your-s3-bucket");return}u==null||u(S),c({...v,ETag:S})}),h.addEventListener("error",g=>{y();const v=new Error("Unknown error");v.source=g.target,m(v)}),h.send(o)})}install(){E(this,ke)[ke](!0),this.uppy.addPreProcessor(E(this,ot)[ot]),this.uppy.addUploader(E(this,Vt)[Vt]),this.uppy.on("cancel-all",E(this,Jt)[Jt])}uninstall(){this.uppy.removePreProcessor(E(this,ot)[ot]),this.uppy.removeUploader(E(this,Vt)[Vt]),this.uppy.off("cancel-all",E(this,Jt)[Jt])}}function Ap(t){t==null||!("endpoint"in t||"companionUrl"in t||"headers"in t||"companionHeaders"in t||"cookiesRule"in t||"companionCookiesRule"in t)||("companionUrl"in t&&!("endpoint"in t)&&this.uppy.log("`companionUrl` option has been removed in @uppy/aws-s3, use `endpoint` instead.","warning"),"companionHeaders"in t&&!("headers"in t)&&this.uppy.log("`companionHeaders` option has been removed in @uppy/aws-s3, use `headers` instead.","warning"),"companionCookiesRule"in t&&!("cookiesRule"in t)&&this.uppy.log("`companionCookiesRule` option has been removed in @uppy/aws-s3, use `cookiesRule` instead.","warning"),"endpoint"in t?E(this,$)[$]=new bo(this.uppy,{pluginId:this.id,provider:"AWS",companionUrl:this.opts.endpoint,companionHeaders:this.opts.headers,companionCookiesRule:this.opts.cookiesRule}):("headers"in t&&E(this,ot)[ot](),"cookiesRule"in t&&(E(this,$)[$].opts.companionCookiesRule=t.cookiesRule)))}function Op(t){if(!E(this,$)[$])throw new Error(`Expected a \`endpoint\` option containing a URL, or if you are not using Companion, a custom \`${t}\` implementation.`)}async function Fp(t){if(J(t==null?void 0:t.signal),E(this,q)[q]==null){const{getTemporarySecurityCredentials:e}=this.opts;e===!0?(E(this,Y)[Y]("getTemporarySecurityCredentials"),E(this,q)[q]=E(this,$)[$].get("s3/sts",t).then(ht)):E(this,q)[q]=e(t),E(this,q)[q]=await E(this,q)[q],setTimeout(()=>{E(this,q)[q]=null},(Po(E(this,q)[q].credentials)||0)*500)}return E(this,q)[q]}function kp(t){var e=this;return new Promise((r,s)=>{const i=(u,d)=>{var c;const m=this.uppy.getFile(t.id);this.uppy.emit("upload-progress",m,{uploadStarted:(c=m.progress.uploadStarted)!=null?c:0,bytesUploaded:u,bytesTotal:d})},n=u=>{this.uppy.log(u),this.uppy.emit("upload-error",t,u),this.resetUploaderReferences(t.id),s(u)},o=u=>{const d={body:{...u},status:200,uploadURL:u.location};this.resetUploaderReferences(t.id),this.uppy.emit("upload-success",E(this,ut)[ut](t),d),u.location&&this.uppy.log(`Download ${t.name} from ${u.location}`),r()},a=new up(t.data,{companionComm:E(this,nt)[nt],log:function(){return e.uppy.log(...arguments)},getChunkSize:this.opts.getChunkSize?this.opts.getChunkSize.bind(this):void 0,onProgress:i,onError:n,onSuccess:o,onPartComplete:u=>{this.uppy.emit("s3-multipart:part-uploaded",E(this,ut)[ut](t),u)},file:t,shouldUseMultipart:this.opts.shouldUseMultipart,...t.s3Multipart});this.uploaders[t.id]=a;const l=new Kd(this.uppy);this.uploaderEvents[t.id]=l,l.onFileRemove(t.id,u=>{a.abort(),this.resetUploaderReferences(t.id,{abort:!0}),r(`upload ${u} was removed`)}),l.onCancelAll(t.id,()=>{a.abort(),this.resetUploaderReferences(t.id,{abort:!0}),r(`upload ${t.id} was canceled`)}),l.onFilePause(t.id,u=>{u?a.pause():a.start()}),l.onPauseAll(t.id,()=>{a.pause()}),l.onResumeAll(t.id,()=>{a.start()}),a.start()})}function Up(t){var e;return{...(e=t.remote)==null?void 0:e.body,protocol:"s3-multipart",size:t.data.size,metadata:t.meta}}Wr.VERSION=Ep.version;window.Uppy=zn;window.UppyDragDrop=Hr;window.UppyStatusBar=ho;window.UppyProgressBar=fo;window.UppyFileInput=mo;window.UppyAwsS3=Wr;window.createUppy=function(t={}){const e={debug:!1,autoProceed:!1,allowMultipleUploads:!1,restrictions:{maxFileSize:209715200,allowedFileTypes:["audio/*","application/pdf","image/*","application/zip"]}},r={...e,...t,restrictions:{...e.restrictions,...t.restrictions||{}}};return new zn(r)};window.fetchUploadSettings=async function(t="global"){try{const e=await fetch(`/api/upload-settings/${t}`,{headers:{"X-CSRF-TOKEN":window.getCSRFToken(),Accept:"application/json","Content-Type":"application/json"},credentials:"same-origin"});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const r=await e.json();return console.log("Upload settings fetched:",r),r}catch(e){return console.error("Failed to fetch upload settings:",e),{settings:{max_file_size_mb:200,chunk_size_mb:5,max_concurrent_uploads:3,max_retry_attempts:3,enable_chunking:!0,session_timeout_hours:24},computed:{uppy_restrictions:{maxFileSize:200*1024*1024,allowedFileTypes:["audio/*","application/pdf","image/*","application/zip"]},upload_config:{chunkSize:5*1024*1024,limit:3,retryDelays:[1e3,1e3,1e3]}}}}};window.createUppyWithSettings=async function(t="global",e={}){const r=await window.fetchUploadSettings(t),s={debug:!1,autoProceed:!1,allowMultipleUploads:!1,restrictions:r.computed.uppy_restrictions,...e},i=window.createUppy(s);return i.uploadSettings=r,i};window.getCSRFToken=function(){var t;return((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||""};window.getAPIToken=function(){return""};console.log("Uppy configuration loaded");class Eo{constructor(){this.waveSurfer=null,this.currentTrack=null,this.isInitialized=!1,this.mediaSession=null,this.livewireComponent=null,this.alpineStore=null,this.lastPositionUpdate=0,this.currentContainer=null,this.playbackState={isPlaying:!1,currentPosition:0,duration:0,volume:1,isMuted:!1},this.loopState={enabled:!1,start:null,end:null},this.config={container:"#global-waveform-persistent",fallbackContainer:"#global-waveform",waveColor:"rgba(139, 92, 246, 0.3)",progressColor:"rgba(139, 92, 246, 0.8)",cursorColor:"#8B5CF6",height:32,normalize:!0,responsive:!0,fillParent:!0,interact:!0,dragToSeek:!0,hideScrollbar:!0,barWidth:2,barGap:1,barRadius:2},this.init()}init(){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{this.setupEventListeners(),this.initializePersistentContainer()}):(this.setupEventListeners(),this.initializePersistentContainer()),this.initializeMediaSession(),document.addEventListener("visibilitychange",()=>this.handleVisibilityChange()),this.initializeServiceWorkerCommunication()}setupEventListeners(){Livewire.on("globalPlayerTrackChanged",e=>{this.loadTrack(e.track),this.alpineStore&&e.queue&&(this.alpineStore.queue=e.queue,this.alpineStore.queuePosition=e.queuePosition||0)}),Livewire.on("startPlayback",()=>{this.play()}),Livewire.on("pausePlayback",()=>{this.pause()}),Livewire.on("resumePlayback",()=>{this.play()}),Livewire.on("stopPlayback",()=>{this.stop()}),Livewire.on("seekToPosition",e=>{this.seekTo(e.timestamp)}),Livewire.on("volumeChanged",e=>{this.setVolume(e.volume)}),Livewire.on("muteToggled",e=>{this.setMute(e.muted)}),Livewire.on("updateMediaSession",e=>{this.updateMediaSessionState(e)})}initializePersistentContainer(){const e=document.getElementById("persistent-waveform-container"),r=document.getElementById("persistent-audio-element");if(!e){console.warn("Global Audio Manager: Persistent waveform container not found in DOM");return}if(!r){console.warn("Global Audio Manager: Persistent audio element not found in DOM");return}r.preload="auto",r.crossOrigin="anonymous",this.isInitialized||this.initializeWaveSurfer("#global-waveform-persistent")&&console.log("Global Audio Manager: Successfully initialized with persistent container"),console.log("Global Audio Manager: Persistent container initialized")}initializeWaveSurfer(e=null){if(this.waveSurfer)return e&&e!==this.currentContainer?(console.log("Global Audio Manager: Switching WaveSurfer container from",this.currentContainer,"to",e),this.switchContainer(e)):(console.log("Global Audio Manager: WaveSurfer already initialized, skipping"),!0);const r=e||this.config.container;let s=document.querySelector(r);if(!s&&r!==this.config.fallbackContainer&&(console.warn("Global Audio Manager: Primary container not found, trying fallback"),s=document.querySelector(this.config.fallbackContainer)),!s)return console.warn("Global Audio Manager: No suitable container found, deferring initialization"),!1;try{this.currentContainer=r;const i=r.includes("full"),n={...this.config,container:s,height:i?120:32,waveColor:i?"rgba(139, 92, 246, 0.2)":"rgba(139, 92, 246, 0.3)",progressColor:i?"rgba(139, 92, 246, 0.9)":"rgba(139, 92, 246, 0.8)",barWidth:i?3:2,barGap:i?2:1};return this.waveSurfer=WaveSurfer.create(n),console.log("Global Audio Manager: WaveSurfer created with persistent container:",r),this.setupWaveSurferEvents(),this.isInitialized=!0,!0}catch(i){return console.error("Global Audio Manager: Failed to initialize WaveSurfer:",i),!1}}switchContainer(e){if(!this.waveSurfer)return console.warn("Global Audio Manager: No WaveSurfer instance to switch"),!1;const r=document.querySelector(e);if(!r)return console.warn("Global Audio Manager: New container not found:",e),!1;try{const s=this.playbackState.isPlaying,i=this.playbackState.currentPosition,n=this.currentTrack;console.log("Global Audio Manager: Switching container while preserving playback");const o=this.waveSurfer.getMediaElement?this.waveSurfer.getMediaElement():null,a=e.includes("full"),l={...this.config,container:r,height:a?120:32,waveColor:a?"rgba(139, 92, 246, 0.2)":"rgba(139, 92, 246, 0.3)",progressColor:a?"rgba(139, 92, 246, 0.9)":"rgba(139, 92, 246, 0.8)",barWidth:a?3:2,barGap:a?2:1,media:o},u=this.waveSurfer;return this.waveSurfer=WaveSurfer.create(l),this.currentContainer=e,this.setupWaveSurferEvents(),n&&o&&(console.log("Global Audio Manager: Maintaining audio continuity during container switch"),this.waveSurfer.on("ready",()=>{i>0&&this.seekTo(i),s&&!this.playbackState.isPlaying&&this.play()})),setTimeout(()=>{u&&u!==this.waveSurfer&&u.destroy()},100),!0}catch(s){return console.error("Global Audio Manager: Failed to switch container:",s),!1}}setupWaveSurferEvents(){this.waveSurfer&&(this.waveSurfer.on("ready",()=>{this.playbackState.duration=this.waveSurfer.getDuration(),this.alpineStore&&(this.alpineStore.duration=this.playbackState.duration,this.alpineStore.clearLoading()),this.callLivewireMethod("updateDuration",this.playbackState.duration),this.updateLivewireComponent("waveformReady")}),this.waveSurfer.on("play",()=>{this.playbackState.isPlaying=!0,this.alpineStore&&this.alpineStore.updatePlaybackState(!0),this.updateLivewireComponent("playbackStarted"),this.updateMediaSessionPlaybackState("playing")}),this.waveSurfer.on("pause",()=>{this.playbackState.isPlaying=!1,this.alpineStore&&this.alpineStore.updatePlaybackState(!1),this.updateLivewireComponent("playbackPaused"),this.updateMediaSessionPlaybackState("paused")}),this.waveSurfer.on("finish",()=>{this.playbackState.isPlaying=!1,this.playbackState.currentPosition=0,this.updateLivewireComponent("trackEnded"),this.updateMediaSessionPlaybackState("none")}),this.waveSurfer.on("audioprocess",()=>{this.playbackState.currentPosition=this.waveSurfer.getCurrentTime(),this.throttlePositionUpdate(),this.loopState.enabled&&this.loopState.start!==null&&this.loopState.end!==null&&this.playbackState.currentPosition>=this.loopState.end&&this.seekTo(this.loopState.start)}),this.waveSurfer.on("seek",()=>{this.playbackState.currentPosition=this.waveSurfer.getCurrentTime(),this.alpineStore&&(this.alpineStore.currentPosition=this.playbackState.currentPosition),this.callLivewireMethod("updatePosition",this.playbackState.currentPosition)}))}loadTrack(e){if(!e||!e.url){console.error("Global Audio Manager: Invalid track data provided",e);return}if(this.alpineStore&&this.alpineStore.setLoading("Loading track..."),this.currentTrack=e,!this.isInitialized&&!this.initializeWaveSurfer()){console.error("Global Audio Manager: Could not initialize WaveSurfer for track loading"),this.alpineStore&&this.alpineStore.clearLoading();return}try{this.waveSurfer.load(e.url),this.updateMediaSessionMetadata(e),this.saveCurrentTrack(e)}catch(r){console.error("Global Audio Manager: Failed to load track:",r),this.alpineStore&&this.alpineStore.clearLoading()}}play(){if(!this.waveSurfer){console.warn("Global Audio Manager: No WaveSurfer instance available for play");return}try{this.waveSurfer.play(),this.pauseAllOtherPlayers()}catch(e){console.error("Global Audio Manager: Failed to play:",e)}}pause(){if(!this.waveSurfer){console.warn("Global Audio Manager: No WaveSurfer instance available for pause");return}try{this.waveSurfer.pause()}catch(e){console.error("Global Audio Manager: Failed to pause:",e)}}stop(){if(this.waveSurfer)try{this.waveSurfer.stop(),this.playbackState.currentPosition=0,this.playbackState.isPlaying=!1,this.updateMediaSessionPlaybackState("none")}catch(e){console.error("Global Audio Manager: Failed to stop:",e)}}seekTo(e){if(this.waveSurfer)try{const r=this.waveSurfer.getDuration();if(r>0){const s=e/r;this.waveSurfer.seekTo(s)}}catch(r){console.error("Global Audio Manager: Failed to seek:",r)}}setVolume(e){if(this.waveSurfer)try{this.waveSurfer.setVolume(e),this.playbackState.volume=e}catch(r){console.error("Global Audio Manager: Failed to set volume:",r)}}setPlaybackRate(e){if(this.waveSurfer)try{this.waveSurfer.setPlaybackRate(e),console.log("Global Audio Manager: Playback rate set to",e)}catch(r){console.error("Global Audio Manager: Failed to set playback rate:",r)}}setMute(e){if(this.waveSurfer)try{this.waveSurfer.setMute(e),this.playbackState.isMuted=e}catch(r){console.error("Global Audio Manager: Failed to set mute:",r)}}pauseAllOtherPlayers(){document.querySelectorAll("audio").forEach(e=>{e.paused||e.pause()}),Livewire.dispatch("pause-all-tracks",{source:"global-player"})}initializeMediaSession(){"mediaSession"in navigator&&(this.mediaSession=navigator.mediaSession,this.mediaSession.setActionHandler("play",()=>{this.updateLivewireComponent("togglePlayback")}),this.mediaSession.setActionHandler("pause",()=>{this.updateLivewireComponent("togglePlayback")}),this.mediaSession.setActionHandler("previoustrack",()=>{this.updateLivewireComponent("previousTrack")}),this.mediaSession.setActionHandler("nexttrack",()=>{this.updateLivewireComponent("nextTrack")}),this.mediaSession.setActionHandler("seekbackward",e=>{const r=Math.max(0,this.playbackState.currentPosition-(e.seekOffset||10));this.callLivewireMethod("seekTo",r)}),this.mediaSession.setActionHandler("seekforward",e=>{const r=Math.min(this.playbackState.duration,this.playbackState.currentPosition+(e.seekOffset||10));this.callLivewireMethod("seekTo",r)}))}updateMediaSessionMetadata(e){if(this.mediaSession)try{this.mediaSession.metadata=new MediaMetadata({title:e.title||"Unknown Title",artist:e.artist||"Unknown Artist",album:e.project_title||"MixPitch",artwork:[{src:"/logo-192x192.png",sizes:"192x192",type:"image/png"},{src:"/logo-512x512.png",sizes:"512x512",type:"image/png"}]})}catch(r){console.error("Global Audio Manager: Failed to update media session metadata:",r)}}updateMediaSessionPlaybackState(e){if(this.mediaSession)try{if(this.mediaSession.playbackState=e,e==="playing"||e==="paused"){const r=this.playbackState.duration||0,s=this.playbackState.currentPosition||0;r>0&&s>=0&&s<=r&&!isNaN(r)&&!isNaN(s)&&isFinite(r)&&isFinite(s)&&this.mediaSession.setPositionState({duration:r,playbackRate:1,position:s})}}catch(r){console.error("Global Audio Manager: Failed to update media session playback state:",r)}}updateMediaSessionState(e){this.playbackState.currentPosition=e.position||this.playbackState.currentPosition,this.playbackState.duration=e.duration||this.playbackState.duration,this.updateMediaSessionPlaybackState(this.playbackState.isPlaying?"playing":"paused")}handleVisibilityChange(){document.hidden?this.savePlaybackState():this.restorePlaybackState()}saveCurrentTrack(e){try{sessionStorage.setItem("global-audio-current-track",JSON.stringify(e))}catch{console.warn("Global Audio Manager: Could not save current track to session storage")}}savePlaybackState(){if(this.currentTrack)try{const e={track:this.currentTrack,position:this.playbackState.currentPosition,isPlaying:this.playbackState.isPlaying,volume:this.playbackState.volume,isMuted:this.playbackState.isMuted,timestamp:Date.now()};sessionStorage.setItem("global-audio-playback-state",JSON.stringify(e))}catch{console.warn("Global Audio Manager: Could not save playback state")}}restorePlaybackState(){try{const e=sessionStorage.getItem("global-audio-playback-state");if(!e)return;const r=JSON.parse(e);if(Date.now()-r.timestamp>3e5){sessionStorage.removeItem("global-audio-playback-state");return}r.track&&(this.updateLivewireComponent("playTrack",r.track),setTimeout(()=>{r.position>0&&this.callLivewireMethod("seekTo",r.position),r.volume!==1&&this.callLivewireMethod("setVolume",r.volume),r.isMuted&&this.updateLivewireComponent("toggleMute"),r.isPlaying&&this.updateLivewireComponent("togglePlayback")},1e3))}catch{console.warn("Global Audio Manager: Could not restore playback state"),sessionStorage.removeItem("global-audio-playback-state")}}updateLivewireComponent(e,r=null){try{r!==null?Livewire.dispatch(e,r):Livewire.dispatch(e)}catch(s){console.error(`Global Audio Manager: Failed to call Livewire method ${e}:`,s)}}registerLivewireComponent(e){this.livewireComponent=e,console.log("Global Audio Manager: Livewire component registered")}registerAlpineStore(e){this.alpineStore=e,console.log("Global Audio Manager: Alpine store registered")}throttlePositionUpdate(){const e=Date.now();this.alpineStore&&this.alpineStore.updatePosition(this.playbackState.currentPosition),e-this.lastPositionUpdate>1e3&&(this.lastPositionUpdate=e,this.callLivewireMethod("updatePosition",this.playbackState.currentPosition))}callLivewireMethod(e,r=null){try{if(this.livewireComponent&&typeof this.livewireComponent.call=="function"){r!==null?this.livewireComponent.call(e,r):this.livewireComponent.call(e);return}console.warn(`Global Audio Manager: No registered component available, falling back to event dispatch for ${e}`),this.updateLivewireComponent(e,r)}catch(s){console.error(`Global Audio Manager: Failed to call Livewire method ${e} directly:`,s),this.updateLivewireComponent(e,r)}}getCurrentTrack(){return this.currentTrack}getCurrentState(){return{...this.playbackState}}isReady(){return this.isInitialized&&this.waveSurfer!==null}setLoop(e,r){e!==null&&r!==null&&e<r&&(this.loopState.start=e,this.loopState.end=r,this.loopState.enabled=!0,console.log("Global Audio Manager: A-B loop set",{start:e,end:r}))}clearLoop(){this.loopState.enabled=!1,this.loopState.start=null,this.loopState.end=null,console.log("Global Audio Manager: A-B loop cleared")}getLoopState(){return{...this.loopState}}initializeServiceWorkerCommunication(){"serviceWorker"in navigator&&(navigator.serviceWorker.addEventListener("message",e=>{this.handleServiceWorkerMessage(e)}),console.log("Global Audio Manager: Service worker communication initialized"))}handleServiceWorkerMessage(e){const{type:r,payload:s}=e.data;switch(r){case"AUDIO_STATE_RESTORED":console.log("Global Audio Manager: Restored audio state from service worker"),this.applyRestoredState(s);break;case"AUDIO_STATE_NOT_FOUND":console.log("Global Audio Manager: No saved audio state found");break;case"AUDIO_STATE_ERROR":console.error("Global Audio Manager: Error restoring audio state:",s);break}}async restoreAudioState(){if(navigator.serviceWorker)try{const e=await navigator.serviceWorker.ready,r=new MessageChannel;r.port1.onmessage=s=>{this.handleServiceWorkerMessage(s)},e.active.postMessage({type:"RESTORE_AUDIO_STATE"},[r.port2])}catch(e){console.error("Global Audio Manager: Failed to restore audio state:",e)}}applyRestoredState(e){!e||!e.track||(this.alpineStore&&(this.alpineStore.setTrack(e.track,e.queue||[],e.queuePosition||0),this.alpineStore.volume=e.volume||1,this.alpineStore.isMuted=e.isMuted||!1,e.loopState&&(this.loopState=e.loopState,this.alpineStore.loopEnabled=e.loopState.enabled,this.alpineStore.loopStart=e.loopState.start,this.alpineStore.loopEnd=e.loopState.end)),this.loadTrack(e.track),this.waveSurfer&&this.waveSurfer.on("ready",()=>{e.position>0&&this.seekTo(e.position)},{once:!0}))}async preloadAudioFile(e){if(!(!navigator.serviceWorker||!e))try{(await navigator.serviceWorker.ready).active.postMessage({type:"PRELOAD_AUDIO",payload:e}),console.log("Global Audio Manager: Requested audio preload:",e)}catch(r){console.error("Global Audio Manager: Failed to request audio preload:",r)}}preloadNextTrack(){if(!this.alpineStore||this.alpineStore.queue.length===0)return;const e=this.alpineStore.queuePosition+1;if(e<this.alpineStore.queue.length){const r=this.alpineStore.queue[e];r&&r.url&&this.preloadAudioFile(r.url)}}playWithFallback(){if(!this.waveSurfer){console.warn("Global Audio Manager: No WaveSurfer instance available for play");return}try{const e=this.waveSurfer.play();e&&typeof e.then=="function"&&e.catch(r=>{r.name==="NotAllowedError"?(console.log("Global Audio Manager: Autoplay blocked, using persistent audio fallback"),this.usePersistentAudioFallback()):console.error("Global Audio Manager: Failed to play:",r)}),this.pauseAllOtherPlayers()}catch(e){console.error("Global Audio Manager: Failed to play:",e),this.usePersistentAudioFallback()}}usePersistentAudioFallback(){const e=document.getElementById("persistent-audio-element");if(!(!e||!this.currentTrack))try{e.src!==this.currentTrack.url&&(e.src=this.currentTrack.url,e.currentTime=this.playbackState.currentPosition),e.volume=this.playbackState.volume,e.muted=this.playbackState.isMuted,e.play().then(()=>{console.log("Global Audio Manager: Using persistent audio element for playback"),this.playbackState.isPlaying=!0,this.alpineStore&&this.alpineStore.updatePlaybackState(!0),this.setupPersistentAudioEvents(e)}).catch(r=>{console.error("Global Audio Manager: Persistent audio fallback also failed:",r)})}catch(r){console.error("Global Audio Manager: Failed to use persistent audio fallback:",r)}}setupPersistentAudioEvents(e){e.removeEventListener("timeupdate",this.persistentAudioTimeUpdate),e.removeEventListener("ended",this.persistentAudioEnded),this.persistentAudioTimeUpdate=()=>{this.playbackState.currentPosition=e.currentTime,this.throttlePositionUpdate()},this.persistentAudioEnded=()=>{this.playbackState.isPlaying=!1,this.playbackState.currentPosition=0,this.updateLivewireComponent("trackEnded")},e.addEventListener("timeupdate",this.persistentAudioTimeUpdate),e.addEventListener("ended",this.persistentAudioEnded)}play(){this.playWithFallback()}destroy(){this.waveSurfer&&(this.waveSurfer.destroy(),this.waveSurfer=null),this.isInitialized=!1,this.currentTrack=null;const e=document.getElementById("persistent-audio-element");e&&(e.pause(),e.src="")}}window.globalAudioManager=new Eo;typeof Tr<"u"&&Tr.exports&&(Tr.exports=Eo);try{Co(()=>import("./stripe-handler-9538a51a.js"),[])}catch(t){console.error("Could not load Stripe handler:",t)}});export default Rp();
