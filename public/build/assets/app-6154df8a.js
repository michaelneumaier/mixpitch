var Co=Object.defineProperty;var Fo=(r,e,t)=>e in r?Co(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var Oo=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var ai=(r,e,t)=>(Fo(r,typeof e!="symbol"?e+"":e,t),t);var Rp=Oo((Lp,kr)=>{const Ao="modulepreload",Uo=function(r){return"/build/"+r},li={},Ro=function(e,t,s){if(!t||t.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(t.map(n=>{if(n=Uo(n),n in li)return;li[n]=!0;const o=n.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!s)for(let d=i.length-1;d>=0;d--){const c=i[d];if(c.href===n&&(!o||c.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${n}"]${a}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":Ao,o||(u.as="script",u.crossOrigin=""),u.href=n,document.head.appendChild(u),o)return new Promise((d,c)=>{u.addEventListener("load",d),u.addEventListener("error",()=>c(new Error(`Unable to preload CSS for ${n}`)))})})).then(()=>e()).catch(n=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=n,window.dispatchEvent(o),!o.defaultPrevented)throw n})};function dn(r,e){return function(){return r.apply(e,arguments)}}const{toString:xo}=Object.prototype,{getPrototypeOf:js}=Object,$r=(r=>e=>{const t=xo.call(e);return r[t]||(r[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),_e=r=>(r=r.toLowerCase(),e=>$r(e)===r),Nr=r=>e=>typeof e===r,{isArray:bt}=Array,sr=Nr("undefined");function Mo(r){return r!==null&&!sr(r)&&r.constructor!==null&&!sr(r.constructor)&&he(r.constructor.isBuffer)&&r.constructor.isBuffer(r)}const pn=_e("ArrayBuffer");function $o(r){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(r):e=r&&r.buffer&&pn(r.buffer),e}const No=Nr("string"),he=Nr("function"),hn=Nr("number"),Lr=r=>r!==null&&typeof r=="object",Lo=r=>r===!0||r===!1,vr=r=>{if($r(r)!=="object")return!1;const e=js(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)},jo=_e("Date"),Bo=_e("File"),Io=_e("Blob"),Do=_e("FileList"),qo=r=>Lr(r)&&he(r.pipe),zo=r=>{let e;return r&&(typeof FormData=="function"&&r instanceof FormData||he(r.append)&&((e=$r(r))==="formdata"||e==="object"&&he(r.toString)&&r.toString()==="[object FormData]"))},Ho=_e("URLSearchParams"),[Wo,Vo,Go,Jo]=["ReadableStream","Request","Response","Headers"].map(_e),Ko=r=>r.trim?r.trim():r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ar(r,e,{allOwnKeys:t=!1}={}){if(r===null||typeof r>"u")return;let s,i;if(typeof r!="object"&&(r=[r]),bt(r))for(s=0,i=r.length;s<i;s++)e.call(null,r[s],s,r);else{const n=t?Object.getOwnPropertyNames(r):Object.keys(r),o=n.length;let a;for(s=0;s<o;s++)a=n[s],e.call(null,r[a],a,r)}}function fn(r,e){e=e.toLowerCase();const t=Object.keys(r);let s=t.length,i;for(;s-- >0;)if(i=t[s],e===i.toLowerCase())return i;return null}const ct=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),mn=r=>!sr(r)&&r!==ct;function _s(){const{caseless:r}=mn(this)&&this||{},e={},t=(s,i)=>{const n=r&&fn(e,i)||i;vr(e[n])&&vr(s)?e[n]=_s(e[n],s):vr(s)?e[n]=_s({},s):bt(s)?e[n]=s.slice():e[n]=s};for(let s=0,i=arguments.length;s<i;s++)arguments[s]&&ar(arguments[s],t);return e}const Xo=(r,e,t,{allOwnKeys:s}={})=>(ar(e,(i,n)=>{t&&he(i)?r[n]=dn(i,t):r[n]=i},{allOwnKeys:s}),r),Qo=r=>(r.charCodeAt(0)===65279&&(r=r.slice(1)),r),Yo=(r,e,t,s)=>{r.prototype=Object.create(e.prototype,s),r.prototype.constructor=r,Object.defineProperty(r,"super",{value:e.prototype}),t&&Object.assign(r.prototype,t)},Zo=(r,e,t,s)=>{let i,n,o;const a={};if(e=e||{},r==null)return e;do{for(i=Object.getOwnPropertyNames(r),n=i.length;n-- >0;)o=i[n],(!s||s(o,r,e))&&!a[o]&&(e[o]=r[o],a[o]=!0);r=t!==!1&&js(r)}while(r&&(!t||t(r,e))&&r!==Object.prototype);return e},ea=(r,e,t)=>{r=String(r),(t===void 0||t>r.length)&&(t=r.length),t-=e.length;const s=r.indexOf(e,t);return s!==-1&&s===t},ta=r=>{if(!r)return null;if(bt(r))return r;let e=r.length;if(!hn(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=r[e];return t},ra=(r=>e=>r&&e instanceof r)(typeof Uint8Array<"u"&&js(Uint8Array)),sa=(r,e)=>{const s=(r&&r[Symbol.iterator]).call(r);let i;for(;(i=s.next())&&!i.done;){const n=i.value;e.call(r,n[0],n[1])}},ia=(r,e)=>{let t;const s=[];for(;(t=r.exec(e))!==null;)s.push(t);return s},na=_e("HTMLFormElement"),oa=r=>r.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,s,i){return s.toUpperCase()+i}),ui=(({hasOwnProperty:r})=>(e,t)=>r.call(e,t))(Object.prototype),aa=_e("RegExp"),gn=(r,e)=>{const t=Object.getOwnPropertyDescriptors(r),s={};ar(t,(i,n)=>{let o;(o=e(i,n,r))!==!1&&(s[n]=o||i)}),Object.defineProperties(r,s)},la=r=>{gn(r,(e,t)=>{if(he(r)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const s=r[t];if(he(s)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},ua=(r,e)=>{const t={},s=i=>{i.forEach(n=>{t[n]=!0})};return bt(r)?s(r):s(String(r).split(e)),t},ca=()=>{},da=(r,e)=>r!=null&&Number.isFinite(r=+r)?r:e,Gr="abcdefghijklmnopqrstuvwxyz",ci="0123456789",yn={DIGIT:ci,ALPHA:Gr,ALPHA_DIGIT:Gr+Gr.toUpperCase()+ci},pa=(r=16,e=yn.ALPHA_DIGIT)=>{let t="";const{length:s}=e;for(;r--;)t+=e[Math.random()*s|0];return t};function ha(r){return!!(r&&he(r.append)&&r[Symbol.toStringTag]==="FormData"&&r[Symbol.iterator])}const fa=r=>{const e=new Array(10),t=(s,i)=>{if(Lr(s)){if(e.indexOf(s)>=0)return;if(!("toJSON"in s)){e[i]=s;const n=bt(s)?[]:{};return ar(s,(o,a)=>{const l=t(o,i+1);!sr(l)&&(n[a]=l)}),e[i]=void 0,n}}return s};return t(r,0)},ma=_e("AsyncFunction"),ga=r=>r&&(Lr(r)||he(r))&&he(r.then)&&he(r.catch),vn=((r,e)=>r?setImmediate:e?((t,s)=>(ct.addEventListener("message",({source:i,data:n})=>{i===ct&&n===t&&s.length&&s.shift()()},!1),i=>{s.push(i),ct.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",he(ct.postMessage)),ya=typeof queueMicrotask<"u"?queueMicrotask.bind(ct):typeof process<"u"&&process.nextTick||vn,g={isArray:bt,isArrayBuffer:pn,isBuffer:Mo,isFormData:zo,isArrayBufferView:$o,isString:No,isNumber:hn,isBoolean:Lo,isObject:Lr,isPlainObject:vr,isReadableStream:Wo,isRequest:Vo,isResponse:Go,isHeaders:Jo,isUndefined:sr,isDate:jo,isFile:Bo,isBlob:Io,isRegExp:aa,isFunction:he,isStream:qo,isURLSearchParams:Ho,isTypedArray:ra,isFileList:Do,forEach:ar,merge:_s,extend:Xo,trim:Ko,stripBOM:Qo,inherits:Yo,toFlatObject:Zo,kindOf:$r,kindOfTest:_e,endsWith:ea,toArray:ta,forEachEntry:sa,matchAll:ia,isHTMLForm:na,hasOwnProperty:ui,hasOwnProp:ui,reduceDescriptors:gn,freezeMethods:la,toObjectSet:ua,toCamelCase:oa,noop:ca,toFiniteNumber:da,findKey:fn,global:ct,isContextDefined:mn,ALPHABET:yn,generateString:pa,isSpecCompliantForm:ha,toJSONObject:fa,isAsyncFn:ma,isThenable:ga,setImmediate:vn,asap:ya};function R(r,e,t,s,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=r,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),s&&(this.request=s),i&&(this.response=i,this.status=i.status?i.status:null)}g.inherits(R,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:g.toJSONObject(this.config),code:this.code,status:this.status}}});const bn=R.prototype,wn={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(r=>{wn[r]={value:r}});Object.defineProperties(R,wn);Object.defineProperty(bn,"isAxiosError",{value:!0});R.from=(r,e,t,s,i,n)=>{const o=Object.create(bn);return g.toFlatObject(r,o,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),R.call(o,r.message,e,t,s,i),o.cause=r,o.name=r.name,n&&Object.assign(o,n),o};const va=null;function Ss(r){return g.isPlainObject(r)||g.isArray(r)}function _n(r){return g.endsWith(r,"[]")?r.slice(0,-2):r}function di(r,e,t){return r?r.concat(e).map(function(i,n){return i=_n(i),!t&&n?"["+i+"]":i}).join(t?".":""):e}function ba(r){return g.isArray(r)&&!r.some(Ss)}const wa=g.toFlatObject(g,{},null,function(e){return/^is[A-Z]/.test(e)});function jr(r,e,t){if(!g.isObject(r))throw new TypeError("target must be an object");e=e||new FormData,t=g.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,y){return!g.isUndefined(y[m])});const s=t.metaTokens,i=t.visitor||d,n=t.dots,o=t.indexes,l=(t.Blob||typeof Blob<"u"&&Blob)&&g.isSpecCompliantForm(e);if(!g.isFunction(i))throw new TypeError("visitor must be a function");function u(f){if(f===null)return"";if(g.isDate(f))return f.toISOString();if(!l&&g.isBlob(f))throw new R("Blob is not supported. Use a Buffer instead.");return g.isArrayBuffer(f)||g.isTypedArray(f)?l&&typeof Blob=="function"?new Blob([f]):Buffer.from(f):f}function d(f,m,y){let v=f;if(f&&!y&&typeof f=="object"){if(g.endsWith(m,"{}"))m=s?m:m.slice(0,-2),f=JSON.stringify(f);else if(g.isArray(f)&&ba(f)||(g.isFileList(f)||g.endsWith(m,"[]"))&&(v=g.toArray(f)))return m=_n(m),v.forEach(function(A,k){!(g.isUndefined(A)||A===null)&&e.append(o===!0?di([m],k,n):o===null?m:m+"[]",u(A))}),!1}return Ss(f)?!0:(e.append(di(y,m,n),u(f)),!1)}const c=[],p=Object.assign(wa,{defaultVisitor:d,convertValue:u,isVisitable:Ss});function h(f,m){if(!g.isUndefined(f)){if(c.indexOf(f)!==-1)throw Error("Circular reference detected in "+m.join("."));c.push(f),g.forEach(f,function(v,_){(!(g.isUndefined(v)||v===null)&&i.call(e,v,g.isString(_)?_.trim():_,m,p))===!0&&h(v,m?m.concat(_):[_])}),c.pop()}}if(!g.isObject(r))throw new TypeError("data must be an object");return h(r),e}function pi(r){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(r).replace(/[!'()~]|%20|%00/g,function(s){return e[s]})}function Bs(r,e){this._pairs=[],r&&jr(r,this,e)}const Sn=Bs.prototype;Sn.append=function(e,t){this._pairs.push([e,t])};Sn.toString=function(e){const t=e?function(s){return e.call(this,s,pi)}:pi;return this._pairs.map(function(i){return t(i[0])+"="+t(i[1])},"").join("&")};function _a(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Pn(r,e,t){if(!e)return r;const s=t&&t.encode||_a,i=t&&t.serialize;let n;if(i?n=i(e,t):n=g.isURLSearchParams(e)?e.toString():new Bs(e,t).toString(s),n){const o=r.indexOf("#");o!==-1&&(r=r.slice(0,o)),r+=(r.indexOf("?")===-1?"?":"&")+n}return r}class Sa{constructor(){this.handlers=[]}use(e,t,s){return this.handlers.push({fulfilled:e,rejected:t,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){g.forEach(this.handlers,function(s){s!==null&&e(s)})}}const hi=Sa,En={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Pa=typeof URLSearchParams<"u"?URLSearchParams:Bs,Ea=typeof FormData<"u"?FormData:null,Ta=typeof Blob<"u"?Blob:null,ka={isBrowser:!0,classes:{URLSearchParams:Pa,FormData:Ea,Blob:Ta},protocols:["http","https","file","blob","url","data"]},Is=typeof window<"u"&&typeof document<"u",Ps=typeof navigator=="object"&&navigator||void 0,Ca=Is&&(!Ps||["ReactNative","NativeScript","NS"].indexOf(Ps.product)<0),Fa=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),Oa=Is&&window.location.href||"http://localhost",Aa=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Is,hasStandardBrowserEnv:Ca,hasStandardBrowserWebWorkerEnv:Fa,navigator:Ps,origin:Oa},Symbol.toStringTag,{value:"Module"})),ie={...Aa,...ka};function Ua(r,e){return jr(r,new ie.classes.URLSearchParams,Object.assign({visitor:function(t,s,i,n){return ie.isNode&&g.isBuffer(t)?(this.append(s,t.toString("base64")),!1):n.defaultVisitor.apply(this,arguments)}},e))}function Ra(r){return g.matchAll(/\w+|\[(\w*)]/g,r).map(e=>e[0]==="[]"?"":e[1]||e[0])}function xa(r){const e={},t=Object.keys(r);let s;const i=t.length;let n;for(s=0;s<i;s++)n=t[s],e[n]=r[n];return e}function Tn(r){function e(t,s,i,n){let o=t[n++];if(o==="__proto__")return!0;const a=Number.isFinite(+o),l=n>=t.length;return o=!o&&g.isArray(i)?i.length:o,l?(g.hasOwnProp(i,o)?i[o]=[i[o],s]:i[o]=s,!a):((!i[o]||!g.isObject(i[o]))&&(i[o]=[]),e(t,s,i[o],n)&&g.isArray(i[o])&&(i[o]=xa(i[o])),!a)}if(g.isFormData(r)&&g.isFunction(r.entries)){const t={};return g.forEachEntry(r,(s,i)=>{e(Ra(s),i,t,0)}),t}return null}function Ma(r,e,t){if(g.isString(r))try{return(e||JSON.parse)(r),g.trim(r)}catch(s){if(s.name!=="SyntaxError")throw s}return(t||JSON.stringify)(r)}const Ds={transitional:En,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const s=t.getContentType()||"",i=s.indexOf("application/json")>-1,n=g.isObject(e);if(n&&g.isHTMLForm(e)&&(e=new FormData(e)),g.isFormData(e))return i?JSON.stringify(Tn(e)):e;if(g.isArrayBuffer(e)||g.isBuffer(e)||g.isStream(e)||g.isFile(e)||g.isBlob(e)||g.isReadableStream(e))return e;if(g.isArrayBufferView(e))return e.buffer;if(g.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(n){if(s.indexOf("application/x-www-form-urlencoded")>-1)return Ua(e,this.formSerializer).toString();if((a=g.isFileList(e))||s.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return jr(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return n||i?(t.setContentType("application/json",!1),Ma(e)):e}],transformResponse:[function(e){const t=this.transitional||Ds.transitional,s=t&&t.forcedJSONParsing,i=this.responseType==="json";if(g.isResponse(e)||g.isReadableStream(e))return e;if(e&&g.isString(e)&&(s&&!this.responseType||i)){const o=!(t&&t.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(a){if(o)throw a.name==="SyntaxError"?R.from(a,R.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ie.classes.FormData,Blob:ie.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};g.forEach(["delete","get","head","post","put","patch"],r=>{Ds.headers[r]={}});const qs=Ds,$a=g.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Na=r=>{const e={};let t,s,i;return r&&r.split(`
`).forEach(function(o){i=o.indexOf(":"),t=o.substring(0,i).trim().toLowerCase(),s=o.substring(i+1).trim(),!(!t||e[t]&&$a[t])&&(t==="set-cookie"?e[t]?e[t].push(s):e[t]=[s]:e[t]=e[t]?e[t]+", "+s:s)}),e},fi=Symbol("internals");function Pt(r){return r&&String(r).trim().toLowerCase()}function br(r){return r===!1||r==null?r:g.isArray(r)?r.map(br):String(r)}function La(r){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=t.exec(r);)e[s[1]]=s[2];return e}const ja=r=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(r.trim());function Jr(r,e,t,s,i){if(g.isFunction(s))return s.call(this,e,t);if(i&&(e=t),!!g.isString(e)){if(g.isString(s))return e.indexOf(s)!==-1;if(g.isRegExp(s))return s.test(e)}}function Ba(r){return r.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,s)=>t.toUpperCase()+s)}function Ia(r,e){const t=g.toCamelCase(" "+e);["get","set","has"].forEach(s=>{Object.defineProperty(r,s+t,{value:function(i,n,o){return this[s].call(this,e,i,n,o)},configurable:!0})})}class Br{constructor(e){e&&this.set(e)}set(e,t,s){const i=this;function n(a,l,u){const d=Pt(l);if(!d)throw new Error("header name must be a non-empty string");const c=g.findKey(i,d);(!c||i[c]===void 0||u===!0||u===void 0&&i[c]!==!1)&&(i[c||l]=br(a))}const o=(a,l)=>g.forEach(a,(u,d)=>n(u,d,l));if(g.isPlainObject(e)||e instanceof this.constructor)o(e,t);else if(g.isString(e)&&(e=e.trim())&&!ja(e))o(Na(e),t);else if(g.isHeaders(e))for(const[a,l]of e.entries())n(l,a,s);else e!=null&&n(t,e,s);return this}get(e,t){if(e=Pt(e),e){const s=g.findKey(this,e);if(s){const i=this[s];if(!t)return i;if(t===!0)return La(i);if(g.isFunction(t))return t.call(this,i,s);if(g.isRegExp(t))return t.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Pt(e),e){const s=g.findKey(this,e);return!!(s&&this[s]!==void 0&&(!t||Jr(this,this[s],s,t)))}return!1}delete(e,t){const s=this;let i=!1;function n(o){if(o=Pt(o),o){const a=g.findKey(s,o);a&&(!t||Jr(s,s[a],a,t))&&(delete s[a],i=!0)}}return g.isArray(e)?e.forEach(n):n(e),i}clear(e){const t=Object.keys(this);let s=t.length,i=!1;for(;s--;){const n=t[s];(!e||Jr(this,this[n],n,e,!0))&&(delete this[n],i=!0)}return i}normalize(e){const t=this,s={};return g.forEach(this,(i,n)=>{const o=g.findKey(s,n);if(o){t[o]=br(i),delete t[n];return}const a=e?Ba(n):String(n).trim();a!==n&&delete t[n],t[a]=br(i),s[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return g.forEach(this,(s,i)=>{s!=null&&s!==!1&&(t[i]=e&&g.isArray(s)?s.join(", "):s)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const s=new this(e);return t.forEach(i=>s.set(i)),s}static accessor(e){const s=(this[fi]=this[fi]={accessors:{}}).accessors,i=this.prototype;function n(o){const a=Pt(o);s[a]||(Ia(i,o),s[a]=!0)}return g.isArray(e)?e.forEach(n):n(e),this}}Br.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);g.reduceDescriptors(Br.prototype,({value:r},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>r,set(s){this[t]=s}}});g.freezeMethods(Br);const we=Br;function Kr(r,e){const t=this||qs,s=e||t,i=we.from(s.headers);let n=s.data;return g.forEach(r,function(a){n=a.call(t,n,i.normalize(),e?e.status:void 0)}),i.normalize(),n}function kn(r){return!!(r&&r.__CANCEL__)}function wt(r,e,t){R.call(this,r??"canceled",R.ERR_CANCELED,e,t),this.name="CanceledError"}g.inherits(wt,R,{__CANCEL__:!0});function Cn(r,e,t){const s=t.config.validateStatus;!t.status||!s||s(t.status)?r(t):e(new R("Request failed with status code "+t.status,[R.ERR_BAD_REQUEST,R.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function Da(r){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(r);return e&&e[1]||""}function qa(r,e){r=r||10;const t=new Array(r),s=new Array(r);let i=0,n=0,o;return e=e!==void 0?e:1e3,function(l){const u=Date.now(),d=s[n];o||(o=u),t[i]=l,s[i]=u;let c=n,p=0;for(;c!==i;)p+=t[c++],c=c%r;if(i=(i+1)%r,i===n&&(n=(n+1)%r),u-o<e)return;const h=d&&u-d;return h?Math.round(p*1e3/h):void 0}}function za(r,e){let t=0,s=1e3/e,i,n;const o=(u,d=Date.now())=>{t=d,i=null,n&&(clearTimeout(n),n=null),r.apply(null,u)};return[(...u)=>{const d=Date.now(),c=d-t;c>=s?o(u,d):(i=u,n||(n=setTimeout(()=>{n=null,o(i)},s-c)))},()=>i&&o(i)]}const Cr=(r,e,t=3)=>{let s=0;const i=qa(50,250);return za(n=>{const o=n.loaded,a=n.lengthComputable?n.total:void 0,l=o-s,u=i(l),d=o<=a;s=o;const c={loaded:o,total:a,progress:a?o/a:void 0,bytes:l,rate:u||void 0,estimated:u&&a&&d?(a-o)/u:void 0,event:n,lengthComputable:a!=null,[e?"download":"upload"]:!0};r(c)},t)},mi=(r,e)=>{const t=r!=null;return[s=>e[0]({lengthComputable:t,total:r,loaded:s}),e[1]]},gi=r=>(...e)=>g.asap(()=>r(...e)),Ha=ie.hasStandardBrowserEnv?function(){const e=ie.navigator&&/(msie|trident)/i.test(ie.navigator.userAgent),t=document.createElement("a");let s;function i(n){let o=n;return e&&(t.setAttribute("href",o),o=t.href),t.setAttribute("href",o),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:t.pathname.charAt(0)==="/"?t.pathname:"/"+t.pathname}}return s=i(window.location.href),function(o){const a=g.isString(o)?i(o):o;return a.protocol===s.protocol&&a.host===s.host}}():function(){return function(){return!0}}(),Wa=ie.hasStandardBrowserEnv?{write(r,e,t,s,i,n){const o=[r+"="+encodeURIComponent(e)];g.isNumber(t)&&o.push("expires="+new Date(t).toGMTString()),g.isString(s)&&o.push("path="+s),g.isString(i)&&o.push("domain="+i),n===!0&&o.push("secure"),document.cookie=o.join("; ")},read(r){const e=document.cookie.match(new RegExp("(^|;\\s*)("+r+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(r){this.write(r,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Va(r){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(r)}function Ga(r,e){return e?r.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):r}function Fn(r,e){return r&&!Va(e)?Ga(r,e):e}const yi=r=>r instanceof we?{...r}:r;function ft(r,e){e=e||{};const t={};function s(u,d,c){return g.isPlainObject(u)&&g.isPlainObject(d)?g.merge.call({caseless:c},u,d):g.isPlainObject(d)?g.merge({},d):g.isArray(d)?d.slice():d}function i(u,d,c){if(g.isUndefined(d)){if(!g.isUndefined(u))return s(void 0,u,c)}else return s(u,d,c)}function n(u,d){if(!g.isUndefined(d))return s(void 0,d)}function o(u,d){if(g.isUndefined(d)){if(!g.isUndefined(u))return s(void 0,u)}else return s(void 0,d)}function a(u,d,c){if(c in e)return s(u,d);if(c in r)return s(void 0,u)}const l={url:n,method:n,data:n,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(u,d)=>i(yi(u),yi(d),!0)};return g.forEach(Object.keys(Object.assign({},r,e)),function(d){const c=l[d]||i,p=c(r[d],e[d],d);g.isUndefined(p)&&c!==a||(t[d]=p)}),t}const On=r=>{const e=ft({},r);let{data:t,withXSRFToken:s,xsrfHeaderName:i,xsrfCookieName:n,headers:o,auth:a}=e;e.headers=o=we.from(o),e.url=Pn(Fn(e.baseURL,e.url),r.params,r.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let l;if(g.isFormData(t)){if(ie.hasStandardBrowserEnv||ie.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((l=o.getContentType())!==!1){const[u,...d]=l?l.split(";").map(c=>c.trim()).filter(Boolean):[];o.setContentType([u||"multipart/form-data",...d].join("; "))}}if(ie.hasStandardBrowserEnv&&(s&&g.isFunction(s)&&(s=s(e)),s||s!==!1&&Ha(e.url))){const u=i&&n&&Wa.read(n);u&&o.set(i,u)}return e},Ja=typeof XMLHttpRequest<"u",Ka=Ja&&function(r){return new Promise(function(t,s){const i=On(r);let n=i.data;const o=we.from(i.headers).normalize();let{responseType:a,onUploadProgress:l,onDownloadProgress:u}=i,d,c,p,h,f;function m(){h&&h(),f&&f(),i.cancelToken&&i.cancelToken.unsubscribe(d),i.signal&&i.signal.removeEventListener("abort",d)}let y=new XMLHttpRequest;y.open(i.method.toUpperCase(),i.url,!0),y.timeout=i.timeout;function v(){if(!y)return;const A=we.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),P={data:!a||a==="text"||a==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:A,config:r,request:y};Cn(function(T){t(T),m()},function(T){s(T),m()},P),y=null}"onloadend"in y?y.onloadend=v:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(v)},y.onabort=function(){y&&(s(new R("Request aborted",R.ECONNABORTED,r,y)),y=null)},y.onerror=function(){s(new R("Network Error",R.ERR_NETWORK,r,y)),y=null},y.ontimeout=function(){let k=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const P=i.transitional||En;i.timeoutErrorMessage&&(k=i.timeoutErrorMessage),s(new R(k,P.clarifyTimeoutError?R.ETIMEDOUT:R.ECONNABORTED,r,y)),y=null},n===void 0&&o.setContentType(null),"setRequestHeader"in y&&g.forEach(o.toJSON(),function(k,P){y.setRequestHeader(P,k)}),g.isUndefined(i.withCredentials)||(y.withCredentials=!!i.withCredentials),a&&a!=="json"&&(y.responseType=i.responseType),u&&([p,f]=Cr(u,!0),y.addEventListener("progress",p)),l&&y.upload&&([c,h]=Cr(l),y.upload.addEventListener("progress",c),y.upload.addEventListener("loadend",h)),(i.cancelToken||i.signal)&&(d=A=>{y&&(s(!A||A.type?new wt(null,r,y):A),y.abort(),y=null)},i.cancelToken&&i.cancelToken.subscribe(d),i.signal&&(i.signal.aborted?d():i.signal.addEventListener("abort",d)));const _=Da(i.url);if(_&&ie.protocols.indexOf(_)===-1){s(new R("Unsupported protocol "+_+":",R.ERR_BAD_REQUEST,r));return}y.send(n||null)})},Xa=(r,e)=>{const{length:t}=r=r?r.filter(Boolean):[];if(e||t){let s=new AbortController,i;const n=function(u){if(!i){i=!0,a();const d=u instanceof Error?u:this.reason;s.abort(d instanceof R?d:new wt(d instanceof Error?d.message:d))}};let o=e&&setTimeout(()=>{o=null,n(new R(`timeout ${e} of ms exceeded`,R.ETIMEDOUT))},e);const a=()=>{r&&(o&&clearTimeout(o),o=null,r.forEach(u=>{u.unsubscribe?u.unsubscribe(n):u.removeEventListener("abort",n)}),r=null)};r.forEach(u=>u.addEventListener("abort",n));const{signal:l}=s;return l.unsubscribe=()=>g.asap(a),l}},Qa=Xa,Ya=function*(r,e){let t=r.byteLength;if(!e||t<e){yield r;return}let s=0,i;for(;s<t;)i=s+e,yield r.slice(s,i),s=i},Za=async function*(r,e){for await(const t of el(r))yield*Ya(t,e)},el=async function*(r){if(r[Symbol.asyncIterator]){yield*r;return}const e=r.getReader();try{for(;;){const{done:t,value:s}=await e.read();if(t)break;yield s}}finally{await e.cancel()}},vi=(r,e,t,s)=>{const i=Za(r,e);let n=0,o,a=l=>{o||(o=!0,s&&s(l))};return new ReadableStream({async pull(l){try{const{done:u,value:d}=await i.next();if(u){a(),l.close();return}let c=d.byteLength;if(t){let p=n+=c;t(p)}l.enqueue(new Uint8Array(d))}catch(u){throw a(u),u}},cancel(l){return a(l),i.return()}},{highWaterMark:2})},Ir=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",An=Ir&&typeof ReadableStream=="function",tl=Ir&&(typeof TextEncoder=="function"?(r=>e=>r.encode(e))(new TextEncoder):async r=>new Uint8Array(await new Response(r).arrayBuffer())),Un=(r,...e)=>{try{return!!r(...e)}catch{return!1}},rl=An&&Un(()=>{let r=!1;const e=new Request(ie.origin,{body:new ReadableStream,method:"POST",get duplex(){return r=!0,"half"}}).headers.has("Content-Type");return r&&!e}),bi=64*1024,Es=An&&Un(()=>g.isReadableStream(new Response("").body)),Fr={stream:Es&&(r=>r.body)};Ir&&(r=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Fr[e]&&(Fr[e]=g.isFunction(r[e])?t=>t[e]():(t,s)=>{throw new R(`Response type '${e}' is not supported`,R.ERR_NOT_SUPPORT,s)})})})(new Response);const sl=async r=>{if(r==null)return 0;if(g.isBlob(r))return r.size;if(g.isSpecCompliantForm(r))return(await new Request(ie.origin,{method:"POST",body:r}).arrayBuffer()).byteLength;if(g.isArrayBufferView(r)||g.isArrayBuffer(r))return r.byteLength;if(g.isURLSearchParams(r)&&(r=r+""),g.isString(r))return(await tl(r)).byteLength},il=async(r,e)=>{const t=g.toFiniteNumber(r.getContentLength());return t??sl(e)},nl=Ir&&(async r=>{let{url:e,method:t,data:s,signal:i,cancelToken:n,timeout:o,onDownloadProgress:a,onUploadProgress:l,responseType:u,headers:d,withCredentials:c="same-origin",fetchOptions:p}=On(r);u=u?(u+"").toLowerCase():"text";let h=Qa([i,n&&n.toAbortSignal()],o),f;const m=h&&h.unsubscribe&&(()=>{h.unsubscribe()});let y;try{if(l&&rl&&t!=="get"&&t!=="head"&&(y=await il(d,s))!==0){let P=new Request(e,{method:"POST",body:s,duplex:"half"}),E;if(g.isFormData(s)&&(E=P.headers.get("content-type"))&&d.setContentType(E),P.body){const[T,U]=mi(y,Cr(gi(l)));s=vi(P.body,bi,T,U)}}g.isString(c)||(c=c?"include":"omit");const v="credentials"in Request.prototype;f=new Request(e,{...p,signal:h,method:t.toUpperCase(),headers:d.normalize().toJSON(),body:s,duplex:"half",credentials:v?c:void 0});let _=await fetch(f);const A=Es&&(u==="stream"||u==="response");if(Es&&(a||A&&m)){const P={};["status","statusText","headers"].forEach(M=>{P[M]=_[M]});const E=g.toFiniteNumber(_.headers.get("content-length")),[T,U]=a&&mi(E,Cr(gi(a),!0))||[];_=new Response(vi(_.body,bi,T,()=>{U&&U(),m&&m()}),P)}u=u||"text";let k=await Fr[g.findKey(Fr,u)||"text"](_,r);return!A&&m&&m(),await new Promise((P,E)=>{Cn(P,E,{data:k,headers:we.from(_.headers),status:_.status,statusText:_.statusText,config:r,request:f})})}catch(v){throw m&&m(),v&&v.name==="TypeError"&&/fetch/i.test(v.message)?Object.assign(new R("Network Error",R.ERR_NETWORK,r,f),{cause:v.cause||v}):R.from(v,v&&v.code,r,f)}}),Ts={http:va,xhr:Ka,fetch:nl};g.forEach(Ts,(r,e)=>{if(r){try{Object.defineProperty(r,"name",{value:e})}catch{}Object.defineProperty(r,"adapterName",{value:e})}});const wi=r=>`- ${r}`,ol=r=>g.isFunction(r)||r===null||r===!1,Rn={getAdapter:r=>{r=g.isArray(r)?r:[r];const{length:e}=r;let t,s;const i={};for(let n=0;n<e;n++){t=r[n];let o;if(s=t,!ol(t)&&(s=Ts[(o=String(t)).toLowerCase()],s===void 0))throw new R(`Unknown adapter '${o}'`);if(s)break;i[o||"#"+n]=s}if(!s){const n=Object.entries(i).map(([a,l])=>`adapter ${a} `+(l===!1?"is not supported by the environment":"is not available in the build"));let o=e?n.length>1?`since :
`+n.map(wi).join(`
`):" "+wi(n[0]):"as no adapter specified";throw new R("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return s},adapters:Ts};function Xr(r){if(r.cancelToken&&r.cancelToken.throwIfRequested(),r.signal&&r.signal.aborted)throw new wt(null,r)}function _i(r){return Xr(r),r.headers=we.from(r.headers),r.data=Kr.call(r,r.transformRequest),["post","put","patch"].indexOf(r.method)!==-1&&r.headers.setContentType("application/x-www-form-urlencoded",!1),Rn.getAdapter(r.adapter||qs.adapter)(r).then(function(s){return Xr(r),s.data=Kr.call(r,r.transformResponse,s),s.headers=we.from(s.headers),s},function(s){return kn(s)||(Xr(r),s&&s.response&&(s.response.data=Kr.call(r,r.transformResponse,s.response),s.response.headers=we.from(s.response.headers))),Promise.reject(s)})}const xn="1.7.7",zs={};["object","boolean","number","function","string","symbol"].forEach((r,e)=>{zs[r]=function(s){return typeof s===r||"a"+(e<1?"n ":" ")+r}});const Si={};zs.transitional=function(e,t,s){function i(n,o){return"[Axios v"+xn+"] Transitional option '"+n+"'"+o+(s?". "+s:"")}return(n,o,a)=>{if(e===!1)throw new R(i(o," has been removed"+(t?" in "+t:"")),R.ERR_DEPRECATED);return t&&!Si[o]&&(Si[o]=!0,console.warn(i(o," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(n,o,a):!0}};function al(r,e,t){if(typeof r!="object")throw new R("options must be an object",R.ERR_BAD_OPTION_VALUE);const s=Object.keys(r);let i=s.length;for(;i-- >0;){const n=s[i],o=e[n];if(o){const a=r[n],l=a===void 0||o(a,n,r);if(l!==!0)throw new R("option "+n+" must be "+l,R.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new R("Unknown option "+n,R.ERR_BAD_OPTION)}}const ks={assertOptions:al,validators:zs},We=ks.validators;class Or{constructor(e){this.defaults=e,this.interceptors={request:new hi,response:new hi}}async request(e,t){try{return await this._request(e,t)}catch(s){if(s instanceof Error){let i;Error.captureStackTrace?Error.captureStackTrace(i={}):i=new Error;const n=i.stack?i.stack.replace(/^.+\n/,""):"";try{s.stack?n&&!String(s.stack).endsWith(n.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+n):s.stack=n}catch{}}throw s}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=ft(this.defaults,t);const{transitional:s,paramsSerializer:i,headers:n}=t;s!==void 0&&ks.assertOptions(s,{silentJSONParsing:We.transitional(We.boolean),forcedJSONParsing:We.transitional(We.boolean),clarifyTimeoutError:We.transitional(We.boolean)},!1),i!=null&&(g.isFunction(i)?t.paramsSerializer={serialize:i}:ks.assertOptions(i,{encode:We.function,serialize:We.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=n&&g.merge(n.common,n[t.method]);n&&g.forEach(["delete","get","head","post","put","patch","common"],f=>{delete n[f]}),t.headers=we.concat(o,n);const a=[];let l=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(t)===!1||(l=l&&m.synchronous,a.unshift(m.fulfilled,m.rejected))});const u=[];this.interceptors.response.forEach(function(m){u.push(m.fulfilled,m.rejected)});let d,c=0,p;if(!l){const f=[_i.bind(this),void 0];for(f.unshift.apply(f,a),f.push.apply(f,u),p=f.length,d=Promise.resolve(t);c<p;)d=d.then(f[c++],f[c++]);return d}p=a.length;let h=t;for(c=0;c<p;){const f=a[c++],m=a[c++];try{h=f(h)}catch(y){m.call(this,y);break}}try{d=_i.call(this,h)}catch(f){return Promise.reject(f)}for(c=0,p=u.length;c<p;)d=d.then(u[c++],u[c++]);return d}getUri(e){e=ft(this.defaults,e);const t=Fn(e.baseURL,e.url);return Pn(t,e.params,e.paramsSerializer)}}g.forEach(["delete","get","head","options"],function(e){Or.prototype[e]=function(t,s){return this.request(ft(s||{},{method:e,url:t,data:(s||{}).data}))}});g.forEach(["post","put","patch"],function(e){function t(s){return function(n,o,a){return this.request(ft(a||{},{method:e,headers:s?{"Content-Type":"multipart/form-data"}:{},url:n,data:o}))}}Or.prototype[e]=t(),Or.prototype[e+"Form"]=t(!0)});const wr=Or;class Hs{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(n){t=n});const s=this;this.promise.then(i=>{if(!s._listeners)return;let n=s._listeners.length;for(;n-- >0;)s._listeners[n](i);s._listeners=null}),this.promise.then=i=>{let n;const o=new Promise(a=>{s.subscribe(a),n=a}).then(i);return o.cancel=function(){s.unsubscribe(n)},o},e(function(n,o,a){s.reason||(s.reason=new wt(n,o,a),t(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=s=>{e.abort(s)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new Hs(function(i){e=i}),cancel:e}}}const ll=Hs;function ul(r){return function(t){return r.apply(null,t)}}function cl(r){return g.isObject(r)&&r.isAxiosError===!0}const Cs={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Cs).forEach(([r,e])=>{Cs[e]=r});const dl=Cs;function Mn(r){const e=new wr(r),t=dn(wr.prototype.request,e);return g.extend(t,wr.prototype,e,{allOwnKeys:!0}),g.extend(t,e,null,{allOwnKeys:!0}),t.create=function(i){return Mn(ft(r,i))},t}const I=Mn(qs);I.Axios=wr;I.CanceledError=wt;I.CancelToken=ll;I.isCancel=kn;I.VERSION=xn;I.toFormData=jr;I.AxiosError=R;I.Cancel=I.CanceledError;I.all=function(e){return Promise.all(e)};I.spread=ul;I.isAxiosError=cl;I.mergeConfig=ft;I.AxiosHeaders=we;I.formToJSON=r=>Tn(g.isHTMLForm(r)?new FormData(r):r);I.getAdapter=Rn.getAdapter;I.HttpStatusCode=dl;I.default=I;const pl=I;window.axios=pl;window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";const Mr=class Mr{constructor(e){this.value=e}isTop(){return this.value===Mr.Top}};ai(Mr,"Top","top");let Fs=Mr;class Ws{constructor(e,t){this.alignment=new Fs(e),this.duration=t}static fromJson(e){return new Ws(e.alignment,e.duration)}}function hl(){let r="";for(;r.length<32;)r+=Math.random().toString(16).substring(2);const e=(Number.parseInt(r.substring(16,1),16)&3|8).toString(16);return`${r.substring(0,8)}-${r.substring(8,4)}-4${r.substring(13,3)}-${e}${r.substring(17,3)}-${r.substring(20,12)}`}class Vs{constructor(e,t,s){this.$el=null,this.id=hl(),this.isVisible=!1,this.duration=e,this.message=t,this.timeout=null,this.trashed=!1,this.type=s}static fromJson(e){return new Vs(e.duration,e.message,e.type)}dispose(){this.timeout&&clearTimeout(this.timeout),this.isVisible=!1,this.$el.addEventListener("transitioncancel",()=>{this.trashed=!0}),this.$el.addEventListener("transitionend",()=>{this.trashed=!0})}runAfterDuration(e){this.timeout=setTimeout(()=>e(this),this.duration)}select(e){return e[this.type]}show(e){this.$el=e,this.isVisible=!0}}function fl(r){r.data("toasterHub",(e,t)=>(t=Ws.fromJson(t),{_toasts:[],get toasts(){const s=this._toasts.filter(i=>!i.trashed);return this._toasts.length&&!s.length&&this.$nextTick(()=>{this._toasts=[]}),s},init(){document.addEventListener("toaster:received",s=>{this.show({duration:t.duration,...s.detail})}),e.forEach(s=>this.show(s))},show(s){s=r.reactive(Vs.fromJson(s)),s.runAfterDuration(i=>i.dispose()),t.alignment.isTop()?this._toasts.unshift(s):this._toasts.push(s)}}))}const Dr=(r,e)=>{document.dispatchEvent(new CustomEvent("toaster:received",{detail:{message:r,type:e}}))},ml=r=>Dr(r,"error"),gl=r=>Dr(r,"info"),yl=r=>Dr(r,"success"),vl=r=>Dr(r,"warning"),bl=Object.freeze(Object.defineProperty({__proto__:null,error:ml,info:gl,success:yl,warning:vl},Symbol.toStringTag,{value:"Module"}));window.Toaster=bl;document.addEventListener("alpine:init",()=>{window.Alpine.plugin(fl)});function dr(r,e){if(!{}.hasOwnProperty.call(r,e))throw new TypeError("attempted to use private field on non-instance");return r}var wl=0;function $n(r){return"__private_"+wl+++"_"+r}function _l(r,e,t){const s=[];return r.forEach(i=>typeof i!="string"?s.push(i):e[Symbol.split](i).forEach((n,o,a)=>{n!==""&&s.push(n),o<a.length-1&&s.push(t)})),s}/**
 * Takes a string with placeholder variables like `%{smart_count} file selected`
 * and replaces it with values from options `{smart_count: 5}`
 *
 * @license https://github.com/airbnb/polyglot.js/blob/master/LICENSE
 * taken from https://github.com/airbnb/polyglot.js/blob/master/lib/polyglot.js#L299
 *
 * @param phrase that needs interpolation, with placeholders
 * @param options with values that will be used to replace placeholders
 */function Pi(r,e){const t=/\$/g,s="$$$$";let i=[r];if(e==null)return i;for(const n of Object.keys(e))if(n!=="_"){let o=e[n];typeof o=="string"&&(o=t[Symbol.replace](o,s)),i=_l(i,new RegExp(`%\\{${n}\\}`,"g"),o)}return i}const Sl=r=>{throw new Error(`missing string: ${r}`)};var Et=$n("onMissingKey"),Tt=$n("apply");class Nn{constructor(e,t){let{onMissingKey:s=Sl}=t===void 0?{}:t;Object.defineProperty(this,Tt,{value:Pl}),Object.defineProperty(this,Et,{writable:!0,value:void 0}),this.locale={strings:{},pluralize(i){return i===1?0:1}},Array.isArray(e)?e.forEach(dr(this,Tt)[Tt],this):dr(this,Tt)[Tt](e),dr(this,Et)[Et]=s}translate(e,t){return this.translateArray(e,t).join("")}translateArray(e,t){let s=this.locale.strings[e];if(s==null&&(dr(this,Et)[Et](e),s=e),typeof s=="object"){if(t&&typeof t.smart_count<"u"){const n=this.locale.pluralize(t.smart_count);return Pi(s[n],t)}throw new Error("Attempted to use a string with plural forms, but no value was given for %{smart_count}")}if(typeof s!="string")throw new Error("string was not a string");return Pi(s,t)}}function Pl(r){if(!(r!=null&&r.strings))return;const e=this.locale;Object.assign(this.locale,{strings:{...e.strings,...r.strings},pluralize:r.pluralize||e.pluralize})}var pr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _t(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var El=function(){var e={},t=e._fns={};e.emit=function(o,a,l,u,d,c,p){var h=s(o);h.length&&i(o,h,[a,l,u,d,c,p])},e.on=function(o,a){t[o]||(t[o]=[]),t[o].push(a)},e.once=function(o,a){function l(){a.apply(this,arguments),e.off(o,l)}this.on(o,l)},e.off=function(o,a){var l=[];if(o&&a){var u=this._fns[o],d=0,c=u?u.length:0;for(d;d<c;d++)u[d]!==a&&l.push(u[d])}l.length?this._fns[o]=l:delete this._fns[o]};function s(n){var o=t[n]?t[n]:[],a=n.indexOf(":"),l=a===-1?[n]:[n.substring(0,a),n.substring(a+1)],u=Object.keys(t),d=0,c=u.length;for(d;d<c;d++){var p=u[d];if(p==="*"&&(o=o.concat(t[p])),l.length===2&&l[0]===p){o=o.concat(t[p]);break}}return o}function i(n,o,a){var l=0,u=o.length;for(l;l<u&&o[l];l++)o[l].event=n,o[l].apply(o[l],a)}return e};const Tl=_t(El);let kl="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",Cl=(r=21)=>{let e="",t=r|0;for(;t--;)e+=kl[Math.random()*64|0];return e};function Fl(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}var Gs=Fl,Ol=typeof pr=="object"&&pr&&pr.Object===Object&&pr,Al=Ol,Ul=Al,Rl=typeof self=="object"&&self&&self.Object===Object&&self,xl=Ul||Rl||Function("return this")(),Ln=xl,Ml=Ln,$l=function(){return Ml.Date.now()},Nl=$l,Ll=/\s/;function jl(r){for(var e=r.length;e--&&Ll.test(r.charAt(e)););return e}var Bl=jl,Il=Bl,Dl=/^\s+/;function ql(r){return r&&r.slice(0,Il(r)+1).replace(Dl,"")}var zl=ql,Hl=Ln,Wl=Hl.Symbol,jn=Wl,Ei=jn,Bn=Object.prototype,Vl=Bn.hasOwnProperty,Gl=Bn.toString,kt=Ei?Ei.toStringTag:void 0;function Jl(r){var e=Vl.call(r,kt),t=r[kt];try{r[kt]=void 0;var s=!0}catch{}var i=Gl.call(r);return s&&(e?r[kt]=t:delete r[kt]),i}var Kl=Jl,Xl=Object.prototype,Ql=Xl.toString;function Yl(r){return Ql.call(r)}var Zl=Yl,Ti=jn,eu=Kl,tu=Zl,ru="[object Null]",su="[object Undefined]",ki=Ti?Ti.toStringTag:void 0;function iu(r){return r==null?r===void 0?su:ru:ki&&ki in Object(r)?eu(r):tu(r)}var nu=iu;function ou(r){return r!=null&&typeof r=="object"}var au=ou,lu=nu,uu=au,cu="[object Symbol]";function du(r){return typeof r=="symbol"||uu(r)&&lu(r)==cu}var pu=du,hu=zl,Ci=Gs,fu=pu,Fi=0/0,mu=/^[-+]0x[0-9a-f]+$/i,gu=/^0b[01]+$/i,yu=/^0o[0-7]+$/i,vu=parseInt;function bu(r){if(typeof r=="number")return r;if(fu(r))return Fi;if(Ci(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=Ci(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=hu(r);var t=gu.test(r);return t||yu.test(r)?vu(r.slice(2),t?2:8):mu.test(r)?Fi:+r}var wu=bu,_u=Gs,Qr=Nl,Oi=wu,Su="Expected a function",Pu=Math.max,Eu=Math.min;function Tu(r,e,t){var s,i,n,o,a,l,u=0,d=!1,c=!1,p=!0;if(typeof r!="function")throw new TypeError(Su);e=Oi(e)||0,_u(t)&&(d=!!t.leading,c="maxWait"in t,n=c?Pu(Oi(t.maxWait)||0,e):n,p="trailing"in t?!!t.trailing:p);function h(E){var T=s,U=i;return s=i=void 0,u=E,o=r.apply(U,T),o}function f(E){return u=E,a=setTimeout(v,e),d?h(E):o}function m(E){var T=E-l,U=E-u,M=e-T;return c?Eu(M,n-U):M}function y(E){var T=E-l,U=E-u;return l===void 0||T>=e||T<0||c&&U>=n}function v(){var E=Qr();if(y(E))return _(E);a=setTimeout(v,m(E))}function _(E){return a=void 0,p&&s?h(E):(s=i=void 0,o)}function A(){a!==void 0&&clearTimeout(a),u=0,s=l=i=a=void 0}function k(){return a===void 0?o:_(Qr())}function P(){var E=Qr(),T=y(E);if(s=arguments,i=this,l=E,T){if(a===void 0)return f(l);if(c)return clearTimeout(a),a=setTimeout(v,e),h(l)}return a===void 0&&(a=setTimeout(v,e)),o}return P.cancel=A,P.flush=k,P}var ku=Tu,Cu=ku,Fu=Gs,Ou="Expected a function";function Au(r,e,t){var s=!0,i=!0;if(typeof r!="function")throw new TypeError(Ou);return Fu(t)&&(s="leading"in t?!!t.leading:s,i="trailing"in t?!!t.trailing:i),Cu(r,e,{leading:s,maxWait:e,trailing:i})}var Uu=Au;const Ru=_t(Uu);function _r(r,e){if(!{}.hasOwnProperty.call(r,e))throw new TypeError("attempted to use private field on non-instance");return r}var xu=0;function In(r){return"__private_"+xu+++"_"+r}const Mu={version:"4.2.0"};var tt=In("callbacks"),Yr=In("publish");class Dn{constructor(){Object.defineProperty(this,Yr,{value:$u}),this.state={},Object.defineProperty(this,tt,{writable:!0,value:new Set})}getState(){return this.state}setState(e){const t={...this.state},s={...this.state,...e};this.state=s,_r(this,Yr)[Yr](t,s,e)}subscribe(e){return _r(this,tt)[tt].add(e),()=>{_r(this,tt)[tt].delete(e)}}}function $u(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];_r(this,tt)[tt].forEach(s=>{s(...e)})}Dn.VERSION=Mu.version;function qn(r){const e=r.lastIndexOf(".");return e===-1||e===r.length-1?{name:r,extension:void 0}:{name:r.slice(0,e),extension:r.slice(e+1)}}const Ai={__proto__:null,md:"text/markdown",markdown:"text/markdown",mp4:"video/mp4",mp3:"audio/mp3",svg:"image/svg+xml",jpg:"image/jpeg",png:"image/png",webp:"image/webp",gif:"image/gif",heic:"image/heic",heif:"image/heif",yaml:"text/yaml",yml:"text/yaml",csv:"text/csv",tsv:"text/tab-separated-values",tab:"text/tab-separated-values",avi:"video/x-msvideo",mks:"video/x-matroska",mkv:"video/x-matroska",mov:"video/quicktime",dicom:"application/dicom",doc:"application/msword",msg:"application/vnd.ms-outlook",docm:"application/vnd.ms-word.document.macroenabled.12",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dot:"application/msword",dotm:"application/vnd.ms-word.template.macroenabled.12",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",xla:"application/vnd.ms-excel",xlam:"application/vnd.ms-excel.addin.macroenabled.12",xlc:"application/vnd.ms-excel",xlf:"application/x-xliff+xml",xlm:"application/vnd.ms-excel",xls:"application/vnd.ms-excel",xlsb:"application/vnd.ms-excel.sheet.binary.macroenabled.12",xlsm:"application/vnd.ms-excel.sheet.macroenabled.12",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlt:"application/vnd.ms-excel",xltm:"application/vnd.ms-excel.template.macroenabled.12",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xlw:"application/vnd.ms-excel",txt:"text/plain",text:"text/plain",conf:"text/plain",log:"text/plain",pdf:"application/pdf",zip:"application/zip","7z":"application/x-7z-compressed",rar:"application/x-rar-compressed",tar:"application/x-tar",gz:"application/gzip",dmg:"application/x-apple-diskimage"};function zn(r){var e;if(r.type)return r.type;const t=r.name?(e=qn(r.name).extension)==null?void 0:e.toLowerCase():null;return t&&t in Ai?Ai[t]:"application/octet-stream"}function Nu(r){return r.charCodeAt(0).toString(32)}function Ui(r){let e="";return r.replace(/[^A-Z0-9]/gi,t=>(e+=`-${Nu(t)}`,"/"))+e}function Lu(r,e){let t=e||"uppy";return typeof r.name=="string"&&(t+=`-${Ui(r.name.toLowerCase())}`),r.type!==void 0&&(t+=`-${r.type}`),r.meta&&typeof r.meta.relativePath=="string"&&(t+=`-${Ui(r.meta.relativePath.toLowerCase())}`),r.data.size!==void 0&&(t+=`-${r.data.size}`),r.data.lastModified!==void 0&&(t+=`-${r.data.lastModified}`),t}function ju(r){return!r.isRemote||!r.remote?!1:new Set(["box","dropbox","drive","facebook","unsplash"]).has(r.remote.provider)}function Bu(r,e){if(ju(r))return r.id;const t=zn(r);return Lu({...r,type:t},e)}function Iu(r){if(r==null&&typeof navigator<"u"&&(r=navigator.userAgent),!r)return!0;const e=/Edge\/(\d+\.\d+)/.exec(r);if(!e)return!0;const s=e[1].split(".",2),i=parseInt(s[0],10),n=parseInt(s[1],10);return i<15||i===15&&n<15063||i>18||i===18&&n>=18218}function Du(r,e){return e.name?e.name:r.split("/")[0]==="image"?`${r.split("/")[0]}.${r.split("/")[1]}`:"noname"}function Zr(r){return r<10?`0${r}`:r.toString()}function Sr(){const r=new Date,e=Zr(r.getHours()),t=Zr(r.getMinutes()),s=Zr(r.getSeconds());return`${e}:${t}:${s}`}const qu={debug:()=>{},warn:()=>{},error:function(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];return console.error(`[Uppy] [${Sr()}]`,...e)}},zu={debug:function(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];return console.debug(`[Uppy] [${Sr()}]`,...e)},warn:function(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];return console.warn(`[Uppy] [${Sr()}]`,...e)},error:function(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];return console.error(`[Uppy] [${Sr()}]`,...e)}};var Hu=function(e){if(typeof e!="number"||Number.isNaN(e))throw new TypeError(`Expected a number, got ${typeof e}`);const t=e<0;let s=Math.abs(e);if(t&&(s=-s),s===0)return"0 B";const i=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],n=Math.min(Math.floor(Math.log(s)/Math.log(1024)),i.length-1),o=Number(s/1024**n),a=i[n];return`${o>=10||o%1===0?Math.round(o):o.toFixed(1)} ${a}`};const gt=_t(Hu);function Hn(r,e){this.text=r=r||"",this.hasWild=~r.indexOf("*"),this.separator=e,this.parts=r.split(e)}Hn.prototype.match=function(r){var e=!0,t=this.parts,s,i=t.length,n;if(typeof r=="string"||r instanceof String)if(!this.hasWild&&this.text!=r)e=!1;else{for(n=(r||"").split(this.separator),s=0;e&&s<i;s++)t[s]!=="*"&&(s<n.length?e=t[s]===n[s]:e=!1);e=e&&n}else if(typeof r.splice=="function")for(e=[],s=r.length;s--;)this.match(r[s])&&(e[e.length]=r[s]);else if(typeof r=="object"){e={};for(var o in r)this.match(o)&&(e[o]=r[o])}return e};var Wu=function(r,e,t){var s=new Hn(r,t||/[\/\.]/);return typeof e<"u"?s.match(e):s},Vu=Wu,Gu=/[\/\+\.]/,Ju=function(r,e){function t(s){var i=Vu(s,r,Gu);return i&&i.length>=2}return e?t(e.split(";")[0]):t};const Ku=_t(Ju),Xu={maxFileSize:null,minFileSize:null,maxTotalFileSize:null,maxNumberOfFiles:null,minNumberOfFiles:null,allowedFileTypes:null,requiredMetaFields:[]};class ye extends Error{constructor(e,t){var s;super(e),this.isRestriction=!0,this.isUserFacing=(s=t==null?void 0:t.isUserFacing)!=null?s:!0,t!=null&&t.file&&(this.file=t.file)}}class Qu{constructor(e,t){this.getI18n=t,this.getOpts=()=>{var s;const i=e();if(((s=i.restrictions)==null?void 0:s.allowedFileTypes)!=null&&!Array.isArray(i.restrictions.allowedFileTypes))throw new TypeError("`restrictions.allowedFileTypes` must be an array");return i}}validateAggregateRestrictions(e,t){const{maxTotalFileSize:s,maxNumberOfFiles:i}=this.getOpts().restrictions;if(i&&e.filter(o=>!o.isGhost).length+t.length>i)throw new ye(`${this.getI18n()("youCanOnlyUploadX",{smart_count:i})}`);if(s){const n=[...e,...t].reduce((o,a)=>{var l;return o+((l=a.size)!=null?l:0)},0);if(n>s)throw new ye(this.getI18n()("aggregateExceedsSize",{sizeAllowed:gt(s),size:gt(n)}))}}validateSingleFile(e){const{maxFileSize:t,minFileSize:s,allowedFileTypes:i}=this.getOpts().restrictions;if(i&&!i.some(a=>a.includes("/")?e.type?Ku(e.type.replace(/;.*?$/,""),a):!1:a[0]==="."&&e.extension?e.extension.toLowerCase()===a.slice(1).toLowerCase():!1)){const a=i.join(", ");throw new ye(this.getI18n()("youCanOnlyUploadFileTypes",{types:a}),{file:e})}if(t&&e.size!=null&&e.size>t){var n;throw new ye(this.getI18n()("exceedsSize",{size:gt(t),file:(n=e.name)!=null?n:this.getI18n()("unnamed")}),{file:e})}if(s&&e.size!=null&&e.size<s)throw new ye(this.getI18n()("inferiorSize",{size:gt(s)}),{file:e})}validate(e,t){t.forEach(s=>{this.validateSingleFile(s)}),this.validateAggregateRestrictions(e,t)}validateMinNumberOfFiles(e){const{minNumberOfFiles:t}=this.getOpts().restrictions;if(t&&Object.keys(e).length<t)throw new ye(this.getI18n()("youHaveToAtLeastSelectX",{smart_count:t}))}getMissingRequiredMetaFields(e){var t;const s=new ye(this.getI18n()("missingRequiredMetaFieldOnFile",{fileName:(t=e.name)!=null?t:this.getI18n()("unnamed")})),{requiredMetaFields:i}=this.getOpts().restrictions,n=[];for(const o of i)(!Object.hasOwn(e.meta,o)||e.meta[o]==="")&&n.push(o);return{missingFields:n,error:s}}}const Yu={strings:{addBulkFilesFailed:{0:"Failed to add %{smart_count} file due to an internal error",1:"Failed to add %{smart_count} files due to internal errors"},youCanOnlyUploadX:{0:"You can only upload %{smart_count} file",1:"You can only upload %{smart_count} files"},youHaveToAtLeastSelectX:{0:"You have to select at least %{smart_count} file",1:"You have to select at least %{smart_count} files"},aggregateExceedsSize:"You selected %{size} of files, but maximum allowed size is %{sizeAllowed}",exceedsSize:"%{file} exceeds maximum allowed size of %{size}",missingRequiredMetaField:"Missing required meta fields",missingRequiredMetaFieldOnFile:"Missing required meta fields in %{fileName}",inferiorSize:"This file is smaller than the allowed size of %{size}",youCanOnlyUploadFileTypes:"You can only upload: %{types}",noMoreFilesAllowed:"Cannot add more files",noDuplicates:"Cannot add the duplicate file '%{fileName}', it already exists",companionError:"Connection with Companion failed",authAborted:"Authentication aborted",companionUnauthorizeHint:"To unauthorize to your %{provider} account, please go to %{url}",failedToUpload:"Failed to upload %{file}",noInternetConnection:"No Internet connection",connectedToInternet:"Connected to the Internet",noFilesFound:"You have no files or folders here",noSearchResults:"Unfortunately, there are no results for this search",selectX:{0:"Select %{smart_count}",1:"Select %{smart_count}"},allFilesFromFolderNamed:"All files from folder %{name}",openFolderNamed:"Open folder %{name}",cancel:"Cancel",logOut:"Log out",logIn:"Log in",pickFiles:"Pick files",pickPhotos:"Pick photos",filter:"Filter",resetFilter:"Reset filter",loading:"Loading...",loadedXFiles:"Loaded %{numFiles} files",authenticateWithTitle:"Please authenticate with %{pluginName} to select files",authenticateWith:"Connect to %{pluginName}",signInWithGoogle:"Sign in with Google",searchImages:"Search for images",enterTextToSearch:"Enter text to search for images",search:"Search",resetSearch:"Reset search",emptyFolderAdded:"No files were added from empty folder",addedNumFiles:"Added %{numFiles} file(s)",folderAlreadyAdded:'The folder "%{folder}" was already added',folderAdded:{0:"Added %{smart_count} file from %{folder}",1:"Added %{smart_count} files from %{folder}"},additionalRestrictionsFailed:"%{count} additional restrictions were not fulfilled",unnamed:"Unnamed",pleaseWait:"Please wait"}};function b(r,e){if(!{}.hasOwnProperty.call(r,e))throw new TypeError("attempted to use private field on non-instance");return r}var Zu=0;function N(r){return"__private_"+Zu+++"_"+r}const ec={version:"4.4.7"},hr={totalProgress:0,allowNewUpload:!0,error:null,recoveredState:null};var H=N("plugins"),J=N("restricter"),Ct=N("storeUnsubscribe"),Oe=N("emitter"),rt=N("preProcessors"),st=N("uploaders"),Ie=N("postProcessors"),de=N("informAndEmit"),ir=N("checkRequiredMetaFieldsOnFile"),es=N("checkRequiredMetaFields"),Ft=N("assertNewUploadAllowed"),Os=N("transformFile"),Ot=N("startIfAutoProceed"),At=N("checkAndUpdateFileState"),Zt=N("getFilesToRetry"),Ut=N("doRetryAll"),As=N("handleUploadProgress"),Rt=N("updateTotalProgress"),De=N("updateTotalProgressThrottled"),Us=N("calculateTotalProgress"),ts=N("addListeners"),be=N("updateOnlineStatus"),xt=N("requestClientById"),$e=N("createUpload"),rs=N("getUpload"),dt=N("removeUpload"),Ne=N("runUpload");class qr{constructor(e){Object.defineProperty(this,Ne,{value:gc}),Object.defineProperty(this,dt,{value:mc}),Object.defineProperty(this,rs,{value:fc}),Object.defineProperty(this,$e,{value:hc}),Object.defineProperty(this,ts,{value:pc}),Object.defineProperty(this,Us,{value:dc}),Object.defineProperty(this,Rt,{value:cc}),Object.defineProperty(this,Ut,{value:uc}),Object.defineProperty(this,Zt,{value:lc}),Object.defineProperty(this,At,{value:ac}),Object.defineProperty(this,Ot,{value:oc}),Object.defineProperty(this,Os,{value:nc}),Object.defineProperty(this,Ft,{value:ic}),Object.defineProperty(this,es,{value:sc}),Object.defineProperty(this,ir,{value:rc}),Object.defineProperty(this,de,{value:tc}),Object.defineProperty(this,H,{writable:!0,value:Object.create(null)}),Object.defineProperty(this,J,{writable:!0,value:void 0}),Object.defineProperty(this,Ct,{writable:!0,value:void 0}),Object.defineProperty(this,Oe,{writable:!0,value:Tl()}),Object.defineProperty(this,rt,{writable:!0,value:new Set}),Object.defineProperty(this,st,{writable:!0,value:new Set}),Object.defineProperty(this,Ie,{writable:!0,value:new Set}),this.scheduledAutoProceed=null,this.wasOffline=!1,Object.defineProperty(this,As,{writable:!0,value:(i,n)=>{const o=i?this.getFile(i.id):void 0;if(i==null||!o){this.log(`Not setting progress for a file that has been removed: ${i==null?void 0:i.id}`);return}if(o.progress.percentage===100){this.log(`Not setting progress for a file that has been already uploaded: ${i.id}`);return}const a={bytesTotal:n.bytesTotal,percentage:n.bytesTotal!=null&&Number.isFinite(n.bytesTotal)&&n.bytesTotal>0?Math.round(n.bytesUploaded/n.bytesTotal*100):void 0};o.progress.uploadStarted!=null?this.setFileState(i.id,{progress:{...o.progress,...a,bytesUploaded:n.bytesUploaded}}):this.setFileState(i.id,{progress:{...o.progress,...a}}),b(this,De)[De]()}}),Object.defineProperty(this,De,{writable:!0,value:Ru(()=>b(this,Rt)[Rt](),500,{leading:!0,trailing:!0})}),Object.defineProperty(this,be,{writable:!0,value:this.updateOnlineStatus.bind(this)}),Object.defineProperty(this,xt,{writable:!0,value:new Map}),this.defaultLocale=Yu;const t={id:"uppy",autoProceed:!1,allowMultipleUploadBatches:!0,debug:!1,restrictions:Xu,meta:{},onBeforeFileAdded:(i,n)=>!Object.hasOwn(n,i.id),onBeforeUpload:i=>i,store:new Dn,logger:qu,infoTimeout:5e3},s={...t,...e};this.opts={...s,restrictions:{...t.restrictions,...e&&e.restrictions}},e&&e.logger&&e.debug?this.log("You are using a custom `logger`, but also set `debug: true`, which uses built-in logger to output logs to console. Ignoring `debug: true` and using your custom `logger`.","warning"):e&&e.debug&&(this.opts.logger=zu),this.log(`Using Core v${qr.VERSION}`),this.i18nInit(),this.store=this.opts.store,this.setState({...hr,plugins:{},files:{},currentUploads:{},capabilities:{uploadProgress:Iu(),individualCancellation:!0,resumableUploads:!1},meta:{...this.opts.meta},info:[]}),b(this,J)[J]=new Qu(()=>this.opts,()=>this.i18n),b(this,Ct)[Ct]=this.store.subscribe((i,n,o)=>{this.emit("state-update",i,n,o),this.updateAll(n)}),this.opts.debug&&typeof window<"u"&&(window[this.opts.id]=this),b(this,ts)[ts]()}emit(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),i=1;i<t;i++)s[i-1]=arguments[i];b(this,Oe)[Oe].emit(e,...s)}on(e,t){return b(this,Oe)[Oe].on(e,t),this}once(e,t){return b(this,Oe)[Oe].once(e,t),this}off(e,t){return b(this,Oe)[Oe].off(e,t),this}updateAll(e){this.iteratePlugins(t=>{t.update(e)})}setState(e){this.store.setState(e)}getState(){return this.store.getState()}patchFilesState(e){const t=this.getState().files;this.setState({files:{...t,...Object.fromEntries(Object.entries(e).map(s=>{let[i,n]=s;return[i,{...t[i],...n}]}))}})}setFileState(e,t){if(!this.getState().files[e])throw new Error(`Can’t set state for ${e} (the file could have been removed)`);this.patchFilesState({[e]:t})}i18nInit(){const e=s=>this.log(`Missing i18n string: ${s}`,"error"),t=new Nn([this.defaultLocale,this.opts.locale],{onMissingKey:e});this.i18n=t.translate.bind(t),this.i18nArray=t.translateArray.bind(t),this.locale=t.locale}setOptions(e){this.opts={...this.opts,...e,restrictions:{...this.opts.restrictions,...e==null?void 0:e.restrictions}},e.meta&&this.setMeta(e.meta),this.i18nInit(),e.locale&&this.iteratePlugins(t=>{t.setOptions(e)}),this.setState(void 0)}resetProgress(){const e={percentage:0,bytesUploaded:!1,uploadComplete:!1,uploadStarted:null},t={...this.getState().files},s=Object.create(null);Object.keys(t).forEach(i=>{s[i]={...t[i],progress:{...t[i].progress,...e},tus:void 0,transloadit:void 0}}),this.setState({files:s,...hr})}clear(){const{capabilities:e,currentUploads:t}=this.getState();if(Object.keys(t).length>0&&!e.individualCancellation)throw new Error("The installed uploader plugin does not allow removing files during an upload.");this.setState({...hr,files:{}})}addPreProcessor(e){b(this,rt)[rt].add(e)}removePreProcessor(e){return b(this,rt)[rt].delete(e)}addPostProcessor(e){b(this,Ie)[Ie].add(e)}removePostProcessor(e){return b(this,Ie)[Ie].delete(e)}addUploader(e){b(this,st)[st].add(e)}removeUploader(e){return b(this,st)[st].delete(e)}setMeta(e){const t={...this.getState().meta,...e},s={...this.getState().files};Object.keys(s).forEach(i=>{s[i]={...s[i],meta:{...s[i].meta,...e}}}),this.log("Adding metadata:"),this.log(e),this.setState({meta:t,files:s})}setFileMeta(e,t){const s={...this.getState().files};if(!s[e]){this.log(`Was trying to set metadata for a file that has been removed: ${e}`);return}const i={...s[e].meta,...t};s[e]={...s[e],meta:i},this.setState({files:s})}getFile(e){return this.getState().files[e]}getFiles(){const{files:e}=this.getState();return Object.values(e)}getFilesByIds(e){return e.map(t=>this.getFile(t))}getObjectOfFilesPerState(){const{files:e,totalProgress:t,error:s}=this.getState(),i=Object.values(e),n=[],o=[],a=[],l=[],u=[],d=[],c=[],p=[],h=[];for(const f of i){const{progress:m}=f;!m.uploadComplete&&m.uploadStarted&&(n.push(f),f.isPaused||p.push(f)),m.uploadStarted||o.push(f),(m.uploadStarted||m.preprocess||m.postprocess)&&a.push(f),m.uploadStarted&&l.push(f),f.isPaused&&u.push(f),m.uploadComplete&&d.push(f),f.error&&c.push(f),(m.preprocess||m.postprocess)&&h.push(f)}return{newFiles:o,startedFiles:a,uploadStartedFiles:l,pausedFiles:u,completeFiles:d,erroredFiles:c,inProgressFiles:n,inProgressNotPausedFiles:p,processingFiles:h,isUploadStarted:l.length>0,isAllComplete:t===100&&d.length===i.length&&h.length===0,isAllErrored:!!s&&c.length===i.length,isAllPaused:n.length!==0&&u.length===n.length,isUploadInProgress:n.length>0,isSomeGhost:i.some(f=>f.isGhost)}}validateRestrictions(e,t){t===void 0&&(t=this.getFiles());try{b(this,J)[J].validate(t,[e])}catch(s){return s}return null}validateSingleFile(e){try{b(this,J)[J].validateSingleFile(e)}catch(t){return t.message}return null}validateAggregateRestrictions(e){const t=this.getFiles();try{b(this,J)[J].validateAggregateRestrictions(t,e)}catch(s){return s.message}return null}checkIfFileAlreadyExists(e){const{files:t}=this.getState();return!!(t[e]&&!t[e].isGhost)}addFile(e){b(this,Ft)[Ft](e);const{nextFilesState:t,validFilesToAdd:s,errors:i}=b(this,At)[At]([e]),n=i.filter(a=>a.isRestriction);if(b(this,de)[de](n),i.length>0)throw i[0];this.setState({files:t});const[o]=s;return this.emit("file-added",o),this.emit("files-added",s),this.log(`Added file: ${o.name}, ${o.id}, mime type: ${o.type}`),b(this,Ot)[Ot](),o.id}addFiles(e){b(this,Ft)[Ft]();const{nextFilesState:t,validFilesToAdd:s,errors:i}=b(this,At)[At](e),n=i.filter(a=>a.isRestriction);b(this,de)[de](n);const o=i.filter(a=>!a.isRestriction);if(o.length>0){let a=`Multiple errors occurred while adding files:
`;if(o.forEach(l=>{a+=`
 * ${l.message}`}),this.info({message:this.i18n("addBulkFilesFailed",{smart_count:o.length}),details:a},"error",this.opts.infoTimeout),typeof AggregateError=="function")throw new AggregateError(o,a);{const l=new Error(a);throw l.errors=o,l}}this.setState({files:t}),s.forEach(a=>{this.emit("file-added",a)}),this.emit("files-added",s),s.length>5?this.log(`Added batch of ${s.length} files`):Object.values(s).forEach(a=>{this.log(`Added file: ${a.name}
 id: ${a.id}
 type: ${a.type}`)}),s.length>0&&b(this,Ot)[Ot]()}removeFiles(e){const{files:t,currentUploads:s}=this.getState(),i={...t},n={...s},o=Object.create(null);e.forEach(d=>{t[d]&&(o[d]=t[d],delete i[d])});function a(d){return o[d]===void 0}Object.keys(n).forEach(d=>{const c=s[d].fileIDs.filter(a);if(c.length===0){delete n[d];return}const{capabilities:p}=this.getState();if(c.length!==s[d].fileIDs.length&&!p.individualCancellation)throw new Error("The installed uploader plugin does not allow removing files during an upload.");n[d]={...s[d],fileIDs:c}});const l={currentUploads:n,files:i};Object.keys(i).length===0&&(l.allowNewUpload=!0,l.error=null,l.recoveredState=null),this.setState(l),b(this,De)[De]();const u=Object.keys(o);u.forEach(d=>{this.emit("file-removed",o[d])}),u.length>5?this.log(`Removed ${u.length} files`):this.log(`Removed files: ${u.join(", ")}`)}removeFile(e){this.removeFiles([e])}pauseResume(e){if(!this.getState().capabilities.resumableUploads||this.getFile(e).progress.uploadComplete)return;const t=this.getFile(e),i=!(t.isPaused||!1);return this.setFileState(e,{isPaused:i}),this.emit("upload-pause",t,i),i}pauseAll(){const e={...this.getState().files};Object.keys(e).filter(s=>!e[s].progress.uploadComplete&&e[s].progress.uploadStarted).forEach(s=>{const i={...e[s],isPaused:!0};e[s]=i}),this.setState({files:e}),this.emit("pause-all")}resumeAll(){const e={...this.getState().files};Object.keys(e).filter(s=>!e[s].progress.uploadComplete&&e[s].progress.uploadStarted).forEach(s=>{const i={...e[s],isPaused:!1,error:null};e[s]=i}),this.setState({files:e}),this.emit("resume-all")}async retryAll(){const e=await b(this,Ut)[Ut]();return this.emit("complete",e),e}cancelAll(){this.emit("cancel-all");const{files:e}=this.getState(),t=Object.keys(e);t.length&&this.removeFiles(t),this.setState(hr)}retryUpload(e){this.setFileState(e,{error:null,isPaused:!1}),this.emit("upload-retry",this.getFile(e));const t=b(this,$e)[$e]([e],{forceAllowNewUpload:!0});return b(this,Ne)[Ne](t)}logout(){this.iteratePlugins(e=>{var t;(t=e.provider)==null||t.logout==null||t.logout()})}[Symbol.for("uppy test: updateTotalProgress")](){return b(this,Rt)[Rt]()}updateOnlineStatus(){var e;((e=window.navigator.onLine)!=null?e:!0)?(this.emit("is-online"),this.wasOffline&&(this.emit("back-online"),this.info(this.i18n("connectedToInternet"),"success",3e3),this.wasOffline=!1)):(this.emit("is-offline"),this.info(this.i18n("noInternetConnection"),"error",0),this.wasOffline=!0)}getID(){return this.opts.id}use(e){if(typeof e!="function"){const l=`Expected a plugin class, but got ${e===null?"null":typeof e}. Please verify that the plugin was imported and spelled correctly.`;throw new TypeError(l)}for(var t=arguments.length,s=new Array(t>1?t-1:0),i=1;i<t;i++)s[i-1]=arguments[i];const n=new e(this,...s),o=n.id;if(!o)throw new Error("Your plugin must have an id");if(!n.type)throw new Error("Your plugin must have a type");const a=this.getPlugin(o);if(a){const l=`Already found a plugin named '${a.id}'. Tried to use: '${o}'.
Uppy plugins must have unique \`id\` options.`;throw new Error(l)}return e.VERSION&&this.log(`Using ${o} v${e.VERSION}`),n.type in b(this,H)[H]?b(this,H)[H][n.type].push(n):b(this,H)[H][n.type]=[n],n.install(),this.emit("plugin-added",n),this}getPlugin(e){for(const t of Object.values(b(this,H)[H])){const s=t.find(i=>i.id===e);if(s!=null)return s}}[Symbol.for("uppy test: getPlugins")](e){return b(this,H)[H][e]}iteratePlugins(e){Object.values(b(this,H)[H]).flat(1).forEach(e)}removePlugin(e){this.log(`Removing plugin ${e.id}`),this.emit("plugin-remove",e),e.uninstall&&e.uninstall();const t=b(this,H)[H][e.type],s=t.findIndex(o=>o.id===e.id);s!==-1&&t.splice(s,1);const n={plugins:{...this.getState().plugins,[e.id]:void 0}};this.setState(n)}destroy(){this.log(`Closing Uppy instance ${this.opts.id}: removing all files and uninstalling plugins`),this.cancelAll(),b(this,Ct)[Ct](),this.iteratePlugins(e=>{this.removePlugin(e)}),typeof window<"u"&&window.removeEventListener&&(window.removeEventListener("online",b(this,be)[be]),window.removeEventListener("offline",b(this,be)[be]))}hideInfo(){const{info:e}=this.getState();this.setState({info:e.slice(1)}),this.emit("info-hidden")}info(e,t,s){t===void 0&&(t="info"),s===void 0&&(s=3e3);const i=typeof e=="object";this.setState({info:[...this.getState().info,{type:t,message:i?e.message:e,details:i?e.details:null}]}),setTimeout(()=>this.hideInfo(),s),this.emit("info-visible")}log(e,t){const{logger:s}=this.opts;switch(t){case"error":s.error(e);break;case"warning":s.warn(e);break;default:s.debug(e);break}}registerRequestClient(e,t){b(this,xt)[xt].set(e,t)}getRequestClientForFile(e){if(!e.remote)throw new Error(`Tried to get RequestClient for a non-remote file ${e.id}`);const t=b(this,xt)[xt].get(e.remote.requestClientId);if(t==null)throw new Error(`requestClientId "${e.remote.requestClientId}" not registered for file "${e.id}"`);return t}restore(e){return this.log(`Core: attempting to restore upload "${e}"`),this.getState().currentUploads[e]?b(this,Ne)[Ne](e):(b(this,dt)[dt](e),Promise.reject(new Error("Nonexistent upload")))}[Symbol.for("uppy test: createUpload")](){return b(this,$e)[$e](...arguments)}addResultData(e,t){if(!b(this,rs)[rs](e)){this.log(`Not setting result for an upload that has been removed: ${e}`);return}const{currentUploads:s}=this.getState(),i={...s[e],result:{...s[e].result,...t}};this.setState({currentUploads:{...s,[e]:i}})}async upload(){var e;(e=b(this,H)[H].uploader)!=null&&e.length||this.log("No uploader type plugins are used","warning");let{files:t}=this.getState();if(b(this,Zt)[Zt]().length>0){const n=await b(this,Ut)[Ut]();if(!(this.getFiles().filter(a=>a.progress.uploadStarted==null).length>0))return this.emit("complete",n),n;({files:t}=this.getState())}const i=this.opts.onBeforeUpload(t);return i===!1?Promise.reject(new Error("Not starting the upload because onBeforeUpload returned false")):(i&&typeof i=="object"&&(t=i,this.setState({files:t})),Promise.resolve().then(()=>b(this,J)[J].validateMinNumberOfFiles(t)).catch(n=>{throw b(this,de)[de]([n]),n}).then(()=>{if(!b(this,es)[es](t))throw new ye(this.i18n("missingRequiredMetaField"))}).catch(n=>{throw n}).then(async()=>{const{currentUploads:n}=this.getState(),o=Object.values(n).flatMap(d=>d.fileIDs),a=[];Object.keys(t).forEach(d=>{const c=this.getFile(d);!c.progress.uploadStarted&&o.indexOf(d)===-1&&a.push(c.id)});const l=b(this,$e)[$e](a),u=await b(this,Ne)[Ne](l);return this.emit("complete",u),u}).catch(n=>{throw this.emit("error",n),this.log(n,"error"),n}))}}function tc(r){for(const n of r)n.isRestriction?this.emit("restriction-failed",n.file,n):this.emit("error",n,n.file),this.log(n,"warning");const e=r.filter(n=>n.isUserFacing),t=4,s=e.slice(0,t),i=e.slice(t);s.forEach(n=>{let{message:o,details:a=""}=n;this.info({message:o,details:a},"error",this.opts.infoTimeout)}),i.length>0&&this.info({message:this.i18n("additionalRestrictionsFailed",{count:i.length})})}function rc(r){const{missingFields:e,error:t}=b(this,J)[J].getMissingRequiredMetaFields(r);return e.length>0?(this.setFileState(r.id,{missingRequiredMetaFields:e}),this.log(t.message),this.emit("restriction-failed",r,t),!1):(e.length===0&&r.missingRequiredMetaFields&&this.setFileState(r.id,{missingRequiredMetaFields:[]}),!0)}function sc(r){let e=!0;for(const t of Object.values(r))b(this,ir)[ir](t)||(e=!1);return e}function ic(r){const{allowNewUpload:e}=this.getState();if(e===!1){const t=new ye(this.i18n("noMoreFilesAllowed"),{file:r});throw b(this,de)[de]([t]),t}}function nc(r){const e=r instanceof File?{name:r.name,type:r.type,size:r.size,data:r}:r,t=zn(e),s=Du(t,e),i=qn(s).extension,n=Bu(e,this.getID()),o=e.meta||{};o.name=s,o.type=t;const a=Number.isFinite(e.data.size)?e.data.size:null;return{source:e.source||"",id:n,name:s,extension:i||"",meta:{...this.getState().meta,...o},type:t,data:e.data,progress:{percentage:0,bytesUploaded:!1,bytesTotal:a,uploadComplete:!1,uploadStarted:null},size:a,isGhost:!1,isRemote:e.isRemote||!1,remote:e.remote,preview:e.preview}}function oc(){this.opts.autoProceed&&!this.scheduledAutoProceed&&(this.scheduledAutoProceed=setTimeout(()=>{this.scheduledAutoProceed=null,this.upload().catch(r=>{r.isRestriction||this.log(r.stack||r.message||r)})},4))}function ac(r){const{files:e}=this.getState(),t={...e},s=[],i=[];for(const a of r)try{var n;let l=b(this,Os)[Os](a);const u=(n=e[l.id])==null?void 0:n.isGhost;u&&(l={...e[l.id],isGhost:!1,data:a.data},this.log(`Replaced the blob in the restored ghost file: ${l.name}, ${l.id}`));const d=this.opts.onBeforeFileAdded(l,t);if(!d&&this.checkIfFileAlreadyExists(l.id)){var o;throw new ye(this.i18n("noDuplicates",{fileName:(o=l.name)!=null?o:this.i18n("unnamed")}),{file:a})}if(d===!1&&!u)throw new ye("Cannot add the file because onBeforeFileAdded returned false.",{isUserFacing:!1,file:a});typeof d=="object"&&d!==null&&(l=d),b(this,J)[J].validateSingleFile(l),t[l.id]=l,s.push(l)}catch(l){i.push(l)}try{b(this,J)[J].validateAggregateRestrictions(Object.values(e),s)}catch(a){return i.push(a),{nextFilesState:e,validFilesToAdd:[],errors:i}}return{nextFilesState:t,validFilesToAdd:s,errors:i}}function lc(){const{files:r}=this.getState();return Object.keys(r).filter(e=>r[e].error)}async function uc(){const r=b(this,Zt)[Zt](),e={...this.getState().files};if(r.forEach(s=>{e[s]={...e[s],isPaused:!1,error:null}}),this.setState({files:e,error:null}),this.emit("retry-all",this.getFilesByIds(r)),r.length===0)return{successful:[],failed:[]};const t=b(this,$e)[$e](r,{forceAllowNewUpload:!0});return b(this,Ne)[Ne](t)}function cc(){var r,e;const t=b(this,Us)[Us]();let s=null;t!=null&&(s=Math.round(t*100),s>100?s=100:s<0&&(s=0)),this.emit("progress",(r=s)!=null?r:0),this.setState({totalProgress:(e=s)!=null?e:0})}function dc(){const e=this.getFiles().filter(a=>a.progress.uploadStarted||a.progress.preprocess||a.progress.postprocess);if(e.length===0)return 0;if(e.every(a=>a.progress.uploadComplete))return 1;const t=a=>a.progress.bytesTotal!=null&&a.progress.bytesTotal!==0,s=e.filter(t),i=e.filter(a=>!t(a));if(s.every(a=>a.progress.uploadComplete)&&i.length>0&&!i.every(a=>a.progress.uploadComplete))return null;const n=s.reduce((a,l)=>{var u;return a+((u=l.progress.bytesTotal)!=null?u:0)},0),o=s.reduce((a,l)=>a+(l.progress.bytesUploaded||0),0);return n===0?0:o/n}function pc(){const r=(s,i,n)=>{let o=s.message||"Unknown error";s.details&&(o+=` ${s.details}`),this.setState({error:o}),i!=null&&i.id in this.getState().files&&this.setFileState(i.id,{error:o,response:n})};this.on("error",r),this.on("upload-error",(s,i,n)=>{if(r(i,s,n),typeof i=="object"&&i.message){var o;this.log(i.message,"error");const a=new Error(this.i18n("failedToUpload",{file:(o=s==null?void 0:s.name)!=null?o:""}));a.isUserFacing=!0,a.details=i.message,i.details&&(a.details+=` ${i.details}`),b(this,de)[de]([a])}else b(this,de)[de]([i])});let e=null;this.on("upload-stalled",(s,i)=>{const{message:n}=s,o=i.map(a=>a.meta.name).join(", ");e||(this.info({message:n,details:o},"warning",this.opts.infoTimeout),e=setTimeout(()=>{e=null},this.opts.infoTimeout)),this.log(`${n} ${o}`.trim(),"warning")}),this.on("upload",()=>{this.setState({error:null})});const t=s=>{const i=s.filter(o=>{const a=o!=null&&this.getFile(o.id);return a||this.log(`Not setting progress for a file that has been removed: ${o==null?void 0:o.id}`),a}),n=Object.fromEntries(i.map(o=>[o.id,{progress:{uploadStarted:Date.now(),uploadComplete:!1,bytesUploaded:0,bytesTotal:o.size}}]));this.patchFilesState(n)};this.on("upload-start",t),this.on("upload-progress",b(this,As)[As]),this.on("upload-success",(s,i)=>{if(s==null||!this.getFile(s.id)){this.log(`Not setting progress for a file that has been removed: ${s==null?void 0:s.id}`);return}const n=this.getFile(s.id).progress;this.setFileState(s.id,{progress:{...n,postprocess:b(this,Ie)[Ie].size>0?{mode:"indeterminate"}:void 0,uploadComplete:!0,percentage:100,bytesUploaded:n.bytesTotal},response:i,uploadURL:i.uploadURL,isPaused:!1}),s.size==null&&this.setFileState(s.id,{size:i.bytesUploaded||n.bytesTotal}),b(this,De)[De]()}),this.on("preprocess-progress",(s,i)=>{if(s==null||!this.getFile(s.id)){this.log(`Not setting progress for a file that has been removed: ${s==null?void 0:s.id}`);return}this.setFileState(s.id,{progress:{...this.getFile(s.id).progress,preprocess:i}})}),this.on("preprocess-complete",s=>{if(s==null||!this.getFile(s.id)){this.log(`Not setting progress for a file that has been removed: ${s==null?void 0:s.id}`);return}const i={...this.getState().files};i[s.id]={...i[s.id],progress:{...i[s.id].progress}},delete i[s.id].progress.preprocess,this.setState({files:i})}),this.on("postprocess-progress",(s,i)=>{if(s==null||!this.getFile(s.id)){this.log(`Not setting progress for a file that has been removed: ${s==null?void 0:s.id}`);return}this.setFileState(s.id,{progress:{...this.getState().files[s.id].progress,postprocess:i}})}),this.on("postprocess-complete",s=>{if(s==null||!this.getFile(s.id)){this.log(`Not setting progress for a file that has been removed: ${s==null?void 0:s.id}`);return}const i={...this.getState().files};i[s.id]={...i[s.id],progress:{...i[s.id].progress}},delete i[s.id].progress.postprocess,this.setState({files:i})}),this.on("restored",()=>{b(this,De)[De]()}),this.on("dashboard:file-edit-complete",s=>{s&&b(this,ir)[ir](s)}),typeof window<"u"&&window.addEventListener&&(window.addEventListener("online",b(this,be)[be]),window.addEventListener("offline",b(this,be)[be]),setTimeout(b(this,be)[be],3e3))}function hc(r,e){e===void 0&&(e={});const{forceAllowNewUpload:t=!1}=e,{allowNewUpload:s,currentUploads:i}=this.getState();if(!s&&!t)throw new Error("Cannot create a new upload: already uploading.");const n=Cl();return this.emit("upload",n,this.getFilesByIds(r)),this.setState({allowNewUpload:this.opts.allowMultipleUploadBatches!==!1&&this.opts.allowMultipleUploads!==!1,currentUploads:{...i,[n]:{fileIDs:r,step:0,result:{}}}}),n}function fc(r){const{currentUploads:e}=this.getState();return e[r]}function mc(r){const e={...this.getState().currentUploads};delete e[r],this.setState({currentUploads:e})}async function gc(r){const e=()=>{const{currentUploads:n}=this.getState();return n[r]};let t=e();const s=[...b(this,rt)[rt],...b(this,st)[st],...b(this,Ie)[Ie]];try{for(let n=t.step||0;n<s.length&&t;n++){const o=s[n];this.setState({currentUploads:{...this.getState().currentUploads,[r]:{...t,step:n}}});const{fileIDs:a}=t;await o(a,r),t=e()}}catch(n){throw b(this,dt)[dt](r),n}if(t){t.fileIDs.forEach(l=>{const u=this.getFile(l);u&&u.progress.postprocess&&this.emit("postprocess-complete",u)});const n=t.fileIDs.map(l=>this.getFile(l)),o=n.filter(l=>!l.error),a=n.filter(l=>l.error);this.addResultData(r,{successful:o,failed:a,uploadID:r}),t=e()}let i;return t&&(i=t.result,b(this,dt)[dt](r)),i==null&&(this.log(`Not setting result for an upload that has been removed: ${r}`),i={successful:[],failed:[],uploadID:r}),i}qr.VERSION=ec.version;const Js=qr;var zr,x,Wn,it,Ri,Vn,Gn,Jn,Ks,Rs,xs,nr={},Kn=[],yc=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,lr=Array.isArray;function ze(r,e){for(var t in e)r[t]=e[t];return r}function Xs(r){r&&r.parentNode&&r.parentNode.removeChild(r)}function w(r,e,t){var s,i,n,o={};for(n in e)n=="key"?s=e[n]:n=="ref"?i=e[n]:o[n]=e[n];if(arguments.length>2&&(o.children=arguments.length>3?zr.call(arguments,2):t),typeof r=="function"&&r.defaultProps!=null)for(n in r.defaultProps)o[n]===void 0&&(o[n]=r.defaultProps[n]);return Pr(r,o,s,i,null)}function Pr(r,e,t,s,i){var n={type:r,props:e,key:t,ref:s,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i??++Wn,__i:-1,__u:0};return i==null&&x.vnode!=null&&x.vnode(n),n}function yt(r){return r.children}function He(r,e){this.props=r,this.context=e}function vt(r,e){if(e==null)return r.__?vt(r.__,r.__i+1):null;for(var t;e<r.__k.length;e++)if((t=r.__k[e])!=null&&t.__e!=null)return t.__e;return typeof r.type=="function"?vt(r):null}function Xn(r){var e,t;if((r=r.__)!=null&&r.__c!=null){for(r.__e=r.__c.base=null,e=0;e<r.__k.length;e++)if((t=r.__k[e])!=null&&t.__e!=null){r.__e=r.__c.base=t.__e;break}return Xn(r)}}function xi(r){(!r.__d&&(r.__d=!0)&&it.push(r)&&!Ar.__r++||Ri!=x.debounceRendering)&&((Ri=x.debounceRendering)||Vn)(Ar)}function Ar(){for(var r,e,t,s,i,n,o,a=1;it.length;)it.length>a&&it.sort(Gn),r=it.shift(),a=it.length,r.__d&&(t=void 0,i=(s=(e=r).__v).__e,n=[],o=[],e.__P&&((t=ze({},s)).__v=s.__v+1,x.vnode&&x.vnode(t),Qs(e.__P,t,s,e.__n,e.__P.namespaceURI,32&s.__u?[i]:null,n,i??vt(s),!!(32&s.__u),o),t.__v=s.__v,t.__.__k[t.__i]=t,Zn(n,t,o),t.__e!=i&&Xn(t)));Ar.__r=0}function Qn(r,e,t,s,i,n,o,a,l,u,d){var c,p,h,f,m,y,v=s&&s.__k||Kn,_=e.length;for(l=vc(t,e,v,l,_),c=0;c<_;c++)(h=t.__k[c])!=null&&(p=h.__i==-1?nr:v[h.__i]||nr,h.__i=c,y=Qs(r,h,p,i,n,o,a,l,u,d),f=h.__e,h.ref&&p.ref!=h.ref&&(p.ref&&Ys(p.ref,null,h),d.push(h.ref,h.__c||f,h)),m==null&&f!=null&&(m=f),4&h.__u||p.__k===h.__k?l=Yn(h,l,r):typeof h.type=="function"&&y!==void 0?l=y:f&&(l=f.nextSibling),h.__u&=-7);return t.__e=m,l}function vc(r,e,t,s,i){var n,o,a,l,u,d=t.length,c=d,p=0;for(r.__k=new Array(i),n=0;n<i;n++)(o=e[n])!=null&&typeof o!="boolean"&&typeof o!="function"?(l=n+p,(o=r.__k[n]=typeof o=="string"||typeof o=="number"||typeof o=="bigint"||o.constructor==String?Pr(null,o,null,null,null):lr(o)?Pr(yt,{children:o},null,null,null):o.constructor==null&&o.__b>0?Pr(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o).__=r,o.__b=r.__b+1,a=null,(u=o.__i=bc(o,t,l,c))!=-1&&(c--,(a=t[u])&&(a.__u|=2)),a==null||a.__v==null?(u==-1&&(i>d?p--:i<d&&p++),typeof o.type!="function"&&(o.__u|=4)):u!=l&&(u==l-1?p--:u==l+1?p++:(u>l?p--:p++,o.__u|=4))):r.__k[n]=null;if(c)for(n=0;n<d;n++)(a=t[n])!=null&&!(2&a.__u)&&(a.__e==s&&(s=vt(a)),to(a,a));return s}function Yn(r,e,t){var s,i;if(typeof r.type=="function"){for(s=r.__k,i=0;s&&i<s.length;i++)s[i]&&(s[i].__=r,e=Yn(s[i],e,t));return e}r.__e!=e&&(e&&r.type&&!t.contains(e)&&(e=vt(r)),t.insertBefore(r.__e,e||null),e=r.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function Ur(r,e){return e=e||[],r==null||typeof r=="boolean"||(lr(r)?r.some(function(t){Ur(t,e)}):e.push(r)),e}function bc(r,e,t,s){var i,n,o=r.key,a=r.type,l=e[t];if(l===null&&r.key==null||l&&o==l.key&&a==l.type&&!(2&l.__u))return t;if(s>(l!=null&&!(2&l.__u)?1:0))for(i=t-1,n=t+1;i>=0||n<e.length;){if(i>=0){if((l=e[i])&&!(2&l.__u)&&o==l.key&&a==l.type)return i;i--}if(n<e.length){if((l=e[n])&&!(2&l.__u)&&o==l.key&&a==l.type)return n;n++}}return-1}function Mi(r,e,t){e[0]=="-"?r.setProperty(e,t??""):r[e]=t==null?"":typeof t!="number"||yc.test(e)?t:t+"px"}function fr(r,e,t,s,i){var n,o;e:if(e=="style")if(typeof t=="string")r.style.cssText=t;else{if(typeof s=="string"&&(r.style.cssText=s=""),s)for(e in s)t&&e in t||Mi(r.style,e,"");if(t)for(e in t)s&&t[e]==s[e]||Mi(r.style,e,t[e])}else if(e[0]=="o"&&e[1]=="n")n=e!=(e=e.replace(Jn,"$1")),o=e.toLowerCase(),e=o in r||e=="onFocusOut"||e=="onFocusIn"?o.slice(2):e.slice(2),r.l||(r.l={}),r.l[e+n]=t,t?s?t.u=s.u:(t.u=Ks,r.addEventListener(e,n?xs:Rs,n)):r.removeEventListener(e,n?xs:Rs,n);else{if(i=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in r)try{r[e]=t??"";break e}catch{}typeof t=="function"||(t==null||t===!1&&e[4]!="-"?r.removeAttribute(e):r.setAttribute(e,e=="popover"&&t==1?"":t))}}function $i(r){return function(e){if(this.l){var t=this.l[e.type+r];if(e.t==null)e.t=Ks++;else if(e.t<t.u)return;return t(x.event?x.event(e):e)}}}function Qs(r,e,t,s,i,n,o,a,l,u){var d,c,p,h,f,m,y,v,_,A,k,P,E,T,U,M,B,$=e.type;if(e.constructor!=null)return null;128&t.__u&&(l=!!(32&t.__u),n=[a=e.__e=t.__e]),(d=x.__b)&&d(e);e:if(typeof $=="function")try{if(v=e.props,_="prototype"in $&&$.prototype.render,A=(d=$.contextType)&&s[d.__c],k=d?A?A.props.value:d.__:s,t.__c?y=(c=e.__c=t.__c).__=c.__E:(_?e.__c=c=new $(v,k):(e.__c=c=new He(v,k),c.constructor=$,c.render=_c),A&&A.sub(c),c.props=v,c.state||(c.state={}),c.context=k,c.__n=s,p=c.__d=!0,c.__h=[],c._sb=[]),_&&c.__s==null&&(c.__s=c.state),_&&$.getDerivedStateFromProps!=null&&(c.__s==c.state&&(c.__s=ze({},c.__s)),ze(c.__s,$.getDerivedStateFromProps(v,c.__s))),h=c.props,f=c.state,c.__v=e,p)_&&$.getDerivedStateFromProps==null&&c.componentWillMount!=null&&c.componentWillMount(),_&&c.componentDidMount!=null&&c.__h.push(c.componentDidMount);else{if(_&&$.getDerivedStateFromProps==null&&v!==h&&c.componentWillReceiveProps!=null&&c.componentWillReceiveProps(v,k),!c.__e&&c.shouldComponentUpdate!=null&&c.shouldComponentUpdate(v,c.__s,k)===!1||e.__v==t.__v){for(e.__v!=t.__v&&(c.props=v,c.state=c.__s,c.__d=!1),e.__e=t.__e,e.__k=t.__k,e.__k.some(function(D){D&&(D.__=e)}),P=0;P<c._sb.length;P++)c.__h.push(c._sb[P]);c._sb=[],c.__h.length&&o.push(c);break e}c.componentWillUpdate!=null&&c.componentWillUpdate(v,c.__s,k),_&&c.componentDidUpdate!=null&&c.__h.push(function(){c.componentDidUpdate(h,f,m)})}if(c.context=k,c.props=v,c.__P=r,c.__e=!1,E=x.__r,T=0,_){for(c.state=c.__s,c.__d=!1,E&&E(e),d=c.render(c.props,c.state,c.context),U=0;U<c._sb.length;U++)c.__h.push(c._sb[U]);c._sb=[]}else do c.__d=!1,E&&E(e),d=c.render(c.props,c.state,c.context),c.state=c.__s;while(c.__d&&++T<25);c.state=c.__s,c.getChildContext!=null&&(s=ze(ze({},s),c.getChildContext())),_&&!p&&c.getSnapshotBeforeUpdate!=null&&(m=c.getSnapshotBeforeUpdate(h,f)),M=d,d!=null&&d.type===yt&&d.key==null&&(M=eo(d.props.children)),a=Qn(r,lr(M)?M:[M],e,t,s,i,n,o,a,l,u),c.base=e.__e,e.__u&=-161,c.__h.length&&o.push(c),y&&(c.__E=c.__=null)}catch(D){if(e.__v=null,l||n!=null)if(D.then){for(e.__u|=l?160:128;a&&a.nodeType==8&&a.nextSibling;)a=a.nextSibling;n[n.indexOf(a)]=null,e.__e=a}else for(B=n.length;B--;)Xs(n[B]);else e.__e=t.__e,e.__k=t.__k;x.__e(D,e,t)}else n==null&&e.__v==t.__v?(e.__k=t.__k,e.__e=t.__e):a=e.__e=wc(t.__e,e,t,s,i,n,o,l,u);return(d=x.diffed)&&d(e),128&e.__u?void 0:a}function Zn(r,e,t){for(var s=0;s<t.length;s++)Ys(t[s],t[++s],t[++s]);x.__c&&x.__c(e,r),r.some(function(i){try{r=i.__h,i.__h=[],r.some(function(n){n.call(i)})}catch(n){x.__e(n,i.__v)}})}function eo(r){return typeof r!="object"||r==null||r.__b&&r.__b>0?r:lr(r)?r.map(eo):ze({},r)}function wc(r,e,t,s,i,n,o,a,l){var u,d,c,p,h,f,m,y=t.props,v=e.props,_=e.type;if(_=="svg"?i="http://www.w3.org/2000/svg":_=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),n!=null){for(u=0;u<n.length;u++)if((h=n[u])&&"setAttribute"in h==!!_&&(_?h.localName==_:h.nodeType==3)){r=h,n[u]=null;break}}if(r==null){if(_==null)return document.createTextNode(v);r=document.createElementNS(i,_,v.is&&v),a&&(x.__m&&x.__m(e,n),a=!1),n=null}if(_==null)y===v||a&&r.data==v||(r.data=v);else{if(n=n&&zr.call(r.childNodes),y=t.props||nr,!a&&n!=null)for(y={},u=0;u<r.attributes.length;u++)y[(h=r.attributes[u]).name]=h.value;for(u in y)if(h=y[u],u!="children"){if(u=="dangerouslySetInnerHTML")c=h;else if(!(u in v)){if(u=="value"&&"defaultValue"in v||u=="checked"&&"defaultChecked"in v)continue;fr(r,u,null,h,i)}}for(u in v)h=v[u],u=="children"?p=h:u=="dangerouslySetInnerHTML"?d=h:u=="value"?f=h:u=="checked"?m=h:a&&typeof h!="function"||y[u]===h||fr(r,u,h,y[u],i);if(d)a||c&&(d.__html==c.__html||d.__html==r.innerHTML)||(r.innerHTML=d.__html),e.__k=[];else if(c&&(r.innerHTML=""),Qn(e.type=="template"?r.content:r,lr(p)?p:[p],e,t,s,_=="foreignObject"?"http://www.w3.org/1999/xhtml":i,n,o,n?n[0]:t.__k&&vt(t,0),a,l),n!=null)for(u=n.length;u--;)Xs(n[u]);a||(u="value",_=="progress"&&f==null?r.removeAttribute("value"):f!=null&&(f!==r[u]||_=="progress"&&!f||_=="option"&&f!=y[u])&&fr(r,u,f,y[u],i),u="checked",m!=null&&m!=r[u]&&fr(r,u,m,y[u],i))}return r}function Ys(r,e,t){try{if(typeof r=="function"){var s=typeof r.__u=="function";s&&r.__u(),s&&e==null||(r.__u=r(e))}else r.current=e}catch(i){x.__e(i,t)}}function to(r,e,t){var s,i;if(x.unmount&&x.unmount(r),(s=r.ref)&&(s.current&&s.current!=r.__e||Ys(s,null,e)),(s=r.__c)!=null){if(s.componentWillUnmount)try{s.componentWillUnmount()}catch(n){x.__e(n,e)}s.base=s.__P=null}if(s=r.__k)for(i=0;i<s.length;i++)s[i]&&to(s[i],e,t||typeof r.type!="function");t||Xs(r.__e),r.__c=r.__=r.__e=void 0}function _c(r,e,t){return this.constructor(r,t)}function Sc(r,e,t){var s,i,n,o;e==document&&(e=document.documentElement),x.__&&x.__(r,e),i=(s=typeof t=="function")?null:t&&t.__k||e.__k,n=[],o=[],Qs(e,r=(!s&&t||e).__k=w(yt,null,[r]),i||nr,nr,e.namespaceURI,!s&&t?[t]:i?null:e.firstChild?zr.call(e.childNodes):null,n,!s&&t?t:i?i.__e:e.firstChild,s,o),Zn(n,r,o)}zr=Kn.slice,x={__e:function(r,e,t,s){for(var i,n,o;e=e.__;)if((i=e.__c)&&!i.__)try{if((n=i.constructor)&&n.getDerivedStateFromError!=null&&(i.setState(n.getDerivedStateFromError(r)),o=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(r,s||{}),o=i.__d),o)return i.__E=i}catch(a){r=a}throw r}},Wn=0,He.prototype.setState=function(r,e){var t;t=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=ze({},this.state),typeof r=="function"&&(r=r(ze({},t),this.props)),r&&ze(t,r),r!=null&&this.__v&&(e&&this._sb.push(e),xi(this))},He.prototype.forceUpdate=function(r){this.__v&&(this.__e=!0,r&&this.__h.push(r),xi(this))},He.prototype.render=yt,it=[],Vn=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Gn=function(r,e){return r.__v.__b-e.__v.__b},Ar.__r=0,Jn=/(PointerCapture)$|Capture$/i,Ks=0,Rs=$i(!1),xs=$i(!0);var Te,ss,Ni,ro=[],X=x,Li=X.__b,ji=X.__r,Bi=X.diffed,Ii=X.__c,Di=X.unmount,qi=X.__;function Pc(){for(var r;r=ro.shift();)if(r.__P&&r.__H)try{r.__H.__h.forEach(Er),r.__H.__h.forEach(Ms),r.__H.__h=[]}catch(e){r.__H.__h=[],X.__e(e,r.__v)}}X.__b=function(r){Te=null,Li&&Li(r)},X.__=function(r,e){r&&e.__k&&e.__k.__m&&(r.__m=e.__k.__m),qi&&qi(r,e)},X.__r=function(r){ji&&ji(r);var e=(Te=r.__c).__H;e&&(ss===Te?(e.__h=[],Te.__h=[],e.__.forEach(function(t){t.__N&&(t.__=t.__N),t.u=t.__N=void 0})):(e.__h.forEach(Er),e.__h.forEach(Ms),e.__h=[])),ss=Te},X.diffed=function(r){Bi&&Bi(r);var e=r.__c;e&&e.__H&&(e.__H.__h.length&&(ro.push(e)!==1&&Ni===X.requestAnimationFrame||((Ni=X.requestAnimationFrame)||Ec)(Pc)),e.__H.__.forEach(function(t){t.u&&(t.__H=t.u),t.u=void 0})),ss=Te=null},X.__c=function(r,e){e.some(function(t){try{t.__h.forEach(Er),t.__h=t.__h.filter(function(s){return!s.__||Ms(s)})}catch(s){e.some(function(i){i.__h&&(i.__h=[])}),e=[],X.__e(s,t.__v)}}),Ii&&Ii(r,e)},X.unmount=function(r){Di&&Di(r);var e,t=r.__c;t&&t.__H&&(t.__H.__.forEach(function(s){try{Er(s)}catch(i){e=i}}),t.__H=void 0,e&&X.__e(e,t.__v))};var zi=typeof requestAnimationFrame=="function";function Ec(r){var e,t=function(){clearTimeout(s),zi&&cancelAnimationFrame(e),setTimeout(r)},s=setTimeout(t,35);zi&&(e=requestAnimationFrame(t))}function Er(r){var e=Te,t=r.__c;typeof t=="function"&&(r.__c=void 0,t()),Te=e}function Ms(r){var e=Te;r.__c=r.__(),Te=e}function Tc(r,e){for(var t in e)r[t]=e[t];return r}function Hi(r,e){for(var t in r)if(t!=="__source"&&!(t in e))return!0;for(var s in e)if(s!=="__source"&&r[s]!==e[s])return!0;return!1}function Wi(r,e){this.props=r,this.context=e}(Wi.prototype=new He).isPureReactComponent=!0,Wi.prototype.shouldComponentUpdate=function(r,e){return Hi(this.props,r)||Hi(this.state,e)};var Vi=x.__b;x.__b=function(r){r.type&&r.type.__f&&r.ref&&(r.props.ref=r.ref,r.ref=null),Vi&&Vi(r)};var kc=x.__e;x.__e=function(r,e,t,s){if(r.then){for(var i,n=e;n=n.__;)if((i=n.__c)&&i.__c)return e.__e==null&&(e.__e=t.__e,e.__k=t.__k),i.__c(r,e)}kc(r,e,t,s)};var Gi=x.unmount;function so(r,e,t){return r&&(r.__c&&r.__c.__H&&(r.__c.__H.__.forEach(function(s){typeof s.__c=="function"&&s.__c()}),r.__c.__H=null),(r=Tc({},r)).__c!=null&&(r.__c.__P===t&&(r.__c.__P=e),r.__c.__e=!0,r.__c=null),r.__k=r.__k&&r.__k.map(function(s){return so(s,e,t)})),r}function io(r,e,t){return r&&t&&(r.__v=null,r.__k=r.__k&&r.__k.map(function(s){return io(s,e,t)}),r.__c&&r.__c.__P===e&&(r.__e&&t.appendChild(r.__e),r.__c.__e=!0,r.__c.__P=t)),r}function is(){this.__u=0,this.o=null,this.__b=null}function no(r){var e=r.__.__c;return e&&e.__a&&e.__a(r)}function mr(){this.i=null,this.l=null}x.unmount=function(r){var e=r.__c;e&&e.__R&&e.__R(),e&&32&r.__u&&(r.type=null),Gi&&Gi(r)},(is.prototype=new He).__c=function(r,e){var t=e.__c,s=this;s.o==null&&(s.o=[]),s.o.push(t);var i=no(s.__v),n=!1,o=function(){n||(n=!0,t.__R=null,i?i(a):a())};t.__R=o;var a=function(){if(!--s.__u){if(s.state.__a){var l=s.state.__a;s.__v.__k[0]=io(l,l.__c.__P,l.__c.__O)}var u;for(s.setState({__a:s.__b=null});u=s.o.pop();)u.forceUpdate()}};s.__u++||32&e.__u||s.setState({__a:s.__b=s.__v.__k[0]}),r.then(o,o)},is.prototype.componentWillUnmount=function(){this.o=[]},is.prototype.render=function(r,e){if(this.__b){if(this.__v.__k){var t=document.createElement("div"),s=this.__v.__k[0].__c;this.__v.__k[0]=so(this.__b,t,s.__O=s.__P)}this.__b=null}var i=e.__a&&w(yt,null,r.fallback);return i&&(i.__u&=-33),[w(yt,null,e.__a?null:r.children),i]};var Ji=function(r,e,t){if(++t[1]===t[0]&&r.l.delete(e),r.props.revealOrder&&(r.props.revealOrder[0]!=="t"||!r.l.size))for(t=r.i;t;){for(;t.length>3;)t.pop()();if(t[1]<t[0])break;r.i=t=t[2]}};(mr.prototype=new He).__a=function(r){var e=this,t=no(e.__v),s=e.l.get(r);return s[0]++,function(i){var n=function(){e.props.revealOrder?(s.push(i),Ji(e,r,s)):i()};t?t(n):n()}},mr.prototype.render=function(r){this.i=null,this.l=new Map;var e=Ur(r.children);r.revealOrder&&r.revealOrder[0]==="b"&&e.reverse();for(var t=e.length;t--;)this.l.set(e[t],this.i=[1,0,this.i]);return r.children},mr.prototype.componentDidUpdate=mr.prototype.componentDidMount=function(){var r=this;this.l.forEach(function(e,t){Ji(r,t,e)})};var Cc=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,Fc=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Oc=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,Ac=/[A-Z0-9]/g,Uc=typeof document<"u",Rc=function(r){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(r)};function Ki(r,e,t){return e.__k==null&&(e.textContent=""),Sc(r,e),typeof t=="function"&&t(),r?r.__c:null}He.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(r){Object.defineProperty(He.prototype,r,{configurable:!0,get:function(){return this["UNSAFE_"+r]},set:function(e){Object.defineProperty(this,r,{configurable:!0,writable:!0,value:e})}})});var Xi=x.event;function xc(){}function Mc(){return this.cancelBubble}function $c(){return this.defaultPrevented}x.event=function(r){return Xi&&(r=Xi(r)),r.persist=xc,r.isPropagationStopped=Mc,r.isDefaultPrevented=$c,r.nativeEvent=r};var Nc={enumerable:!1,configurable:!0,get:function(){return this.class}},Qi=x.vnode;x.vnode=function(r){typeof r.type=="string"&&function(e){var t=e.props,s=e.type,i={},n=s.indexOf("-")===-1;for(var o in t){var a=t[o];if(!(o==="value"&&"defaultValue"in t&&a==null||Uc&&o==="children"&&s==="noscript"||o==="class"||o==="className")){var l=o.toLowerCase();o==="defaultValue"&&"value"in t&&t.value==null?o="value":o==="download"&&a===!0?a="":l==="translate"&&a==="no"?a=!1:l[0]==="o"&&l[1]==="n"?l==="ondoubleclick"?o="ondblclick":l!=="onchange"||s!=="input"&&s!=="textarea"||Rc(t.type)?l==="onfocus"?o="onfocusin":l==="onblur"?o="onfocusout":Oc.test(o)&&(o=l):l=o="oninput":n&&Fc.test(o)?o=o.replace(Ac,"-$&").toLowerCase():a===null&&(a=void 0),l==="oninput"&&i[o=l]&&(o="oninputCapture"),i[o]=a}}s=="select"&&i.multiple&&Array.isArray(i.value)&&(i.value=Ur(t.children).forEach(function(u){u.props.selected=i.value.indexOf(u.props.value)!=-1})),s=="select"&&i.defaultValue!=null&&(i.value=Ur(t.children).forEach(function(u){u.props.selected=i.multiple?i.defaultValue.indexOf(u.props.value)!=-1:i.defaultValue==u.props.value})),t.class&&!t.className?(i.class=t.class,Object.defineProperty(i,"className",Nc)):(t.className&&!t.class||t.class&&t.className)&&(i.class=i.className=t.className),e.props=i}(r),r.$$typeof=Cc,Qi&&Qi(r)};var Yi=x.__r;x.__r=function(r){Yi&&Yi(r),r.__c};var Zi=x.diffed;x.diffed=function(r){Zi&&Zi(r);var e=r.props,t=r.__e;t!=null&&r.type==="textarea"&&"value"in e&&e.value!==t.value&&(t.value=e.value==null?"":e.value)};function Lc(r){return typeof r!="object"||r===null||!("nodeType"in r)?!1:r.nodeType===Node.ELEMENT_NODE}function jc(r,e){return e===void 0&&(e=document),typeof r=="string"?e.querySelector(r):Lc(r)?r:null}function oo(r){for(var e;r&&!r.dir;)r=r.parentNode;return(e=r)==null?void 0:e.dir}class ao{constructor(e,t){this.uppy=e,this.opts=t??{}}getPluginState(){const{plugins:e}=this.uppy.getState();return(e==null?void 0:e[this.id])||{}}setPluginState(e){const{plugins:t}=this.uppy.getState();this.uppy.setState({plugins:{...t,[this.id]:{...t[this.id],...e}}})}setOptions(e){this.opts={...this.opts,...e},this.setPluginState(void 0),this.i18nInit()}i18nInit(){const e=new Nn([this.defaultLocale,this.uppy.locale,this.opts.locale]);this.i18n=e.translate.bind(e),this.i18nArray=e.translateArray.bind(e),this.setPluginState(void 0)}addTarget(e){throw new Error("Extend the addTarget method to add your plugin to another plugin's target")}install(){}uninstall(){}update(e){}afterUpdate(){}}function en(r,e){if(!{}.hasOwnProperty.call(r,e))throw new TypeError("attempted to use private field on non-instance");return r}var Bc=0;function Ic(r){return"__private_"+Bc+++"_"+r}function Dc(r){let e=null,t;return function(){for(var s=arguments.length,i=new Array(s),n=0;n<s;n++)i[n]=arguments[n];return t=i,e||(e=Promise.resolve().then(()=>(e=null,r(...t)))),e}}var Mt=Ic("updateUI");class Rr extends ao{constructor(){super(...arguments),Object.defineProperty(this,Mt,{writable:!0,value:void 0})}getTargetPlugin(e){let t;if(typeof(e==null?void 0:e.addTarget)=="function")t=e,t instanceof Rr||console.warn(new Error("The provided plugin is not an instance of UIPlugin. This is an indication of a bug with the way Uppy is bundled.",{cause:{targetPlugin:t,UIPlugin:Rr}}));else if(typeof e=="function"){const s=e;this.uppy.iteratePlugins(i=>{i instanceof s&&(t=i)})}return t}mount(e,t){const s=t.id,i=jc(e);if(i){this.isTargetDOMEl=!0;const a=document.createElement("div");return a.classList.add("uppy-Root"),en(this,Mt)[Mt]=Dc(l=>{this.uppy.getPlugin(this.id)&&(Ki(this.render(l,a),a),this.afterUpdate())}),this.uppy.log(`Installing ${s} to a DOM element '${e}'`),this.opts.replaceTargetContent&&(i.innerHTML=""),Ki(this.render(this.uppy.getState(),a),a),this.el=a,i.appendChild(a),a.dir=this.opts.direction||oo(a)||"ltr",this.onMount(),this.el}const n=this.getTargetPlugin(e);if(n)return this.uppy.log(`Installing ${s} to ${n.id}`),this.parent=n,this.el=n.addTarget(t),this.onMount(),this.el;this.uppy.log(`Not installing ${s}`);let o=`Invalid target option given to ${s}.`;throw typeof e=="function"?o+=" The given target is not a Plugin class. Please check that you're not specifying a React Component instead of a plugin. If you are using @uppy/* packages directly, make sure you have only 1 version of @uppy/core installed: run `npm ls @uppy/core` on the command line and verify that all the versions match and are deduped correctly.":o+="If you meant to target an HTML element, please make sure that the element exists. Check that the <script> tag initializing Uppy is right before the closing </body> tag at the end of the page. (see https://github.com/transloadit/uppy/issues/1042)\n\nIf you meant to target a plugin, please confirm that your `import` statements or `require` calls are correct.",new Error(o)}render(e,t){throw new Error("Extend the render method to add your plugin to a DOM element")}update(e){if(this.el!=null){var t,s;(t=(s=en(this,Mt))[Mt])==null||t.call(s,e)}}unmount(){if(this.isTargetDOMEl){var e;(e=this.el)==null||e.remove()}this.onUnmount()}onMount(){}onUnmount(){}}const Hr=Rr,Zs=Array.from;function qc(){const r=document.body;return!(!("draggable"in r)||!("ondragstart"in r&&"ondrop"in r)||!("FormData"in window)||!("FileReader"in window))}function lo(r,e,t,s){let{onSuccess:i}=s;r.readEntries(n=>{const o=[...e,...n];n.length?queueMicrotask(()=>{lo(r,o,t,{onSuccess:i})}):i(o)},n=>{t(n),i(e)})}function uo(r,e){return r==null?r:{kind:r.isFile?"file":r.isDirectory?"directory":void 0,name:r.name,getFile(){return new Promise((t,s)=>r.file(t,s))},async*values(){const t=r.createReader();yield*await new Promise(i=>{lo(t,[],e,{onSuccess:n=>i(n.map(o=>uo(o,e)))})})},isSameEntry:void 0}}function co(r,e,t){try{return t===void 0&&(t=void 0),async function*(){const s=()=>`${e}/${r.name}`;if(r.kind==="file"){const i=await r.getFile();i!=null?(i.relativePath=e?s():null,yield i):t!=null&&(yield t)}else if(r.kind==="directory")for await(const i of r.values())yield*co(i,e?s():r.name);else t!=null&&(yield t)}()}catch(s){return Promise.reject(s)}}async function*zc(r,e){const t=await Promise.all(Array.from(r.items,async s=>{let i;return i??(i=uo((()=>typeof s.getAsEntry=="function"?s.getAsEntry():s.webkitGetAsEntry())(),e)),{fileSystemHandle:i,lastResortFile:s.getAsFile()}}));for(const{lastResortFile:s,fileSystemHandle:i}of t)if(i!=null)try{yield*co(i,"",s)}catch(n){s!=null?yield s:e(n)}else s!=null&&(yield s)}function Hc(r){const e=Zs(r.files);return Promise.resolve(e)}async function Wc(r,e){var t;const s=(t=e==null?void 0:e.logDropError)!=null?t:Function.prototype;try{const i=[];for await(const n of zc(r,s))i.push(n);return i}catch{return Hc(r)}}const Vc={strings:{dropHereOr:"Drop here or %{browse}",browse:"browse"}},Gc={version:"4.1.3"},Jc={inputName:"files[]",width:"100%",height:"100%"};class Wr extends Hr{constructor(e,t){super(e,{...Jc,...t}),this.isDragDropSupported=qc(),this.addFiles=s=>{const i=s.map(n=>({source:this.id,name:n.name,type:n.type,data:n,meta:{relativePath:n.relativePath||null}}));try{this.uppy.addFiles(i)}catch(n){this.uppy.log(n)}},this.onInputChange=s=>{const i=Zs(s.currentTarget.files||[]);i.length>0&&(this.uppy.log("[DragDrop] Files selected through input"),this.addFiles(i)),s.currentTarget.value=""},this.handleDragOver=s=>{var i,n;s.preventDefault(),s.stopPropagation();const{types:o}=s.dataTransfer,a=o.some(u=>u==="Files"),{allowNewUpload:l}=this.uppy.getState();if(!a||!l){s.dataTransfer.dropEffect="none";return}s.dataTransfer.dropEffect="copy",this.setPluginState({isDraggingOver:!0}),(i=(n=this.opts).onDragOver)==null||i.call(n,s)},this.handleDragLeave=s=>{var i,n;s.preventDefault(),s.stopPropagation(),this.setPluginState({isDraggingOver:!1}),(i=(n=this.opts).onDragLeave)==null||i.call(n,s)},this.handleDrop=async s=>{var i,n;s.preventDefault(),s.stopPropagation(),this.setPluginState({isDraggingOver:!1});const o=l=>{this.uppy.log(l,"error")},a=await Wc(s.dataTransfer,{logDropError:o});a.length>0&&(this.uppy.log("[DragDrop] Files dropped"),this.addFiles(a)),(i=(n=this.opts).onDrop)==null||i.call(n,s)},this.type="acquirer",this.id=this.opts.id||"DragDrop",this.title="Drag & Drop",this.defaultLocale=Vc,this.i18nInit()}renderHiddenFileInput(){var e;const{restrictions:t}=this.uppy.opts;return w("input",{className:"uppy-DragDrop-input",type:"file",hidden:!0,ref:s=>{this.fileInputRef=s},name:this.opts.inputName,multiple:t.maxNumberOfFiles!==1,accept:(e=t.allowedFileTypes)==null?void 0:e.join(", "),onChange:this.onInputChange})}static renderArrowSvg(){return w("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-DragDrop-arrow",width:"16",height:"16",viewBox:"0 0 16 16"},w("path",{d:"M11 10V0H5v10H2l6 6 6-6h-3zm0 0",fillRule:"evenodd"}))}renderLabel(){return w("div",{className:"uppy-DragDrop-label"},this.i18nArray("dropHereOr",{browse:w("span",{className:"uppy-DragDrop-browse"},this.i18n("browse"))}))}renderNote(){return w("span",{className:"uppy-DragDrop-note"},this.opts.note)}render(){const e=`uppy-u-reset
      uppy-DragDrop-container
      ${this.isDragDropSupported?"uppy-DragDrop--isDragDropSupported":""}
      ${this.getPluginState().isDraggingOver?"uppy-DragDrop--isDraggingOver":""}
    `,t={width:this.opts.width,height:this.opts.height};return w("button",{type:"button",className:e,style:t,onClick:()=>this.fileInputRef.click(),onDragOver:this.handleDragOver,onDragLeave:this.handleDragLeave,onDrop:this.handleDrop},this.renderHiddenFileInput(),w("div",{className:"uppy-DragDrop-inner"},Wr.renderArrowSvg(),this.renderLabel(),this.renderNote()))}install(){const{target:e}=this.opts;this.setPluginState({isDraggingOver:!1}),e&&this.mount(e,this)}uninstall(){this.unmount()}}Wr.VERSION=Gc.version;function tn(r,e,t,s){return t===0||r===e?r:s===0?e:r+(e-r)*2**(-s/t)}const Ee={STATE_ERROR:"error",STATE_WAITING:"waiting",STATE_PREPROCESSING:"preprocessing",STATE_UPLOADING:"uploading",STATE_POSTPROCESSING:"postprocessing",STATE_COMPLETE:"complete"};var po={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(r){(function(){var e={}.hasOwnProperty;function t(){for(var n="",o=0;o<arguments.length;o++){var a=arguments[o];a&&(n=i(n,s(a)))}return n}function s(n){if(typeof n=="string"||typeof n=="number")return n;if(typeof n!="object")return"";if(Array.isArray(n))return t.apply(null,n);if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]"))return n.toString();var o="";for(var a in n)e.call(n,a)&&n[a]&&(o=i(o,a));return o}function i(n,o){return o?n?n+" "+o:n+o:n}r.exports?(t.default=t,r.exports=t):window.classNames=t})()})(po);var Kc=po.exports;const xr=_t(Kc);function ns(r){const e=[];let t="indeterminate",s;for(const{progress:n}of Object.values(r)){const{preprocess:o,postprocess:a}=n;s==null&&(o||a)&&({mode:t,message:s}=o||a),(o==null?void 0:o.mode)==="determinate"&&e.push(o.value),(a==null?void 0:a.mode)==="determinate"&&e.push(a.value)}const i=e.reduce((n,o)=>n+o/e.length,0);return{mode:t,message:s,value:i}}function Xc(r){const e=Math.floor(r/3600)%24,t=Math.floor(r/60)%60,s=Math.floor(r%60);return{hours:e,minutes:t,seconds:s}}function Qc(r){const e=Xc(r),t=e.hours===0?"":`${e.hours}h`,s=e.minutes===0?"":`${e.hours===0?e.minutes:` ${e.minutes.toString(10).padStart(2,"0")}`}m`,i=e.hours!==0?"":`${e.minutes===0?e.seconds:` ${e.seconds.toString(10).padStart(2,"0")}`}s`;return`${t}${s}${i}`}const Yc="·",rn=()=>` ${Yc} `;function Zc(r){const{newFiles:e,isUploadStarted:t,recoveredState:s,i18n:i,uploadState:n,isSomeGhost:o,startUpload:a}=r,l=xr("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--upload",{"uppy-c-btn-primary":n===Ee.STATE_WAITING},{"uppy-StatusBar-actionBtn--disabled":o}),u=e&&t&&!s?i("uploadXNewFiles",{smart_count:e}):i("uploadXFiles",{smart_count:e});return w("button",{type:"button",className:l,"aria-label":i("uploadXFiles",{smart_count:e}),onClick:a,disabled:o,"data-uppy-super-focusable":!0},u)}function ed(r){const{i18n:e,uppy:t}=r;return w("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--retry","aria-label":e("retryUpload"),onClick:()=>t.retryAll().catch(()=>{}),"data-uppy-super-focusable":!0,"data-cy":"retry"},w("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"8",height:"10",viewBox:"0 0 8 10"},w("path",{d:"M4 2.408a2.75 2.75 0 1 0 2.75 2.75.626.626 0 0 1 1.25.018v.023a4 4 0 1 1-4-4.041V.25a.25.25 0 0 1 .389-.208l2.299 1.533a.25.25 0 0 1 0 .416l-2.3 1.533A.25.25 0 0 1 4 3.316v-.908z"})),e("retry"))}function td(r){const{i18n:e,uppy:t}=r;return w("button",{type:"button",className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",title:e("cancel"),"aria-label":e("cancel"),onClick:()=>t.cancelAll(),"data-cy":"cancel","data-uppy-super-focusable":!0},w("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16"},w("g",{fill:"none",fillRule:"evenodd"},w("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),w("path",{fill:"#FFF",d:"M9.283 8l2.567 2.567-1.283 1.283L8 9.283 5.433 11.85 4.15 10.567 6.717 8 4.15 5.433 5.433 4.15 8 6.717l2.567-2.567 1.283 1.283z"}))))}function rd(r){const{isAllPaused:e,i18n:t,isAllComplete:s,resumableUploads:i,uppy:n}=r,o=t(e?"resume":"pause");function a(){if(!s){if(!i){n.cancelAll();return}if(e){n.resumeAll();return}n.pauseAll()}}return w("button",{title:o,"aria-label":o,className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",type:"button",onClick:a,"data-cy":"togglePauseResume","data-uppy-super-focusable":!0},w("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16"},w("g",{fill:"none",fillRule:"evenodd"},w("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),w("path",{fill:"#FFF",d:e?"M6 4.25L11.5 8 6 11.75z":"M5 4.5h2v7H5v-7zm4 0h2v7H9v-7z"}))))}function sd(r){const{i18n:e,doneButtonHandler:t}=r;return w("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--done",onClick:t,"data-uppy-super-focusable":!0},e("done"))}function ho(){return w("svg",{className:"uppy-StatusBar-spinner","aria-hidden":"true",focusable:"false",width:"14",height:"14"},w("path",{d:"M13.983 6.547c-.12-2.509-1.64-4.893-3.939-5.936-2.48-1.127-5.488-.656-7.556 1.094C.524 3.367-.398 6.048.162 8.562c.556 2.495 2.46 4.52 4.94 5.183 2.932.784 5.61-.602 7.256-3.015-1.493 1.993-3.745 3.309-6.298 2.868-2.514-.434-4.578-2.349-5.153-4.84a6.226 6.226 0 0 1 2.98-6.778C6.34.586 9.74 1.1 11.373 3.493c.407.596.693 1.282.842 1.988.127.598.073 1.197.161 1.794.078.525.543 1.257 1.15.864.525-.341.49-1.05.456-1.592-.007-.15.02.3 0 0",fillRule:"evenodd"}))}function id(r){const{progress:e}=r,{value:t,mode:s,message:i}=e,n="·";return w("div",{className:"uppy-StatusBar-content"},w(ho,null),s==="determinate"?`${Math.round(t*100)}% ${n} `:"",i)}function nd(r){const{numUploads:e,complete:t,totalUploadedSize:s,totalSize:i,totalETA:n,i18n:o}=r,a=e>1,l=gt(s);return w("div",{className:"uppy-StatusBar-statusSecondary"},a&&o("filesUploadedOfTotal",{complete:t,smart_count:e}),w("span",{className:"uppy-StatusBar-additionalInfo"},a&&rn(),i!=null?o("dataUploadedOfTotal",{complete:l,total:gt(i)}):o("dataUploadedOfUnknown",{complete:l}),rn(),n!=null&&o("xTimeLeft",{time:Qc(n)})))}function fo(r){const{i18n:e,complete:t,numUploads:s}=r;return w("div",{className:"uppy-StatusBar-statusSecondary"},e("filesUploadedOfTotal",{complete:t,smart_count:s}))}function od(r){const{i18n:e,newFiles:t,startUpload:s}=r,i=xr("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--uploadNewlyAdded");return w("div",{className:"uppy-StatusBar-statusSecondary"},w("div",{className:"uppy-StatusBar-statusSecondaryHint"},e("xMoreFilesAdded",{smart_count:t})),w("button",{type:"button",className:i,"aria-label":e("uploadXFiles",{smart_count:t}),onClick:s},e("upload")))}function ad(r){const{i18n:e,supportsUploadProgress:t,totalProgress:s,showProgressDetails:i,isUploadStarted:n,isAllComplete:o,isAllPaused:a,newFiles:l,numUploads:u,complete:d,totalUploadedSize:c,totalSize:p,totalETA:h,startUpload:f}=r,m=l&&n;if(!n||o)return null;const y=e(a?"paused":"uploading");function v(){return!a&&!m&&i?t?w(nd,{numUploads:u,complete:d,totalUploadedSize:c,totalSize:p,totalETA:h,i18n:e}):w(fo,{i18n:e,complete:d,numUploads:u}):null}return w("div",{className:"uppy-StatusBar-content","aria-label":y,title:y},a?null:w(ho,null),w("div",{className:"uppy-StatusBar-status"},w("div",{className:"uppy-StatusBar-statusPrimary"},t&&s!==0?`${y}: ${s}%`:y),v(),m?w(od,{i18n:e,newFiles:l,startUpload:f}):null))}function ld(r){const{i18n:e}=r;return w("div",{className:"uppy-StatusBar-content",role:"status",title:e("complete")},w("div",{className:"uppy-StatusBar-status"},w("div",{className:"uppy-StatusBar-statusPrimary"},w("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"15",height:"11",viewBox:"0 0 15 11"},w("path",{d:"M.414 5.843L1.627 4.63l3.472 3.472L13.202 0l1.212 1.213L5.1 10.528z"})),e("complete"))))}function ud(r){const{error:e,i18n:t,complete:s,numUploads:i}=r;function n(){const o=`${t("uploadFailed")} 

 ${e}`;alert(o)}return w("div",{className:"uppy-StatusBar-content",title:t("uploadFailed")},w("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"11",height:"11",viewBox:"0 0 11 11"},w("path",{d:"M4.278 5.5L0 1.222 1.222 0 5.5 4.278 9.778 0 11 1.222 6.722 5.5 11 9.778 9.778 11 5.5 6.722 1.222 11 0 9.778z"})),w("div",{className:"uppy-StatusBar-status"},w("div",{className:"uppy-StatusBar-statusPrimary"},t("uploadFailed"),w("button",{className:"uppy-u-reset uppy-StatusBar-details","aria-label":t("showErrorDetails"),"data-microtip-position":"top-right","data-microtip-size":"medium",onClick:n,type:"button"},"?")),w(fo,{i18n:t,complete:s,numUploads:i})))}const{STATE_ERROR:sn,STATE_WAITING:cd,STATE_PREPROCESSING:os,STATE_UPLOADING:gr,STATE_POSTPROCESSING:as,STATE_COMPLETE:yr}=Ee;function dd(r){let{newFiles:e,allowNewUpload:t,isUploadInProgress:s,isAllPaused:i,resumableUploads:n,error:o,hideUploadButton:a=void 0,hidePauseResumeButton:l=!1,hideCancelButton:u=!1,hideRetryButton:d=!1,recoveredState:c,uploadState:p,totalProgress:h,files:f,supportsUploadProgress:m,hideAfterFinish:y=!1,isSomeGhost:v,doneButtonHandler:_=void 0,isUploadStarted:A,i18n:k,startUpload:P,uppy:E,isAllComplete:T,showProgressDetails:U=void 0,numUploads:M,complete:B,totalSize:$,totalETA:D,totalUploadedSize:ke}=r;function ge(){switch(p){case as:case os:{const cr=ns(f);return cr.mode==="determinate"?cr.value*100:h}case sn:return null;case gr:return m?h:null;default:return h}}function Ce(){switch(p){case as:case os:{const{mode:cr}=ns(f);return cr==="indeterminate"}case gr:return!m;default:return!1}}const Se=ge(),Pe=Se??100,Ve=!o&&e&&(!s&&!i||c)&&t&&!a,Fe=!u&&p!==cd&&p!==yr,Ge=n&&!l&&p===gr,ii=o&&!T&&!d,ni=_&&p===yr,To=xr("uppy-StatusBar-progress",{"is-indeterminate":Ce()}),ko=xr("uppy-StatusBar",`is-${p}`,{"has-ghosts":v}),oi=(()=>{switch(p){case os:case as:return w(id,{progress:ns(f)});case yr:return w(ld,{i18n:k});case sn:return w(ud,{error:o,i18n:k,numUploads:M,complete:B});case gr:return w(ad,{i18n:k,supportsUploadProgress:m,totalProgress:h,showProgressDetails:U,isUploadStarted:A,isAllComplete:T,isAllPaused:i,newFiles:e,numUploads:M,complete:B,totalUploadedSize:ke,totalSize:$,totalETA:D,startUpload:P});default:return null}})();return!(Ve||ii||Ge||Fe||ni)&&!oi||p===yr&&y?null:w("div",{className:ko},w("div",{className:To,style:{width:`${Pe}%`},role:"progressbar","aria-label":`${Pe}%`,"aria-valuetext":`${Pe}%`,"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":Se}),oi,w("div",{className:"uppy-StatusBar-actions"},Ve?w(Zc,{newFiles:e,isUploadStarted:A,recoveredState:c,i18n:k,isSomeGhost:v,startUpload:P,uploadState:p}):null,ii?w(ed,{i18n:k,uppy:E}):null,Ge?w(rd,{isAllPaused:i,i18n:k,isAllComplete:T,resumableUploads:n,uppy:E}):null,Fe?w(td,{i18n:k,uppy:E}):null,ni?w(sd,{i18n:k,doneButtonHandler:_}):null))}const pd={strings:{uploading:"Uploading",complete:"Complete",uploadFailed:"Upload failed",paused:"Paused",retry:"Retry",cancel:"Cancel",pause:"Pause",resume:"Resume",done:"Done",filesUploadedOfTotal:{0:"%{complete} of %{smart_count} file uploaded",1:"%{complete} of %{smart_count} files uploaded"},dataUploadedOfTotal:"%{complete} of %{total}",dataUploadedOfUnknown:"%{complete} of unknown",xTimeLeft:"%{time} left",uploadXFiles:{0:"Upload %{smart_count} file",1:"Upload %{smart_count} files"},uploadXNewFiles:{0:"Upload +%{smart_count} file",1:"Upload +%{smart_count} files"},upload:"Upload",retryUpload:"Retry upload",xMoreFilesAdded:{0:"%{smart_count} more file added",1:"%{smart_count} more files added"},showErrorDetails:"Show error details"}};function j(r,e){if(!{}.hasOwnProperty.call(r,e))throw new TypeError("attempted to use private field on non-instance");return r}var hd=0;function St(r){return"__private_"+hd+++"_"+r}const fd={version:"4.1.3"},md=2e3,gd=2e3;function yd(r,e,t,s){if(r)return Ee.STATE_ERROR;if(e)return Ee.STATE_COMPLETE;if(t)return Ee.STATE_WAITING;let i=Ee.STATE_WAITING;const n=Object.keys(s);for(let o=0;o<n.length;o++){const{progress:a}=s[n[o]];if(a.uploadStarted&&!a.uploadComplete)return Ee.STATE_UPLOADING;a.preprocess&&(i=Ee.STATE_PREPROCESSING),a.postprocess&&i!==Ee.STATE_PREPROCESSING&&(i=Ee.STATE_POSTPROCESSING)}return i}const vd={hideUploadButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideCancelButton:!1,showProgressDetails:!1,hideAfterFinish:!0,doneButtonHandler:null};var fe=St("lastUpdateTime"),ve=St("previousUploadedBytes"),je=St("previousSpeed"),le=St("previousETA"),ls=St("computeSmoothETA"),$t=St("onUploadStart");class ei extends Hr{constructor(e,t){super(e,{...vd,...t}),Object.defineProperty(this,ls,{value:bd}),Object.defineProperty(this,fe,{writable:!0,value:void 0}),Object.defineProperty(this,ve,{writable:!0,value:void 0}),Object.defineProperty(this,je,{writable:!0,value:void 0}),Object.defineProperty(this,le,{writable:!0,value:void 0}),this.startUpload=()=>this.uppy.upload().catch(()=>{}),Object.defineProperty(this,$t,{writable:!0,value:()=>{const{recoveredState:s}=this.uppy.getState();if(j(this,je)[je]=null,j(this,le)[le]=null,s){j(this,ve)[ve]=Object.values(s.files).reduce((i,n)=>{let{progress:o}=n;return i+o.bytesUploaded},0),this.uppy.emit("restore-confirmed");return}j(this,fe)[fe]=performance.now(),j(this,ve)[ve]=0}}),this.id=this.opts.id||"StatusBar",this.title="StatusBar",this.type="progressindicator",this.defaultLocale=pd,this.i18nInit(),this.render=this.render.bind(this),this.install=this.install.bind(this)}render(e){const{capabilities:t,files:s,allowNewUpload:i,totalProgress:n,error:o,recoveredState:a}=e,{newFiles:l,startedFiles:u,completeFiles:d,isUploadStarted:c,isAllComplete:p,isAllPaused:h,isUploadInProgress:f,isSomeGhost:m}=this.uppy.getObjectOfFilesPerState(),y=a?Object.values(s):l,v=!!t.resumableUploads,_=t.uploadProgress!==!1;let A=null,k=0;u.every(E=>E.progress.bytesTotal!=null&&E.progress.bytesTotal!==0)?(A=0,u.forEach(E=>{A+=E.progress.bytesTotal||0,k+=E.progress.bytesUploaded||0})):u.forEach(E=>{k+=E.progress.bytesUploaded||0});const P=j(this,ls)[ls]({uploaded:k,total:A});return dd({error:o,uploadState:yd(o,p,a,e.files||{}),allowNewUpload:i,totalProgress:n,totalSize:A,totalUploadedSize:k,isAllComplete:!1,isAllPaused:h,isUploadStarted:c,isUploadInProgress:f,isSomeGhost:m,recoveredState:a,complete:d.length,newFiles:y.length,numUploads:u.length,totalETA:P,files:s,i18n:this.i18n,uppy:this.uppy,startUpload:this.startUpload,doneButtonHandler:this.opts.doneButtonHandler,resumableUploads:v,supportsUploadProgress:_,showProgressDetails:this.opts.showProgressDetails,hideUploadButton:this.opts.hideUploadButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,hideCancelButton:this.opts.hideCancelButton,hideAfterFinish:this.opts.hideAfterFinish})}onMount(){const e=this.el;oo(e)||(e.dir="ltr")}install(){const{target:e}=this.opts;e&&this.mount(e,this),this.uppy.on("upload",j(this,$t)[$t]),j(this,fe)[fe]=performance.now(),j(this,ve)[ve]=this.uppy.getFiles().reduce((t,s)=>t+s.progress.bytesUploaded,0)}uninstall(){this.unmount(),this.uppy.off("upload",j(this,$t)[$t])}}function bd(r){var e,t;if(r.total==null||r.total===0)return null;const s=r.total-r.uploaded;if(s<=0)return null;(t=(e=j(this,fe))[fe])!=null||(e[fe]=performance.now());const i=performance.now()-j(this,fe)[fe];if(i===0){var n;return Math.round(((n=j(this,le)[le])!=null?n:0)/100)/10}const o=r.uploaded-j(this,ve)[ve];if(j(this,ve)[ve]=r.uploaded,o<=0){var a;return Math.round(((a=j(this,le)[le])!=null?a:0)/100)/10}const l=o/i,u=j(this,je)[je]==null?l:tn(l,j(this,je)[je],md,i);j(this,je)[je]=u;const d=s/u,c=Math.max(j(this,le)[le]-i,0),p=j(this,le)[le]==null?d:tn(d,c,gd,i);return j(this,le)[le]=p,j(this,fe)[fe]=performance.now(),Math.round(p/100)/10}ei.VERSION=fd.version;const wd={version:"4.2.1"},_d={fixed:!1,hideAfterFinish:!0};class ti extends Hr{constructor(e,t){super(e,{..._d,...t}),this.id=this.opts.id||"ProgressBar",this.title="Progress Bar",this.type="progressindicator",this.render=this.render.bind(this)}render(e){const{totalProgress:t}=e,s=(t===0||t===100)&&this.opts.hideAfterFinish;return w("div",{className:"uppy uppy-ProgressBar",style:{position:this.opts.fixed?"fixed":"initial"},"aria-hidden":s},w("div",{className:"uppy-ProgressBar-inner",style:{width:`${t}%`}}),w("div",{className:"uppy-ProgressBar-percentage"},t))}install(){const{target:e}=this.opts;e&&this.mount(e,this)}uninstall(){this.unmount()}}ti.VERSION=wd.version;const Sd={strings:{chooseFiles:"Choose files"}},Pd={version:"4.1.3"},Ed={pretty:!0,inputName:"files[]"};class mo extends Hr{constructor(e,t){super(e,{...Ed,...t}),this.input=null,this.id=this.opts.id||"FileInput",this.title="File Input",this.type="acquirer",this.defaultLocale=Sd,this.i18nInit(),this.render=this.render.bind(this),this.handleInputChange=this.handleInputChange.bind(this),this.handleClick=this.handleClick.bind(this)}addFiles(e){const t=e.map(s=>({source:this.id,name:s.name,type:s.type,data:s}));try{this.uppy.addFiles(t)}catch(s){this.uppy.log(s)}}handleInputChange(e){this.uppy.log("[FileInput] Something selected through input...");const t=Zs(e.currentTarget.files||[]);this.addFiles(t),e.currentTarget.value=""}handleClick(){this.input.click()}render(){var e;const t={width:"0.1px",height:"0.1px",opacity:0,overflow:"hidden",position:"absolute",zIndex:-1},{restrictions:s}=this.uppy.opts;return w("div",{className:"uppy-FileInput-container"},w("input",{className:"uppy-FileInput-input",style:this.opts.pretty?t:void 0,type:"file",name:this.opts.inputName,onChange:this.handleInputChange,multiple:s.maxNumberOfFiles!==1,accept:(e=s.allowedFileTypes)==null?void 0:e.join(", "),ref:i=>{this.input=i}}),this.opts.pretty&&w("button",{className:"uppy-FileInput-btn",type:"button",onClick:this.handleClick},this.i18n("chooseFiles")))}install(){const{target:e}=this.opts;e&&this.mount(e,this)}uninstall(){this.unmount()}}mo.VERSION=Pd.version;class Td extends Error{constructor(){super(...arguments),this.name="UserFacingApiError"}}var go={};function me(r,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(r)),this._timeouts=r,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}var kd=me;me.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};me.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};me.prototype.retry=function(r){if(this._timeout&&clearTimeout(this._timeout),!r)return!1;var e=new Date().getTime();if(r&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(r),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(r);var t=this._timeouts.shift();if(t===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),t=this._cachedTimeouts.slice(-1);else return!1;var s=this;return this._timer=setTimeout(function(){s._attempts++,s._operationTimeoutCb&&(s._timeout=setTimeout(function(){s._operationTimeoutCb(s._attempts)},s._operationTimeout),s._options.unref&&s._timeout.unref()),s._fn(s._attempts)},t),this._options.unref&&this._timer.unref(),!0};me.prototype.attempt=function(r,e){this._fn=r,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var t=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){t._operationTimeoutCb()},t._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};me.prototype.try=function(r){console.log("Using RetryOperation.try() is deprecated"),this.attempt(r)};me.prototype.start=function(r){console.log("Using RetryOperation.start() is deprecated"),this.attempt(r)};me.prototype.start=me.prototype.try;me.prototype.errors=function(){return this._errors};me.prototype.attempts=function(){return this._attempts};me.prototype.mainError=function(){if(this._errors.length===0)return null;for(var r={},e=null,t=0,s=0;s<this._errors.length;s++){var i=this._errors[s],n=i.message,o=(r[n]||0)+1;r[n]=o,o>=t&&(e=i,t=o)}return e};(function(r){var e=kd;r.operation=function(t){var s=r.timeouts(t);return new e(s,{forever:t&&(t.forever||t.retries===1/0),unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})},r.timeouts=function(t){if(t instanceof Array)return[].concat(t);var s={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var i in t)s[i]=t[i];if(s.minTimeout>s.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var n=[],o=0;o<s.retries;o++)n.push(this.createTimeout(o,s));return t&&t.forever&&!n.length&&n.push(this.createTimeout(o,s)),n.sort(function(a,l){return a-l}),n},r.createTimeout=function(t,s){var i=s.randomize?Math.random()+1:1,n=Math.round(i*Math.max(s.minTimeout,1)*Math.pow(s.factor,t));return n=Math.min(n,s.maxTimeout),n},r.wrap=function(t,s,i){if(s instanceof Array&&(i=s,s=null),!i){i=[];for(var n in t)typeof t[n]=="function"&&i.push(n)}for(var o=0;o<i.length;o++){var a=i[o],l=t[a];t[a]=(function(d){var c=r.operation(s),p=Array.prototype.slice.call(arguments,1),h=p.pop();p.push(function(f){c.retry(f)||(f&&(arguments[0]=c.mainError()),h.apply(this,arguments))}),c.attempt(function(){d.apply(t,p)})}).bind(t,l),t[a].options=s}}})(go);var Cd=go;const Fd=_t(Cd),Od=Object.prototype.toString,Ad=r=>Od.call(r)==="[object Error]",Ud=new Set(["network error","Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Load failed","Network request failed","fetch failed","terminated"]);function Rd(r){return r&&Ad(r)&&r.name==="TypeError"&&typeof r.message=="string"?r.message==="Load failed"?r.stack===void 0:Ud.has(r.message):!1}class $s extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}const nn=(r,e,t)=>{const s=t.retries-(e-1);return r.attemptNumber=e,r.retriesLeft=s,r};async function yo(r,e){return new Promise((t,s)=>{e={...e},e.onFailedAttempt??(e.onFailedAttempt=()=>{}),e.shouldRetry??(e.shouldRetry=()=>!0),e.retries??(e.retries=10);const i=Fd.operation(e),n=()=>{var a;i.stop(),s((a=e.signal)==null?void 0:a.reason)};e.signal&&!e.signal.aborted&&e.signal.addEventListener("abort",n,{once:!0});const o=()=>{var a;(a=e.signal)==null||a.removeEventListener("abort",n),i.stop()};i.attempt(async a=>{try{const l=await r(a);o(),t(l)}catch(l){try{if(!(l instanceof Error))throw new TypeError(`Non-error was thrown: "${l}". You should only throw errors.`);if(l instanceof $s)throw l.originalError;if(l instanceof TypeError&&!Rd(l))throw l;if(nn(l,a,e),await e.shouldRetry(l)||(i.stop(),s(l)),await e.onFailedAttempt(l),!i.retry(l))throw i.mainError()}catch(u){nn(u,a,e),o(),s(u)}}})})}class xd extends Error{constructor(e,t){t===void 0&&(t=null),super("This looks like a network error, the endpoint might be blocked by an internet provider or a firewall."),this.cause=e,this.isNetworkError=!0,this.request=t}}function Md(){return fetch(...arguments).catch(r=>{throw r.name==="AbortError"?r:new xd(r)})}function vo(r,e){return Object.prototype.hasOwnProperty.call(r,e)}class $d extends Error{constructor(e,t){super(e),this.cause=t==null?void 0:t.cause,this.cause&&vo(this.cause,"isNetworkError")?this.isNetworkError=this.cause.isNetworkError:this.isNetworkError=!1}}function Nd(r){var e;const s=(e=/^(?:https?:\/\/|\/\/)?(?:[^@\n]+@)?([^\n]+)/i.exec(r))==null?void 0:e[1];return`${/^http:\/\//i.test(r)?"ws":"wss"}://${s}`}class Ld extends Error{constructor(){super("Authorization required"),this.name="AuthError",this.isAuthError=!0}}function Ae(r,e){if(!{}.hasOwnProperty.call(r,e))throw new TypeError("attempted to use private field on non-instance");return r}var jd=0;function Vr(r){return"__private_"+jd+++"_"+r}const Bd={version:"4.4.2"};function Id(r){return r.replace(/\/$/,"")}const bo=10,Dd=5*60*1e3,qd=401;class zd extends Error{constructor(e){let{statusCode:t,message:s}=e;super(s),this.name="HttpError",this.statusCode=t}}async function Hd(r){if(r.status===qd)throw new Ld;if(r.ok)return r.json();let e=`Failed request with status: ${r.status}. ${r.statusText}`,t;try{t=await r.json(),t.message&&(e=`${e} message: ${t.message}`),t.requestId&&(e=`${e} request-Id: ${t.requestId}`)}catch(s){throw new Error(e,{cause:s})}throw r.status>=400&&r.status<=499&&t.message?new Td(t.message):new zd({statusCode:r.status,message:e})}function Wd(r,e,t){const{progress:s,bytesUploaded:i,bytesTotal:n}=e;if(s){var o;r.uppy.log(`Upload progress: ${s}`),r.uppy.emit("upload-progress",t,{uploadStarted:(o=t.progress.uploadStarted)!=null?o:0,bytesUploaded:i,bytesTotal:n})}}var Ue=Vr("companionHeaders"),Nt=Vr("getUrl"),us=Vr("requestSocketToken"),Lt=Vr("awaitRemoteFileUpload");class wo{constructor(e,t){Object.defineProperty(this,Lt,{value:Gd}),Object.defineProperty(this,Nt,{value:Vd}),Object.defineProperty(this,Ue,{writable:!0,value:void 0}),Object.defineProperty(this,us,{writable:!0,value:async s=>{var i;let{file:n,postBody:o,signal:a}=s;if(((i=n.remote)==null?void 0:i.url)==null)throw new Error("Cannot connect to an undefined URL");return(await this.post(n.remote.url,{...n.remote.body,...o},{signal:a})).token}}),this.uppy=e,this.opts=t,this.onReceiveResponse=this.onReceiveResponse.bind(this),Ae(this,Ue)[Ue]=t.companionHeaders}setCompanionHeaders(e){Ae(this,Ue)[Ue]=e}[Symbol.for("uppy test: getCompanionHeaders")](){return Ae(this,Ue)[Ue]}get hostname(){const{companion:e}=this.uppy.getState(),t=this.opts.companionUrl;return Id(e&&e[t]?e[t]:t)}async headers(e){return e===void 0&&(e=!1),{...{Accept:"application/json",...e?void 0:{"Content-Type":"application/json"}},...Ae(this,Ue)[Ue]}}onReceiveResponse(e){const{headers:t}=e,i=this.uppy.getState().companion||{},n=this.opts.companionUrl;t.has("i-am")&&t.get("i-am")!==i[n]&&this.uppy.setState({companion:{...i,[n]:t.get("i-am")}})}async request(e){let{path:t,method:s="GET",data:i,skipPostResponse:n,signal:o}=e;try{const a=await this.headers(!i),l=await Md(Ae(this,Nt)[Nt](t),{method:s,signal:o,headers:a,credentials:this.opts.companionCookiesRule||"same-origin",body:i?JSON.stringify(i):null});return n||this.onReceiveResponse(l),await Hd(l)}catch(a){throw a.isAuthError||a.name==="UserFacingApiError"||a.name==="AbortError"?a:new $d(`Could not ${s} ${Ae(this,Nt)[Nt](t)}`,{cause:a})}}async get(e,t){return this.request({...t,path:e})}async post(e,t,s){return this.request({...s,path:e,method:"POST",data:t})}async delete(e,t,s){return this.request({...s,path:e,method:"DELETE",data:t})}async uploadRemoteFile(e,t,s){var i=this;try{const{signal:n,getQueue:o}=s||{};return await yo(async()=>{var a;const l=(a=this.uppy.getFile(e.id))==null?void 0:a.serverToken;if(l!=null)return this.uppy.log(`Connecting to exiting websocket ${l}`),Ae(this,Lt)[Lt]({file:e,queue:o(),signal:n});const d=await o().wrapPromiseFunction(async function(){try{return await Ae(i,us)[us](...arguments)}catch(c){if(c.isAuthError)throw new $s(c);if(c.cause==null)throw c;const p=c.cause,h=()=>[408,409,429,418,423].includes(p.statusCode)||p.statusCode>=500&&p.statusCode<=599&&![501,505].includes(p.statusCode);throw p.name==="HttpError"&&!h()?new $s(p):p}},{priority:-1})({file:e,postBody:t,signal:n}).abortOn(n);if(this.uppy.getFile(e.id))return this.uppy.setFileState(e.id,{serverToken:d}),Ae(this,Lt)[Lt]({file:this.uppy.getFile(e.id),queue:o(),signal:n})},{retries:bo,signal:n,onFailedAttempt:a=>this.uppy.log(`Retrying upload due to: ${a.message}`,"warning")})}catch(n){if(n.name==="AbortError")return;throw this.uppy.emit("upload-error",e,n),n}}}function Vd(r){return/^(https?:|)\/\//.test(r)?r:`${this.hostname}/${r}`}async function Gd(r){let{file:e,queue:t,signal:s}=r,i;const{capabilities:n}=this.uppy.getState();try{return await new Promise((o,a)=>{const l=e.serverToken,u=Nd(e.remote.companionUrl);let d,c,p,{isPaused:h}=e;const f=(T,U)=>{if(d==null||d.readyState!==d.OPEN){var M;this.uppy.log(`Cannot send "${T}" to socket ${e.id} because the socket state was ${String((M=d)==null?void 0:M.readyState)}`,"warning");return}d.send(JSON.stringify({action:T,payload:U??{}}))};function m(){n.resumableUploads&&f(h?"pause":"resume")}const y=async()=>{c&&c.abort(),c=new AbortController;const T=M=>{var B;this.uppy.setFileState(e.id,{serverToken:null}),(B=c)==null||B.abort==null||B.abort(),a(M)};function U(){clearTimeout(p),!h&&(p=setTimeout(()=>T(new Error("Timeout waiting for message from Companion socket")),Dd))}try{await t.wrapPromiseFunction(async()=>{await yo(async()=>new Promise((B,$)=>{d=new WebSocket(`${u}/api/${l}`),U(),d.addEventListener("close",()=>{d=void 0,$(new Error("Socket closed unexpectedly"))}),d.addEventListener("error",ke=>{var ge;this.uppy.log(`Companion socket error ${JSON.stringify(ke)}, closing socket`,"warning"),(ge=d)==null||ge.close()}),d.addEventListener("open",()=>{m()}),d.addEventListener("message",ke=>{U();try{const{action:Ve,payload:Fe}=JSON.parse(ke.data);switch(Ve){case"progress":{Wd(this,Fe,this.uppy.getFile(e.id));break}case"success":{var ge,Ce,Se,Pe;const Ge=(ge=Fe.response)==null?void 0:ge.responseText;this.uppy.emit("upload-success",this.uppy.getFile(e.id),{uploadURL:Fe.url,status:(Ce=(Se=Fe.response)==null?void 0:Se.status)!=null?Ce:200,body:Ge?JSON.parse(Ge):void 0}),(Pe=c)==null||Pe.abort==null||Pe.abort(),o();break}case"error":{const{message:Ge}=Fe.error;throw Object.assign(new Error(Ge),{cause:Fe.error})}default:this.uppy.log(`Companion socket unknown action ${Ve}`,"warning")}}catch(Ve){T(Ve)}});const D=()=>{this.uppy.log(`Closing socket ${e.id}`),clearTimeout(p),d&&d.close(),d=void 0};c.signal.addEventListener("abort",()=>{D()})}),{retries:bo,signal:c.signal,onFailedAttempt:()=>{c.signal.aborted||this.uppy.log(`Retrying websocket ${e.id}`)}})})().abortOn(c.signal)}catch(M){if(c.signal.aborted)return;T(M)}},v=T=>{n.resumableUploads&&(h=T,d&&m())},_=T=>{var U;n.individualCancellation&&T.id===e.id&&(f("cancel"),(U=c)==null||U.abort==null||U.abort(),this.uppy.log(`upload ${e.id} was removed`),o())},A=()=>{var T;f("cancel"),(T=c)==null||T.abort==null||T.abort(),this.uppy.log(`upload ${e.id} was canceled`),o()},k=(T,U)=>{(T==null?void 0:T.id)===e.id&&v(U)},P=()=>v(!0),E=()=>v(!1);this.uppy.on("file-removed",_),this.uppy.on("cancel-all",A),this.uppy.on("upload-pause",k),this.uppy.on("pause-all",P),this.uppy.on("resume-all",E),i=()=>{this.uppy.off("file-removed",_),this.uppy.off("cancel-all",A),this.uppy.off("upload-pause",k),this.uppy.off("pause-all",P),this.uppy.off("resume-all",E)},s.addEventListener("abort",()=>{var T;(T=c)==null||T.abort()}),y()})}finally{i==null||i()}}wo.VERSION=Bd.version;function Re(r,e){if(!{}.hasOwnProperty.call(r,e))throw new TypeError("attempted to use private field on non-instance");return r}var Jd=0;function _o(r){return"__private_"+Jd+++"_"+r}var Y=_o("uppy"),jt=_o("events");class Kd{constructor(e){Object.defineProperty(this,Y,{writable:!0,value:void 0}),Object.defineProperty(this,jt,{writable:!0,value:[]}),Re(this,Y)[Y]=e}on(e,t){return Re(this,jt)[jt].push([e,t]),Re(this,Y)[Y].on(e,t)}remove(){for(const[e,t]of Re(this,jt)[jt].splice(0))Re(this,Y)[Y].off(e,t)}onFilePause(e,t){this.on("upload-pause",(s,i)=>{e===(s==null?void 0:s.id)&&t(i)})}onFileRemove(e,t){this.on("file-removed",s=>{e===s.id&&t(s.id)})}onPause(e,t){this.on("upload-pause",(s,i)=>{e===(s==null?void 0:s.id)&&t(i)})}onRetry(e,t){this.on("upload-retry",s=>{e===(s==null?void 0:s.id)&&t()})}onRetryAll(e,t){this.on("retry-all",()=>{Re(this,Y)[Y].getFile(e)&&t()})}onPauseAll(e,t){this.on("pause-all",()=>{Re(this,Y)[Y].getFile(e)&&t()})}onCancelAll(e,t){var s=this;this.on("cancel-all",function(){Re(s,Y)[Y].getFile(e)&&t(...arguments)})}onResumeAll(e,t){this.on("resume-all",()=>{Re(this,Y)[Y].getFile(e)&&t()})}}function F(r,e){if(!{}.hasOwnProperty.call(r,e))throw new TypeError("attempted to use private field on non-instance");return r}var Xd=0;function ne(r){return"__private_"+Xd+++"_"+r}function Qd(r){return new Error("Cancelled",{cause:r})}function on(r){if(r!=null){var e;const t=()=>this.abort(r.reason);r.addEventListener("abort",t,{once:!0});const s=()=>{r.removeEventListener("abort",t)};(e=this.then)==null||e.call(this,s,s)}return this}var ue=ne("activeRequests"),re=ne("queuedHandlers"),ae=ne("paused"),Je=ne("pauseTimer"),Z=ne("downLimit"),Ke=ne("upperLimit"),xe=ne("rateLimitingTimer"),er=ne("call"),qe=ne("queueNext"),Ns=ne("next"),cs=ne("queue"),Ls=ne("dequeue"),ds=ne("resume"),Xe=ne("increaseLimit");class Yd{constructor(e){Object.defineProperty(this,Ls,{value:sp}),Object.defineProperty(this,cs,{value:rp}),Object.defineProperty(this,Ns,{value:tp}),Object.defineProperty(this,qe,{value:ep}),Object.defineProperty(this,er,{value:Zd}),Object.defineProperty(this,ue,{writable:!0,value:0}),Object.defineProperty(this,re,{writable:!0,value:[]}),Object.defineProperty(this,ae,{writable:!0,value:!1}),Object.defineProperty(this,Je,{writable:!0,value:void 0}),Object.defineProperty(this,Z,{writable:!0,value:1}),Object.defineProperty(this,Ke,{writable:!0,value:void 0}),Object.defineProperty(this,xe,{writable:!0,value:void 0}),Object.defineProperty(this,ds,{writable:!0,value:()=>this.resume()}),Object.defineProperty(this,Xe,{writable:!0,value:()=>{if(F(this,ae)[ae]){F(this,xe)[xe]=setTimeout(F(this,Xe)[Xe],0);return}F(this,Z)[Z]=this.limit,this.limit=Math.ceil((F(this,Ke)[Ke]+F(this,Z)[Z])/2);for(let t=F(this,Z)[Z];t<=this.limit;t++)F(this,qe)[qe]();F(this,Ke)[Ke]-F(this,Z)[Z]>3?F(this,xe)[xe]=setTimeout(F(this,Xe)[Xe],2e3):F(this,Z)[Z]=Math.floor(F(this,Z)[Z]/2)}}),typeof e!="number"||e===0?this.limit=1/0:this.limit=e}run(e,t){return!F(this,ae)[ae]&&F(this,ue)[ue]<this.limit?F(this,er)[er](e):F(this,cs)[cs](e,t)}wrapSyncFunction(e,t){var s=this;return function(){for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];const a=s.run(()=>(e(...n),queueMicrotask(()=>a.done()),()=>{}),t);return{abortOn:on,abort(){a.abort()}}}}wrapPromiseFunction(e,t){var s=this;return function(){for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];let a;const l=new Promise((u,d)=>{a=s.run(()=>{let c,p;try{p=Promise.resolve(e(...n))}catch(h){p=Promise.reject(h)}return p.then(h=>{c?d(c):(a.done(),u(h))},h=>{c?d(c):(a.done(),d(h))}),h=>{c=Qd(h)}},t)});return l.abort=u=>{a.abort(u)},l.abortOn=on,l}}resume(){F(this,ae)[ae]=!1,clearTimeout(F(this,Je)[Je]);for(let e=0;e<this.limit;e++)F(this,qe)[qe]()}pause(e){e===void 0&&(e=null),F(this,ae)[ae]=!0,clearTimeout(F(this,Je)[Je]),e!=null&&(F(this,Je)[Je]=setTimeout(F(this,ds)[ds],e))}rateLimit(e){clearTimeout(F(this,xe)[xe]),this.pause(e),this.limit>1&&Number.isFinite(this.limit)&&(F(this,Ke)[Ke]=this.limit-1,this.limit=F(this,Z)[Z],F(this,xe)[xe]=setTimeout(F(this,Xe)[Xe],e))}get isPaused(){return F(this,ae)[ae]}}function Zd(r){F(this,ue)[ue]+=1;let e=!1,t;try{t=r()}catch(s){throw F(this,ue)[ue]-=1,s}return{abort:s=>{e||(e=!0,F(this,ue)[ue]-=1,t==null||t(s),F(this,qe)[qe]())},done:()=>{e||(e=!0,F(this,ue)[ue]-=1,F(this,qe)[qe]())}}}function ep(){queueMicrotask(()=>F(this,Ns)[Ns]())}function tp(){if(F(this,ae)[ae]||F(this,ue)[ue]>=this.limit||F(this,re)[re].length===0)return;const r=F(this,re)[re].shift();if(r==null)throw new Error("Invariant violation: next is null");const e=F(this,er)[er](r.fn);r.abort=e.abort,r.done=e.done}function rp(r,e){const t={fn:r,priority:(e==null?void 0:e.priority)||0,abort:()=>{F(this,Ls)[Ls](t)},done:()=>{throw new Error("Cannot mark a queued request as done: this indicates a bug")}},s=F(this,re)[re].findIndex(i=>t.priority>i.priority);return s===-1?F(this,re)[re].push(t):F(this,re)[re].splice(s,0,t),t}function sp(r){const e=F(this,re)[re].indexOf(r);e!==-1&&F(this,re)[re].splice(e,1)}function ip(r){const e=t=>"error"in t&&!!t.error;return r.filter(t=>!e(t))}function np(r){return r.filter(e=>{var t;return!((t=e.progress)!=null&&t.uploadStarted)||!e.isRestored})}const{AbortController:ps}=globalThis,So=function(r,e){r===void 0&&(r="Aborted");const t=new DOMException(r,"AbortError");return e!=null&&vo(e,"cause")&&Object.defineProperty(t,"cause",{__proto__:null,configurable:!0,writable:!0,value:e.cause}),t};function an(r,e){return r===!0?Object.keys(e):Array.isArray(r)?r:[]}function S(r,e){if(!{}.hasOwnProperty.call(r,e))throw new TypeError("attempted to use private field on non-instance");return r}var op=0;function z(r){return"__private_"+op+++"_"+r}const ap=1024*1024,ln={getChunkSize(r){return Math.ceil(r.size/1e4)},onProgress(){},onPartComplete(){},onSuccess(){},onError(r){throw r}};function lp(r){if(typeof r=="string")return parseInt(r,10);if(typeof r=="number")return r;throw new TypeError("Expected a number")}const Tr=Symbol("pausing upload, not an actual error");var K=z("abortController"),q=z("chunks"),te=z("chunkState"),ce=z("data"),pe=z("file"),tr=z("uploadHasStarted"),Bt=z("onError"),ht=z("onSuccess"),Be=z("shouldUseMultipart"),nt=z("isRestoring"),or=z("onReject"),Ze=z("maxMultipartParts"),Xt=z("minPartSize"),hs=z("initChunks"),fs=z("createUpload"),It=z("resumeUpload"),Qt=z("onPartProgress"),Yt=z("onPartComplete"),ms=z("abortUpload");class up{constructor(e,t){var s,i;Object.defineProperty(this,ms,{value:hp}),Object.defineProperty(this,It,{value:pp}),Object.defineProperty(this,fs,{value:dp}),Object.defineProperty(this,hs,{value:cp}),Object.defineProperty(this,K,{writable:!0,value:new ps}),Object.defineProperty(this,q,{writable:!0,value:[]}),Object.defineProperty(this,te,{writable:!0,value:[]}),Object.defineProperty(this,ce,{writable:!0,value:void 0}),Object.defineProperty(this,pe,{writable:!0,value:void 0}),Object.defineProperty(this,tr,{writable:!0,value:!1}),Object.defineProperty(this,Bt,{writable:!0,value:void 0}),Object.defineProperty(this,ht,{writable:!0,value:void 0}),Object.defineProperty(this,Be,{writable:!0,value:void 0}),Object.defineProperty(this,nt,{writable:!0,value:void 0}),Object.defineProperty(this,or,{writable:!0,value:n=>(n==null?void 0:n.cause)===Tr?null:S(this,Bt)[Bt](n)}),Object.defineProperty(this,Ze,{writable:!0,value:1e4}),Object.defineProperty(this,Xt,{writable:!0,value:5*ap}),Object.defineProperty(this,Qt,{writable:!0,value:n=>o=>{if(!o.lengthComputable)return;S(this,te)[te][n].uploaded=lp(o.loaded);const a=S(this,te)[te].reduce((l,u)=>l+u.uploaded,0);this.options.onProgress(a,S(this,ce)[ce].size)}}),Object.defineProperty(this,Yt,{writable:!0,value:n=>o=>{S(this,q)[q][n]=null,S(this,te)[te][n].etag=o,S(this,te)[te][n].done=!0;const a={PartNumber:n+1,ETag:o};this.options.onPartComplete(a)}}),this.options={...ln,...t},(i=(s=this.options).getChunkSize)!=null||(s.getChunkSize=ln.getChunkSize),S(this,ce)[ce]=e,S(this,pe)[pe]=t.file,S(this,ht)[ht]=this.options.onSuccess,S(this,Bt)[Bt]=this.options.onError,S(this,Be)[Be]=this.options.shouldUseMultipart,S(this,nt)[nt]=t.uploadId&&t.key,S(this,hs)[hs]()}start(){S(this,tr)[tr]?(S(this,K)[K].signal.aborted||S(this,K)[K].abort(Tr),S(this,K)[K]=new ps,S(this,It)[It]()):S(this,nt)[nt]?(this.options.companionComm.restoreUploadFile(S(this,pe)[pe],{uploadId:this.options.uploadId,key:this.options.key}),S(this,It)[It]()):S(this,fs)[fs]()}pause(){S(this,K)[K].abort(Tr),S(this,K)[K]=new ps}abort(e){e!=null&&e.really?S(this,ms)[ms]():this.pause()}[Symbol.for("uppy test: getChunkState")](){return S(this,te)[te]}}function cp(){const r=S(this,ce)[ce].size,e=typeof S(this,Be)[Be]=="function"?S(this,Be)[Be](S(this,pe)[pe]):!!S(this,Be)[Be];if(e&&r>S(this,Xt)[Xt]){let t=Math.max(this.options.getChunkSize(S(this,ce)[ce]),S(this,Xt)[Xt]),s=Math.floor(r/t);s>S(this,Ze)[Ze]&&(s=S(this,Ze)[Ze],t=r/S(this,Ze)[Ze]),S(this,q)[q]=Array(s);for(let i=0,n=0;i<r;i+=t,n++){const o=Math.min(r,i+t),a=()=>{const l=i;return S(this,ce)[ce].slice(l,o)};if(S(this,q)[q][n]={getData:a,onProgress:S(this,Qt)[Qt](n),onComplete:S(this,Yt)[Yt](n),shouldUseMultipart:e},S(this,nt)[nt]){const l=i+t>r?r-i:t;S(this,q)[q][n].setAsUploaded=()=>{S(this,q)[q][n]=null,S(this,te)[te][n].uploaded=l}}}}else S(this,q)[q]=[{getData:()=>S(this,ce)[ce],onProgress:S(this,Qt)[Qt](0),onComplete:S(this,Yt)[Yt](0),shouldUseMultipart:e}];S(this,te)[te]=S(this,q)[q].map(()=>({uploaded:0}))}function dp(){this.options.companionComm.uploadFile(S(this,pe)[pe],S(this,q)[q],S(this,K)[K].signal).then(S(this,ht)[ht],S(this,or)[or]),S(this,tr)[tr]=!0}function pp(){this.options.companionComm.resumeUploadFile(S(this,pe)[pe],S(this,q)[q],S(this,K)[K].signal).then(S(this,ht)[ht],S(this,or)[or])}function hp(){S(this,K)[K].abort(),this.options.companionComm.abortFileUpload(S(this,pe)[pe]).catch(r=>this.options.log(r))}function Q(r){if(r!=null&&r.aborted)throw So("The operation was aborted",{cause:r.reason})}function fp(r){let{method:e="PUT",CanonicalUri:t="/",CanonicalQueryString:s="",SignedHeaders:i,HashedPayload:n}=r;const o=Object.keys(i).map(a=>a.toLowerCase()).sort();return[e,t,s,...o.map(a=>`${a}:${i[a]}`),"",o.join(";"),n].join(`
`)}const ri=new TextEncoder,si={name:"HMAC",hash:"SHA-256"};async function mp(r){const{subtle:e}=globalThis.crypto;return e.digest(si.hash,ri.encode(r))}async function gp(r){const{subtle:e}=globalThis.crypto;return e.importKey("raw",typeof r=="string"?ri.encode(r):r,si,!1,["sign"])}function un(r){const e=new Uint8Array(r);let t="";for(let s=0;s<e.length;s++)t+=e[s].toString(16).padStart(2,"0");return t}async function Dt(r,e){const{subtle:t}=globalThis.crypto;return t.sign(si,await gp(r),ri.encode(e))}async function yp(r){let{accountKey:e,accountSecret:t,sessionToken:s,bucketName:i,Key:n,Region:o,expires:a,uploadId:l,partNumber:u}=r;const d="s3",c=`${d}.${o}.amazonaws.com`,p=`/${i}/${encodeURI(n).replace(/[;?:@&=+$,#!'()*]/g,B=>`%${B.charCodeAt(0).toString(16).toUpperCase()}`)}`,h="UNSIGNED-PAYLOAD",f=new Date().toISOString().replace(/[-:]|\.\d+/g,""),m=f.slice(0,8),y=`${m}/${o}/${d}/aws4_request`,v=new URL(`https://${c}${p}`);v.searchParams.set("X-Amz-Algorithm","AWS4-HMAC-SHA256"),v.searchParams.set("X-Amz-Content-Sha256",h),v.searchParams.set("X-Amz-Credential",`${e}/${y}`),v.searchParams.set("X-Amz-Date",f),v.searchParams.set("X-Amz-Expires",a),v.searchParams.set("X-Amz-Security-Token",s),v.searchParams.set("X-Amz-SignedHeaders","host"),u&&v.searchParams.set("partNumber",u),l&&v.searchParams.set("uploadId",l),v.searchParams.set("x-id",u&&l?"UploadPart":"PutObject");const _=fp({CanonicalUri:p,CanonicalQueryString:v.search.slice(1),SignedHeaders:{host:c},HashedPayload:h}),A=un(await mp(_)),k=["AWS4-HMAC-SHA256",f,y,A].join(`
`),P=await Dt(`AWS4${t}`,m),E=await Dt(P,o),T=await Dt(E,d),U=await Dt(T,"aws4_request"),M=un(await Dt(U,k));return v.searchParams.set("X-Amz-Signature",M),v}function O(r,e){if(!{}.hasOwnProperty.call(r,e))throw new TypeError("attempted to use private field on non-instance");return r}var vp=0;function se(r){return"__private_"+vp+++"_"+r}function bp(r){const e=new URL(r);return e.search="",e.hash="",e.href}var qt=se("abortMultipartUpload"),W=se("cache"),zt=se("createMultipartUpload"),Ht=se("fetchSignature"),rr=se("getUploadParameters"),Wt=se("listParts"),et=se("previousRetryDelay"),ot=se("requests"),Qe=se("retryDelays"),Ye=se("sendCompletionRequest"),Le=se("setS3MultipartState"),at=se("uploadPartBytes"),G=se("getFile"),gs=se("shouldRetry"),Vt=se("nonMultipartUpload");class wp{constructor(e,t,s,i){Object.defineProperty(this,Vt,{value:Sp}),Object.defineProperty(this,gs,{value:_p}),Object.defineProperty(this,qt,{writable:!0,value:void 0}),Object.defineProperty(this,W,{writable:!0,value:new WeakMap}),Object.defineProperty(this,zt,{writable:!0,value:void 0}),Object.defineProperty(this,Ht,{writable:!0,value:void 0}),Object.defineProperty(this,rr,{writable:!0,value:void 0}),Object.defineProperty(this,Wt,{writable:!0,value:void 0}),Object.defineProperty(this,et,{writable:!0,value:void 0}),Object.defineProperty(this,ot,{writable:!0,value:void 0}),Object.defineProperty(this,Qe,{writable:!0,value:void 0}),Object.defineProperty(this,Ye,{writable:!0,value:void 0}),Object.defineProperty(this,Le,{writable:!0,value:void 0}),Object.defineProperty(this,at,{writable:!0,value:void 0}),Object.defineProperty(this,G,{writable:!0,value:void 0}),O(this,ot)[ot]=e,O(this,Le)[Le]=s,O(this,G)[G]=i,this.setOptions(t)}setOptions(e){const t=O(this,ot)[ot];if("abortMultipartUpload"in e&&(O(this,qt)[qt]=t.wrapPromiseFunction(e.abortMultipartUpload,{priority:1})),"createMultipartUpload"in e&&(O(this,zt)[zt]=t.wrapPromiseFunction(e.createMultipartUpload,{priority:-1})),"signPart"in e&&(O(this,Ht)[Ht]=t.wrapPromiseFunction(e.signPart)),"listParts"in e&&(O(this,Wt)[Wt]=t.wrapPromiseFunction(e.listParts)),"completeMultipartUpload"in e&&(O(this,Ye)[Ye]=t.wrapPromiseFunction(e.completeMultipartUpload,{priority:1})),"retryDelays"in e){var s;O(this,Qe)[Qe]=(s=e.retryDelays)!=null?s:[]}"uploadPartBytes"in e&&(O(this,at)[at]=t.wrapPromiseFunction(e.uploadPartBytes,{priority:1/0})),"getUploadParameters"in e&&(O(this,rr)[rr]=t.wrapPromiseFunction(e.getUploadParameters))}async getUploadId(e,t){let s;for(;(s=O(this,W)[W].get(e.data))!=null;)try{return await s}catch{}const i=O(this,zt)[zt](O(this,G)[G](e),t),n=()=>{i.abort(t.reason),O(this,W)[W].delete(e.data)};return t.addEventListener("abort",n,{once:!0}),O(this,W)[W].set(e.data,i),i.then(async o=>{t.removeEventListener("abort",n),O(this,Le)[Le](e,o),O(this,W)[W].set(e.data,o)},()=>{t.removeEventListener("abort",n),O(this,W)[W].delete(e.data)}),i}async abortFileUpload(e){const t=O(this,W)[W].get(e.data);if(t==null)return;O(this,W)[W].delete(e.data),O(this,Le)[Le](e,Object.create(null));let s;try{s=await t}catch{return}await O(this,qt)[qt](O(this,G)[G](e),s)}async uploadFile(e,t,s){if(Q(s),t.length===1&&!t[0].shouldUseMultipart)return O(this,Vt)[Vt](e,t[0],s);const{uploadId:i,key:n}=await this.getUploadId(e,s);Q(s);try{const o=await Promise.all(t.map((a,l)=>this.uploadChunk(e,l+1,a,s)));return Q(s),await O(this,Ye)[Ye](O(this,G)[G](e),{key:n,uploadId:i,parts:o,signal:s},s).abortOn(s)}catch(o){throw(o==null?void 0:o.cause)!==Tr&&(o==null?void 0:o.name)!=="AbortError"&&this.abortFileUpload(e),o}}restoreUploadFile(e,t){O(this,W)[W].set(e.data,t)}async resumeUploadFile(e,t,s){if(Q(s),t.length===1&&t[0]!=null&&!t[0].shouldUseMultipart)return O(this,Vt)[Vt](e,t[0],s);const{uploadId:i,key:n}=await this.getUploadId(e,s);Q(s);const o=await O(this,Wt)[Wt](O(this,G)[G](e),{uploadId:i,key:n,signal:s},s).abortOn(s);Q(s);const a=await Promise.all(t.map((l,u)=>{const d=u+1,c=o.find(p=>{let{PartNumber:h}=p;return h===d});return c==null?this.uploadChunk(e,d,l,s):(l==null||l.setAsUploaded==null||l.setAsUploaded(),{PartNumber:d,ETag:c.ETag})}));return Q(s),O(this,Ye)[Ye](O(this,G)[G](e),{key:n,uploadId:i,parts:a,signal:s},s).abortOn(s)}async uploadChunk(e,t,s,i){Q(i);const{uploadId:n,key:o}=await this.getUploadId(e,i),a=O(this,Qe)[Qe].values(),l=O(this,Qe)[Qe].values(),u=()=>{const d=a.next();return d==null||d.done?null:d.value};for(;;){Q(i);const d=s.getData(),{onProgress:c,onComplete:p}=s;let h;try{h=await O(this,Ht)[Ht](O(this,G)[G](e),{uploadId:n,key:o,partNumber:t,body:d,signal:i}).abortOn(i)}catch(f){const m=u();if(m==null||i.aborted)throw f;await new Promise(y=>setTimeout(y,m));continue}Q(i);try{return{PartNumber:t,...await O(this,at)[at]({signature:h,body:d,size:d.size,onProgress:c,onComplete:p,signal:i}).abortOn(i)}}catch(f){if(!await O(this,gs)[gs](f,l))throw f}}}}async function _p(r,e){var t;const s=O(this,ot)[ot],i=r==null||(t=r.source)==null?void 0:t.status;if(i==null)return!1;if(i===403&&r.message==="Request has expired"){if(!s.isPaused){if(s.limit===1||O(this,et)[et]==null){const n=e.next();if(n==null||n.done)return!1;O(this,et)[et]=n.value}s.rateLimit(0),await new Promise(n=>setTimeout(n,O(this,et)[et]))}}else if(i===429){if(!s.isPaused){const n=e.next();if(n==null||n.done)return!1;s.rateLimit(n.value)}}else{if(i>400&&i<500&&i!==409)return!1;if(typeof navigator<"u"&&navigator.onLine===!1)s.isPaused||(s.pause(),window.addEventListener("online",()=>{s.resume()},{once:!0}));else{const n=e.next();if(n==null||n.done)return!1;await new Promise(o=>setTimeout(o,n.value))}}return!0}async function Sp(r,e,t){var s;const{method:i="POST",url:n,fields:o,headers:a}=await O(this,rr)[rr](O(this,G)[G](r),{signal:t}).abortOn(t);let l;const u=e.getData();if(i.toUpperCase()==="POST"){const f=new FormData;Object.entries(o).forEach(m=>{let[y,v]=m;return f.set(y,v)}),f.set("file",u),l=f}else l=u;const{onProgress:d,onComplete:c}=e,p=await O(this,at)[at]({signature:{url:n,headers:a,method:i},body:l,size:u.size,onProgress:d,onComplete:c,signal:t}).abortOn(t),h=o==null?void 0:o.key;return O(this,Le)[Le](r,{key:h}),{...p,location:(s=p.location)!=null?s:bp(n),bucket:o==null?void 0:o.bucket,key:h}}function C(r,e){if(!{}.hasOwnProperty.call(r,e))throw new TypeError("attempted to use private field on non-instance");return r}var Pp=0;function oe(r){return"__private_"+Pp+++"_"+r}const Ep={version:"4.2.3"};function mt(r){if(r!=null&&r.error){const e=new Error(r.message);throw Object.assign(e,r.error),e}return r}function Po(r){const e=r.Expiration;if(e){const t=Math.floor((new Date(e)-Date.now())/1e3);if(t>9)return t}}function cn(r){let{meta:e,allowedMetaFields:t,querify:s=!1}=r;const i=t??Object.keys(e);return e?Object.fromEntries(i.filter(n=>e[n]!=null).map(n=>{const o=s?`metadata[${n}]`:n,a=String(e[n]);return[o,a]})):{}}const Tp={allowedMetaFields:!0,limit:6,getTemporarySecurityCredentials:!1,shouldUseMultipart:r=>(r.size||0)>100*1024*1024,retryDelays:[0,1e3,3e3,5e3]};var lt=oe("companionCommunicationQueue"),L=oe("client"),Gt=oe("setClient"),ee=oe("assertHost"),V=oe("cachedTemporaryCredentials"),ys=oe("getTemporarySecurityCredentials"),vs=oe("setS3MultipartState"),pt=oe("getFile"),bs=oe("uploadLocalFile"),ws=oe("getCompanionClientArgs"),Jt=oe("upload"),ut=oe("setCompanionHeaders"),Me=oe("setResumableUploadsCapability"),Kt=oe("resetResumableCapability");class ur extends ao{constructor(e,t){var s;super(e,{...Tp,uploadPartBytes:ur.uploadPartBytes,createMultipartUpload:null,listParts:null,abortMultipartUpload:null,completeMultipartUpload:null,signPart:null,getUploadParameters:null,...t}),Object.defineProperty(this,ws,{value:Ap}),Object.defineProperty(this,bs,{value:Op}),Object.defineProperty(this,ys,{value:Fp}),Object.defineProperty(this,ee,{value:Cp}),Object.defineProperty(this,Gt,{value:kp}),Object.defineProperty(this,lt,{writable:!0,value:void 0}),Object.defineProperty(this,L,{writable:!0,value:void 0}),Object.defineProperty(this,V,{writable:!0,value:void 0}),Object.defineProperty(this,vs,{writable:!0,value:(n,o)=>{let{key:a,uploadId:l}=o;const u=this.uppy.getFile(n.id);u!=null&&this.uppy.setFileState(n.id,{s3Multipart:{...u.s3Multipart,key:a,uploadId:l}})}}),Object.defineProperty(this,pt,{writable:!0,value:n=>this.uppy.getFile(n.id)||n}),Object.defineProperty(this,Jt,{writable:!0,value:async n=>{if(n.length===0)return;const o=this.uppy.getFilesByIds(n),a=ip(o),l=np(a);this.uppy.emit("upload-start",l);const u=a.map(c=>{if(c.isRemote){const p=()=>this.requests;C(this,Me)[Me](!1);const h=new AbortController,f=y=>{y.id===c.id&&h.abort()};this.uppy.on("file-removed",f);const m=this.uppy.getRequestClientForFile(c).uploadRemoteFile(c,C(this,ws)[ws](c),{signal:h.signal,getQueue:p});return this.requests.wrapSyncFunction(()=>{this.uppy.off("file-removed",f)},{priority:-1})(),m}return C(this,bs)[bs](c)}),d=await Promise.allSettled(u);return C(this,Me)[Me](!0),d}}),Object.defineProperty(this,ut,{writable:!0,value:()=>{var n;(n=C(this,L)[L])==null||n.setCompanionHeaders(this.opts.headers)}}),Object.defineProperty(this,Me,{writable:!0,value:n=>{const{capabilities:o}=this.uppy.getState();this.uppy.setState({capabilities:{...o,resumableUploads:n}})}}),Object.defineProperty(this,Kt,{writable:!0,value:()=>{C(this,Me)[Me](!0)}}),this.type="uploader",this.id=this.opts.id||"AwsS3Multipart",C(this,Gt)[Gt](t);const i={createMultipartUpload:this.createMultipartUpload,listParts:this.listParts,abortMultipartUpload:this.abortMultipartUpload,completeMultipartUpload:this.completeMultipartUpload,signPart:t!=null&&t.getTemporarySecurityCredentials?this.createSignedURL:this.signPart,getUploadParameters:t!=null&&t.getTemporarySecurityCredentials?this.createSignedURL:this.getUploadParameters};for(const n of Object.keys(i))this.opts[n]==null&&(this.opts[n]=i[n].bind(this));this.requests=(s=this.opts.rateLimitedQueue)!=null?s:new Yd(this.opts.limit),C(this,lt)[lt]=new wp(this.requests,this.opts,C(this,vs)[vs],C(this,pt)[pt]),this.uploaders=Object.create(null),this.uploaderEvents=Object.create(null)}[Symbol.for("uppy test: getClient")](){return C(this,L)[L]}setOptions(e){C(this,lt)[lt].setOptions(e),super.setOptions(e),C(this,Gt)[Gt](e)}resetUploaderReferences(e,t){this.uploaders[e]&&(this.uploaders[e].abort({really:(t==null?void 0:t.abort)||!1}),this.uploaders[e]=null),this.uploaderEvents[e]&&(this.uploaderEvents[e].remove(),this.uploaderEvents[e]=null)}createMultipartUpload(e,t){C(this,ee)[ee]("createMultipartUpload"),Q(t);const s=an(this.opts.allowedMetaFields,e.meta),i=cn({meta:e.meta,allowedMetaFields:s});return C(this,L)[L].post("s3/multipart",{filename:e.name,type:e.type,metadata:i},{signal:t}).then(mt)}listParts(e,t,s){var i;let{key:n,uploadId:o,signal:a}=t;(i=a)!=null||(a=s),C(this,ee)[ee]("listParts"),Q(a);const l=encodeURIComponent(n);return C(this,L)[L].get(`s3/multipart/${encodeURIComponent(o)}?key=${l}`,{signal:a}).then(mt)}completeMultipartUpload(e,t,s){var i;let{key:n,uploadId:o,parts:a,signal:l}=t;(i=l)!=null||(l=s),C(this,ee)[ee]("completeMultipartUpload"),Q(l);const u=encodeURIComponent(n),d=encodeURIComponent(o);return C(this,L)[L].post(`s3/multipart/${d}/complete?key=${u}`,{parts:a.map(c=>{let{ETag:p,PartNumber:h}=c;return{ETag:p,PartNumber:h}})},{signal:l}).then(mt)}async createSignedURL(e,t){const s=await C(this,ys)[ys](t),i=Po(s.credentials)||604800,{uploadId:n,key:o,partNumber:a}=t;return{method:"PUT",expires:i,fields:{},url:`${await yp({accountKey:s.credentials.AccessKeyId,accountSecret:s.credentials.SecretAccessKey,sessionToken:s.credentials.SessionToken,expires:i,bucketName:s.bucket,Region:s.region,Key:o??`${crypto.randomUUID()}-${e.name}`,uploadId:n,partNumber:a})}`,headers:{"Content-Type":e.type}}}signPart(e,t){let{uploadId:s,key:i,partNumber:n,signal:o}=t;if(C(this,ee)[ee]("signPart"),Q(o),s==null||i==null||n==null)throw new Error("Cannot sign without a key, an uploadId, and a partNumber");const a=encodeURIComponent(i);return C(this,L)[L].get(`s3/multipart/${encodeURIComponent(s)}/${n}?key=${a}`,{signal:o}).then(mt)}abortMultipartUpload(e,t){let{key:s,uploadId:i,signal:n}=t;C(this,ee)[ee]("abortMultipartUpload");const o=encodeURIComponent(s),a=encodeURIComponent(i);return C(this,L)[L].delete(`s3/multipart/${a}?key=${o}`,void 0,{signal:n}).then(mt)}getUploadParameters(e,t){C(this,ee)[ee]("getUploadParameters");const{meta:s}=e,{type:i,name:n}=s,o=an(this.opts.allowedMetaFields,e.meta),a=cn({meta:s,allowedMetaFields:o,querify:!0}),l=new URLSearchParams({filename:n,type:i,...a});return C(this,L)[L].get(`s3/params?${l}`,t)}static async uploadPartBytes(e){let{signature:{url:t,expires:s,headers:i,method:n="PUT"},body:o,size:a=o.size,onProgress:l,onComplete:u,signal:d}=e;if(Q(d),t==null)throw new Error("Cannot upload to an undefined URL");return new Promise((c,p)=>{const h=new XMLHttpRequest;h.open(n,t,!0),i&&Object.keys(i).forEach(y=>{h.setRequestHeader(y,i[y])}),h.responseType="text",typeof s=="number"&&(h.timeout=s*1e3);function f(){h.abort()}function m(){d==null||d.removeEventListener("abort",f)}d==null||d.addEventListener("abort",f),h.upload.addEventListener("progress",y=>{l(y)}),h.addEventListener("abort",()=>{m(),p(So())}),h.addEventListener("timeout",()=>{m();const y=new Error("Request has expired");y.source={status:403},p(y)}),h.addEventListener("load",()=>{if(m(),h.status===403&&h.responseText.includes("<Message>Request has expired</Message>")){const k=new Error("Request has expired");k.source=h,p(k);return}if(h.status<200||h.status>=300){const k=new Error("Non 2xx");k.source=h,p(k);return}l==null||l({loaded:a,lengthComputable:!0});const y=h.getAllResponseHeaders().trim().split(/[\r\n]+/),v={__proto__:null};for(const k of y){const P=k.split(": "),E=P.shift(),T=P.join(": ");v[E]=T}const{etag:_,location:A}=v;if(n.toUpperCase()==="POST"&&A==null&&console.error("@uppy/aws-s3: Could not read the Location header. This likely means CORS is not configured correctly on the S3 Bucket. See https://uppy.io/docs/aws-s3/#setting-up-your-s3-bucket"),_==null){console.error("@uppy/aws-s3: Could not read the ETag header. This likely means CORS is not configured correctly on the S3 Bucket. See https://uppy.io/docs/aws-s3/#setting-up-your-s3-bucket");return}u==null||u(_),c({...v,ETag:_})}),h.addEventListener("error",y=>{m();const v=new Error("Unknown error");v.source=y.target,p(v)}),h.send(o)})}install(){C(this,Me)[Me](!0),this.uppy.addPreProcessor(C(this,ut)[ut]),this.uppy.addUploader(C(this,Jt)[Jt]),this.uppy.on("cancel-all",C(this,Kt)[Kt])}uninstall(){this.uppy.removePreProcessor(C(this,ut)[ut]),this.uppy.removeUploader(C(this,Jt)[Jt]),this.uppy.off("cancel-all",C(this,Kt)[Kt])}}function kp(r){r==null||!("endpoint"in r||"companionUrl"in r||"headers"in r||"companionHeaders"in r||"cookiesRule"in r||"companionCookiesRule"in r)||("companionUrl"in r&&!("endpoint"in r)&&this.uppy.log("`companionUrl` option has been removed in @uppy/aws-s3, use `endpoint` instead.","warning"),"companionHeaders"in r&&!("headers"in r)&&this.uppy.log("`companionHeaders` option has been removed in @uppy/aws-s3, use `headers` instead.","warning"),"companionCookiesRule"in r&&!("cookiesRule"in r)&&this.uppy.log("`companionCookiesRule` option has been removed in @uppy/aws-s3, use `cookiesRule` instead.","warning"),"endpoint"in r?C(this,L)[L]=new wo(this.uppy,{pluginId:this.id,provider:"AWS",companionUrl:this.opts.endpoint,companionHeaders:this.opts.headers,companionCookiesRule:this.opts.cookiesRule}):("headers"in r&&C(this,ut)[ut](),"cookiesRule"in r&&(C(this,L)[L].opts.companionCookiesRule=r.cookiesRule)))}function Cp(r){if(!C(this,L)[L])throw new Error(`Expected a \`endpoint\` option containing a URL, or if you are not using Companion, a custom \`${r}\` implementation.`)}async function Fp(r){if(Q(r==null?void 0:r.signal),C(this,V)[V]==null){const{getTemporarySecurityCredentials:e}=this.opts;e===!0?(C(this,ee)[ee]("getTemporarySecurityCredentials"),C(this,V)[V]=C(this,L)[L].get("s3/sts",r).then(mt)):C(this,V)[V]=e(r),C(this,V)[V]=await C(this,V)[V],setTimeout(()=>{C(this,V)[V]=null},(Po(C(this,V)[V].credentials)||0)*500)}return C(this,V)[V]}function Op(r){var e=this;return new Promise((t,s)=>{const i=(u,d)=>{var c;const p=this.uppy.getFile(r.id);this.uppy.emit("upload-progress",p,{uploadStarted:(c=p.progress.uploadStarted)!=null?c:0,bytesUploaded:u,bytesTotal:d})},n=u=>{this.uppy.log(u),this.uppy.emit("upload-error",r,u),this.resetUploaderReferences(r.id),s(u)},o=u=>{const d={body:{...u},status:200,uploadURL:u.location};this.resetUploaderReferences(r.id),this.uppy.emit("upload-success",C(this,pt)[pt](r),d),u.location&&this.uppy.log(`Download ${r.name} from ${u.location}`),t()},a=new up(r.data,{companionComm:C(this,lt)[lt],log:function(){return e.uppy.log(...arguments)},getChunkSize:this.opts.getChunkSize?this.opts.getChunkSize.bind(this):void 0,onProgress:i,onError:n,onSuccess:o,onPartComplete:u=>{this.uppy.emit("s3-multipart:part-uploaded",C(this,pt)[pt](r),u)},file:r,shouldUseMultipart:this.opts.shouldUseMultipart,...r.s3Multipart});this.uploaders[r.id]=a;const l=new Kd(this.uppy);this.uploaderEvents[r.id]=l,l.onFileRemove(r.id,u=>{a.abort(),this.resetUploaderReferences(r.id,{abort:!0}),t(`upload ${u} was removed`)}),l.onCancelAll(r.id,()=>{a.abort(),this.resetUploaderReferences(r.id,{abort:!0}),t(`upload ${r.id} was canceled`)}),l.onFilePause(r.id,u=>{u?a.pause():a.start()}),l.onPauseAll(r.id,()=>{a.pause()}),l.onResumeAll(r.id,()=>{a.start()}),a.start()})}function Ap(r){var e;return{...(e=r.remote)==null?void 0:e.body,protocol:"s3-multipart",size:r.data.size,metadata:r.meta}}ur.VERSION=Ep.version;window.Uppy=Js;window.UppyDragDrop=Wr;window.UppyStatusBar=ei;window.UppyProgressBar=ti;window.UppyFileInput=mo;window.UppyAwsS3=ur;window.createUppy=function(r={}){const e={debug:!1,autoProceed:!1,allowMultipleUploads:!1,restrictions:{maxFileSize:209715200,allowedFileTypes:window.defaultAllowedFileTypes||["audio/*","video/*","application/pdf","image/*","application/zip"]}},t={...e,...r,restrictions:{...e.restrictions,...r.restrictions||{}}};return new Js(t)};window.fetchUploadSettings=async function(r="global"){try{const e=await fetch(`/api/upload-settings/${r}`,{headers:{"X-CSRF-TOKEN":window.getCSRFToken(),Accept:"application/json","Content-Type":"application/json"},credentials:"same-origin"});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const t=await e.json();return console.log("Upload settings fetched:",t),t}catch(e){return console.error("Failed to fetch upload settings:",e),{settings:{max_file_size_mb:200,chunk_size_mb:5,max_concurrent_uploads:3,max_retry_attempts:3,enable_chunking:!0,session_timeout_hours:24},computed:{uppy_restrictions:{maxFileSize:200*1024*1024,allowedFileTypes:window.defaultAllowedFileTypes||["audio/*","video/*","application/pdf","image/*","application/zip"]},upload_config:{chunkSize:5*1024*1024,limit:3,retryDelays:[1e3,1e3,1e3]}}}}};window.createUppyWithSettings=async function(r="global",e={}){const t=await window.fetchUploadSettings(r),s={debug:!1,autoProceed:!1,allowMultipleUploads:!1,restrictions:t.computed.uppy_restrictions,...e},i=window.createUppy(s);return i.uploadSettings=t,i};window.getCSRFToken=function(){var r;return((r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.getAttribute("content"))||""};window.getAPIToken=function(){return""};console.log("Uppy configuration loaded");class Eo{constructor(){this.waveSurfer=null,this.currentTrack=null,this.isInitialized=!1,this.mediaSession=null,this.livewireComponent=null,this.alpineStore=null,this.lastPositionUpdate=0,this.currentContainer=null,this.playbackState={isPlaying:!1,currentPosition:0,duration:0,volume:1,isMuted:!1},this.loopState={enabled:!1,start:null,end:null},this.visualData={peaks:null,duration:null},this.config={container:"#global-waveform-persistent",fallbackContainer:"#global-waveform",waveColor:"rgba(139, 92, 246, 0.3)",progressColor:"rgba(139, 92, 246, 0.8)",cursorColor:"#8B5CF6",height:32,normalize:!0,responsive:!0,fillParent:!0,interact:!0,dragToSeek:!0,hideScrollbar:!0,barWidth:2,barGap:1,barRadius:2},this.init()}init(){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{this.setupEventListeners(),this.initializePersistentContainer()}):(this.setupEventListeners(),this.initializePersistentContainer()),this.initializeMediaSession(),document.addEventListener("visibilitychange",()=>this.handleVisibilityChange()),this.initializeServiceWorkerCommunication(),this.setupCommentMarkerListeners()}setupEventListeners(){Livewire.on("globalPlayerTrackChanged",e=>{const t=e.track,{peaks:s,duration:i}=this.extractVisualizationFromTrack(t);s&&s.length?this.loadTrackWithPeaks(t,s,i||(t==null?void 0:t.duration)||null):this.loadTrack(t),this.alpineStore&&e.queue&&(this.alpineStore.queue=e.queue,this.alpineStore.queuePosition=e.queuePosition||0)}),Livewire.on("startPlayback",()=>{this.play()}),Livewire.on("pausePlayback",()=>{this.pause()}),Livewire.on("resumePlayback",()=>{this.play()}),Livewire.on("stopPlayback",()=>{this.stop()}),Livewire.on("seekToPosition",e=>{this.seekTo(e.timestamp)}),Livewire.on("volumeChanged",e=>{this.setVolume(e.volume)}),Livewire.on("muteToggled",e=>{this.setMute(e.muted)}),Livewire.on("updateMediaSession",e=>{this.updateMediaSessionState(e)})}initializePersistentContainer(){const e=document.getElementById("persistent-waveform-container");let t=document.getElementById("persistent-audio-element");e&&(t||(t=document.createElement("audio"),t.id="persistent-audio-element",t.style.display="none",document.body.appendChild(t)),t.preload="metadata",t.crossOrigin="anonymous",this.isInitialized||this.initializeWaveSurfer("#global-waveform-persistent"))}initializeWaveSurfer(e=null,t={}){var n,o;if(this.waveSurfer)return e&&e!==this.currentContainer?this.switchContainer(e):!0;const s=e||this.config.container;let i=document.querySelector(s);if(!i&&s!==this.config.fallbackContainer&&(i=document.querySelector(this.config.fallbackContainer)),!i)return!1;try{this.currentContainer=s;const a=document.getElementById("persistent-audio-element"),l=s.includes("full"),u={...this.config,container:i,height:l?120:32,waveColor:l?"rgba(139, 92, 246, 0.2)":"rgba(139, 92, 246, 0.3)",progressColor:l?"rgba(139, 92, 246, 0.9)":"rgba(139, 92, 246, 0.8)",barWidth:l?3:2,barGap:l?2:1};if(t&&(t.peaks||t.duration)&&(this.visualData.peaks=t.peaks||this.visualData.peaks,this.visualData.duration=t.duration||this.visualData.duration),this.visualData&&(this.visualData.peaks||this.visualData.duration)){if(this.visualData.peaks){const c=Array.isArray(this.visualData.peaks)?this.visualData.peaks:[];u.peaks=c.map(p=>p instanceof Float32Array?p:new Float32Array(p))}this.visualData.duration&&(u.duration=this.visualData.duration)}if(a||(a=document.getElementById("persistent-audio-element"),a||(a=document.createElement("audio"),a.id="persistent-audio-element",a.style.display="none",document.body.appendChild(a))),!0&&a){if(a.preload="metadata",a.crossOrigin="anonymous",u.media=a,this.waveSurfer=WaveSurfer.create(u),u.peaks&&((n=this.waveSurfer)!=null&&n.drawBuffer))try{this.waveSurfer.drawBuffer()}catch{}this.usingMediaElement=!0}else{if(this.waveSurfer=WaveSurfer.create(u),u.peaks&&((o=this.waveSurfer)!=null&&o.drawBuffer))try{this.waveSurfer.drawBuffer()}catch{}this.usingMediaElement=!1}return this.setupWaveSurferEvents(),this.isInitialized=!0,!0}catch{return!1}}switchContainer(e){if(!this.waveSurfer)return!1;const t=document.querySelector(e);if(!t)return!1;try{const s=this.playbackState.isPlaying,i=this.playbackState.currentPosition,n=this.currentTrack,o=this.waveSurfer.getMediaElement?this.waveSurfer.getMediaElement():document.getElementById("persistent-audio-element"),a=e.includes("full"),l={...this.config,container:t,height:a?120:32,waveColor:a?"rgba(139, 92, 246, 0.2)":"rgba(139, 92, 246, 0.3)",progressColor:a?"rgba(139, 92, 246, 0.9)":"rgba(139, 92, 246, 0.8)",barWidth:a?3:2,barGap:a?2:1};if(this.visualData&&(this.visualData.peaks||this.visualData.duration)){if(this.visualData.peaks){const d=Array.isArray(this.visualData.peaks)?this.visualData.peaks:[];l.peaks=d.map(c=>c instanceof Float32Array?c:new Float32Array(c))}this.visualData.duration&&(l.duration=this.visualData.duration)}const u=this.waveSurfer;return(this.usingMediaElement&&o||o)&&(l.media=o),this.waveSurfer=WaveSurfer.create(l),this.currentContainer=e,this.setupWaveSurferEvents(),n&&o&&this.waveSurfer.on("ready",()=>{i>0&&this.seekTo(i),s&&!this.playbackState.isPlaying&&this.play()}),setTimeout(()=>{u&&u!==this.waveSurfer&&u.destroy()},100),!0}catch{return!1}}setupAudioElementEvents(e){e&&(e.removeEventListener("play",this.audioElementPlayHandler),e.removeEventListener("pause",this.audioElementPauseHandler),e.removeEventListener("ended",this.audioElementEndedHandler),e.removeEventListener("timeupdate",this.audioElementTimeUpdateHandler),e.removeEventListener("seeking",this.audioElementSeekingHandler),this.audioElementPlayHandler=()=>{this.playbackState.isPlaying=!0,this.alpineStore&&this.alpineStore.updatePlaybackState(!0),this.updateLivewireComponent("playbackStarted"),this.updateMediaSessionPlaybackState("playing")},this.audioElementPauseHandler=()=>{this.playbackState.isPlaying=!1,this.alpineStore&&this.alpineStore.updatePlaybackState(!1),this.updateLivewireComponent("playbackPaused"),this.updateMediaSessionPlaybackState("paused")},this.audioElementEndedHandler=()=>{this.playbackState.isPlaying=!1,this.playbackState.currentPosition=0,this.updateLivewireComponent("trackEnded"),this.updateMediaSessionPlaybackState("none")},this.audioElementTimeUpdateHandler=()=>{this.playbackState.currentPosition=e.currentTime,this.throttlePositionUpdate(),this.loopState.enabled&&this.loopState.start!==null&&this.loopState.end!==null&&this.playbackState.currentPosition>=this.loopState.end&&(e.currentTime=this.loopState.start)},this.audioElementSeekingHandler=()=>{this.playbackState.currentPosition=e.currentTime,this.alpineStore&&(this.alpineStore.currentPosition=this.playbackState.currentPosition),this.callLivewireMethod("updatePosition",this.playbackState.currentPosition)},e.addEventListener("play",this.audioElementPlayHandler),e.addEventListener("pause",this.audioElementPauseHandler),e.addEventListener("ended",this.audioElementEndedHandler),e.addEventListener("timeupdate",this.audioElementTimeUpdateHandler),e.addEventListener("seeking",this.audioElementSeekingHandler))}setupWaveSurferEvents(){this.waveSurfer&&(this.usingMediaElement||(this.waveSurfer.on("ready",()=>{this.playbackState.duration=this.waveSurfer.getDuration(),this.alpineStore&&(this.alpineStore.duration=this.playbackState.duration,this.alpineStore.clearLoading()),this.callLivewireMethod("updateDuration",this.playbackState.duration),this.updateLivewireComponent("waveformReady")}),this.waveSurfer.on("play",()=>{this.playbackState.isPlaying=!0,this.alpineStore&&this.alpineStore.updatePlaybackState(!0),this.updateLivewireComponent("playbackStarted"),this.updateMediaSessionPlaybackState("playing")}),this.waveSurfer.on("pause",()=>{this.playbackState.isPlaying=!1,this.alpineStore&&this.alpineStore.updatePlaybackState(!1),this.updateLivewireComponent("playbackPaused"),this.updateMediaSessionPlaybackState("paused")}),this.waveSurfer.on("finish",()=>{this.playbackState.isPlaying=!1,this.playbackState.currentPosition=0,this.updateLivewireComponent("trackEnded"),this.updateMediaSessionPlaybackState("none")}),this.waveSurfer.on("audioprocess",()=>{this.playbackState.currentPosition=this.waveSurfer.getCurrentTime(),this.throttlePositionUpdate(),this.loopState.enabled&&this.loopState.start!==null&&this.loopState.end!==null&&this.playbackState.currentPosition>=this.loopState.end&&this.seekTo(this.loopState.start)}),this.waveSurfer.on("seek",()=>{this.playbackState.currentPosition=this.waveSurfer.getCurrentTime(),this.alpineStore&&(this.alpineStore.currentPosition=this.playbackState.currentPosition),this.callLivewireMethod("updatePosition",this.playbackState.currentPosition)})))}loadTrack(e,t={}){var s;if(!(!e||!e.url)){if(this.alpineStore&&this.alpineStore.setLoading("Loading track..."),this.currentTrack=e,!(t!=null&&t.peaks)&&(e!=null&&e.waveform_data||e!=null&&e.waveform_peaks)){const i=this.extractVisualizationFromTrack(e);if(i.peaks&&i.peaks.length&&(this.visualData.peaks=i.peaks,this.visualData.duration=i.duration||e.duration||this.visualData.duration,this.isInitialized)){const n=this.currentContainer||this.config.container;try{(s=this.waveSurfer)==null||s.destroy()}catch{}this.waveSurfer=null,this.isInitialized=!1,this.initializeWaveSurfer(n,this.visualData)}}if(t&&(t.peaks||t.duration)&&(this.visualData.peaks=t.peaks||this.visualData.peaks,this.visualData.duration=t.duration||this.visualData.duration,this.isInitialized)){const i=this.currentContainer||this.config.container;try{this.waveSurfer&&this.waveSurfer.destroy()}catch{}this.waveSurfer=null,this.isInitialized=!1,this.initializeWaveSurfer(i,this.visualData)}if(!this.isInitialized&&!this.initializeWaveSurfer()){this.alpineStore&&this.alpineStore.clearLoading();return}try{if(this.usingMediaElement){const i=document.getElementById("persistent-audio-element");i?(i.src=e.url,this.waveSurfer.setMediaElement&&typeof this.waveSurfer.setMediaElement=="function"&&this.waveSurfer.setMediaElement(i),this.setupAudioElementEvents(i),i.addEventListener("loadedmetadata",()=>{this.playbackState.duration=i.duration||0,this.alpineStore&&(this.alpineStore.duration=this.playbackState.duration,this.alpineStore.clearLoading()),this.callLivewireMethod("updateDuration",this.playbackState.duration),this.updateLivewireComponent("waveformReady")},{once:!0})):this.waveSurfer.load(e.url)}else this.waveSurfer.load(e.url);this.updateMediaSessionMetadata(e),this.saveCurrentTrack(e)}catch{this.alpineStore&&this.alpineStore.clearLoading()}}}extractVisualizationFromTrack(e){try{let t=(e==null?void 0:e.waveform_peaks)??(e==null?void 0:e.waveform_peaks_array)??(e==null?void 0:e.waveform_data)??null,s=(e==null?void 0:e.duration)??null;if(!t)return{peaks:null,duration:s};if(typeof t=="string")try{t=JSON.parse(t)}catch{}if(t&&t.data&&Array.isArray(t.data)&&(t=t.data),Array.isArray(t)&&t.length)if(Array.isArray(t[0])){const i=t.map(n=>Array.isArray(n)?n[1]??0:n??0);return{peaks:[new Float32Array(i)],duration:s}}else{if(typeof t[0]=="number")return{peaks:[new Float32Array(t)],duration:s};if(t[0]instanceof Float32Array)return{peaks:t,duration:s}}return{peaks:null,duration:s}}catch{return{peaks:null,duration:(e==null?void 0:e.duration)??null}}}generatePlaceholderWaveform(e=180){const s=Math.floor(e/60*67),i=new Float32Array(s);for(let n=0;n<s;n++){const o=Math.sin(n*.1)*.6,a=(Math.random()-.5)*.4;i[n]=Math.abs(o+a)}return[i]}loadTrackWithPeaks(e,t,s,i=null){if(this.visualData.peaks=t||null,this.visualData.duration=s||null,!i){const n=l=>{if(!l)return!1;const u=window.getComputedStyle(l),d=l.getBoundingClientRect();return u.display!=="none"&&u.visibility!=="hidden"&&d.width>0&&d.height>0},o=document.querySelector("#global-waveform-full"),a=document.querySelector("#global-waveform");n(o)?i="#global-waveform-full":n(a)?i="#global-waveform":o?i="#global-waveform-full":a&&(i="#global-waveform")}if(!this.isInitialized)this.initializeWaveSurfer(i||this.currentContainer||this.config.container,this.visualData);else if(i&&i!==this.currentContainer)this.switchContainer(i);else{const n=i||this.currentContainer||this.config.container;try{this.waveSurfer&&this.waveSurfer.destroy()}catch{}this.waveSurfer=null,this.isInitialized=!1,this.initializeWaveSurfer(n,this.visualData)}this.loadTrack(e)}play(){if(this.usingMediaElement){const e=document.getElementById("persistent-audio-element");if(e)try{e.play(),this.pauseAllOtherPlayers()}catch{}}else{if(!this.waveSurfer)return;try{this.waveSurfer.play(),this.pauseAllOtherPlayers()}catch{}}}pause(){if(this.usingMediaElement){const e=document.getElementById("persistent-audio-element");if(e)try{e.pause()}catch{}}else{if(!this.waveSurfer)return;try{this.waveSurfer.pause()}catch{}}}stop(){if(this.waveSurfer)try{this.waveSurfer.stop(),this.playbackState.currentPosition=0,this.playbackState.isPlaying=!1,this.updateMediaSessionPlaybackState("none")}catch{}}seekTo(e){if(this.usingMediaElement){const t=document.getElementById("persistent-audio-element");if(t&&!isNaN(e)&&e>=0)try{t.currentTime=e}catch{}}else{if(!this.waveSurfer)return;try{const t=this.waveSurfer.getDuration();if(t>0){const s=e/t;this.waveSurfer.seekTo(s)}}catch{}}}setVolume(e){if(this.usingMediaElement){const t=document.getElementById("persistent-audio-element");if(t)try{t.volume=e,this.playbackState.volume=e}catch{}}else{if(!this.waveSurfer)return;try{this.waveSurfer.setVolume(e),this.playbackState.volume=e}catch{}}}setPlaybackRate(e){if(this.waveSurfer)try{this.waveSurfer.setPlaybackRate(e)}catch{}}setMute(e){if(this.usingMediaElement){const t=document.getElementById("persistent-audio-element");if(t)try{t.muted=e,this.playbackState.isMuted=e}catch{}}else{if(!this.waveSurfer)return;try{this.waveSurfer.setMute(e),this.playbackState.isMuted=e}catch{}}}pauseAllOtherPlayers(){const e=document.getElementById("persistent-audio-element");document.querySelectorAll("audio").forEach(t=>{t!==e&&!t.paused&&t.pause()}),Livewire.dispatch("pause-all-tracks",{source:"global-player"})}initializeMediaSession(){"mediaSession"in navigator&&(this.mediaSession=navigator.mediaSession,this.mediaSession.setActionHandler("play",()=>{this.updateLivewireComponent("togglePlayback")}),this.mediaSession.setActionHandler("pause",()=>{this.updateLivewireComponent("togglePlayback")}),this.mediaSession.setActionHandler("previoustrack",()=>{this.updateLivewireComponent("previousTrack")}),this.mediaSession.setActionHandler("nexttrack",()=>{this.updateLivewireComponent("nextTrack")}),this.mediaSession.setActionHandler("seekbackward",e=>{const t=Math.max(0,this.playbackState.currentPosition-(e.seekOffset||10));this.callLivewireMethod("seekTo",t)}),this.mediaSession.setActionHandler("seekforward",e=>{const t=Math.min(this.playbackState.duration,this.playbackState.currentPosition+(e.seekOffset||10));this.callLivewireMethod("seekTo",t)}))}updateMediaSessionMetadata(e){if(this.mediaSession)try{this.mediaSession.metadata=new MediaMetadata({title:e.title||"Unknown Title",artist:e.artist||"Unknown Artist",album:e.project_title||"MixPitch",artwork:[{src:"/logo-192x192.png",sizes:"192x192",type:"image/png"},{src:"/logo-512x512.png",sizes:"512x512",type:"image/png"}]})}catch{}}updateMediaSessionPlaybackState(e){if(this.mediaSession)try{if(this.mediaSession.playbackState=e,e==="playing"||e==="paused"){const t=this.playbackState.duration||0,s=this.playbackState.currentPosition||0;t>0&&s>=0&&s<=t&&!isNaN(t)&&!isNaN(s)&&isFinite(t)&&isFinite(s)&&this.mediaSession.setPositionState({duration:t,playbackRate:1,position:s})}}catch{}}updateMediaSessionState(e){this.playbackState.currentPosition=e.position||this.playbackState.currentPosition,this.playbackState.duration=e.duration||this.playbackState.duration,this.updateMediaSessionPlaybackState(this.playbackState.isPlaying?"playing":"paused")}handleVisibilityChange(){document.hidden?this.savePlaybackState():this.restorePlaybackState()}saveCurrentTrack(e){try{sessionStorage.setItem("global-audio-current-track",JSON.stringify(e))}catch{}}savePlaybackState(){if(this.currentTrack)try{const e={track:this.currentTrack,position:this.playbackState.currentPosition,isPlaying:this.playbackState.isPlaying,volume:this.playbackState.volume,isMuted:this.playbackState.isMuted,timestamp:Date.now()};sessionStorage.setItem("global-audio-playback-state",JSON.stringify(e))}catch{}}restorePlaybackState(){try{const e=sessionStorage.getItem("global-audio-playback-state");if(!e)return;const t=JSON.parse(e);if(Date.now()-t.timestamp>3e5){sessionStorage.removeItem("global-audio-playback-state");return}t.track&&(this.updateLivewireComponent("playTrack",t.track),setTimeout(()=>{t.position>0&&this.callLivewireMethod("seekTo",t.position),t.volume!==1&&this.callLivewireMethod("setVolume",t.volume),t.isMuted&&this.updateLivewireComponent("toggleMute"),t.isPlaying&&this.updateLivewireComponent("togglePlayback")},1e3))}catch{sessionStorage.removeItem("global-audio-playback-state")}}updateLivewireComponent(e,t=null){try{t!==null?Livewire.dispatch(e,t):Livewire.dispatch(e)}catch{}}registerLivewireComponent(e){this.livewireComponent=e}registerAlpineStore(e){this.alpineStore=e}throttlePositionUpdate(){const e=Date.now();this.alpineStore&&this.alpineStore.updatePosition(this.playbackState.currentPosition),e-this.lastPositionUpdate>1e3&&(this.lastPositionUpdate=e,this.callLivewireMethod("updatePosition",this.playbackState.currentPosition))}callLivewireMethod(e,t=null){try{if(this.livewireComponent&&typeof this.livewireComponent.call=="function"){t!==null?this.livewireComponent.call(e,t):this.livewireComponent.call(e);return}this.updateLivewireComponent(e,t)}catch{this.updateLivewireComponent(e,t)}}getCurrentTrack(){return this.currentTrack}getCurrentState(){return{...this.playbackState}}isReady(){return this.isInitialized&&this.waveSurfer!==null}setLoop(e,t){e!==null&&t!==null&&e<t&&(this.loopState.start=e,this.loopState.end=t,this.loopState.enabled=!0)}clearLoop(){this.loopState.enabled=!1,this.loopState.start=null,this.loopState.end=null}getLoopState(){return{...this.loopState}}initializeServiceWorkerCommunication(){"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",e=>{this.handleServiceWorkerMessage(e)})}handleServiceWorkerMessage(e){const{type:t,payload:s}=e.data;switch(t){case"AUDIO_STATE_RESTORED":this.applyRestoredState(s);break}}async restoreAudioState(){if(navigator.serviceWorker)try{const e=await navigator.serviceWorker.ready,t=new MessageChannel;t.port1.onmessage=s=>{this.handleServiceWorkerMessage(s)},e.active.postMessage({type:"RESTORE_AUDIO_STATE"},[t.port2])}catch{}}applyRestoredState(e){!e||!e.track||(this.alpineStore&&(this.alpineStore.setTrack(e.track,e.queue||[],e.queuePosition||0),this.alpineStore.volume=e.volume||1,this.alpineStore.isMuted=e.isMuted||!1,e.loopState&&(this.loopState=e.loopState,this.alpineStore.loopEnabled=e.loopState.enabled,this.alpineStore.loopStart=e.loopState.start,this.alpineStore.loopEnd=e.loopState.end)),this.loadTrack(e.track),this.waveSurfer&&this.waveSurfer.on("ready",()=>{e.position>0&&this.seekTo(e.position)},{once:!0}))}async preloadAudioFile(e){if(!(!navigator.serviceWorker||!e))try{(await navigator.serviceWorker.ready).active.postMessage({type:"PRELOAD_AUDIO",payload:e})}catch{}}preloadNextTrack(){if(!this.alpineStore||this.alpineStore.queue.length===0)return;const e=this.alpineStore.queuePosition+1;if(e<this.alpineStore.queue.length){const t=this.alpineStore.queue[e];t&&t.url&&this.preloadAudioFile(t.url)}}playWithFallback(){var e;if(this.usingMediaElement){const t=document.getElementById("persistent-audio-element");if(!t)return;try{this.currentTrack&&t.src!==this.currentTrack.url&&(t.src=this.currentTrack.url,(e=this.waveSurfer)!=null&&e.setMediaElement&&typeof this.waveSurfer.setMediaElement=="function"&&this.waveSurfer.setMediaElement(t),this.setupAudioElementEvents(t)),(isNaN(t.duration)||!isFinite(t.duration)||t.duration===0)&&t.addEventListener("loadedmetadata",()=>{try{t.play(),this.pauseAllOtherPlayers()}catch{this.usePersistentAudioFallback()}},{once:!0});const s=t.play();s&&typeof s.then=="function"&&s.catch(()=>{var i;try{(i=this.waveSurfer)==null||i.play()}catch{this.usePersistentAudioFallback()}}),this.pauseAllOtherPlayers()}catch{this.usePersistentAudioFallback()}return}if(this.waveSurfer)try{const t=this.waveSurfer.play();t&&typeof t.then=="function"&&t.catch(s=>{s.name==="NotAllowedError"&&this.usePersistentAudioFallback()}),this.pauseAllOtherPlayers()}catch{this.usePersistentAudioFallback()}}usePersistentAudioFallback(){const e=document.getElementById("persistent-audio-element");if(!(!e||!this.currentTrack))try{e.src!==this.currentTrack.url&&(e.src=this.currentTrack.url,e.currentTime=this.playbackState.currentPosition),e.volume=this.playbackState.volume,e.muted=this.playbackState.isMuted,e.play().then(()=>{this.playbackState.isPlaying=!0,this.alpineStore&&this.alpineStore.updatePlaybackState(!0),this.setupPersistentAudioEvents(e)}).catch(t=>{})}catch{}}setupPersistentAudioEvents(e){e.removeEventListener("timeupdate",this.persistentAudioTimeUpdate),e.removeEventListener("ended",this.persistentAudioEnded),this.persistentAudioTimeUpdate=()=>{this.playbackState.currentPosition=e.currentTime,this.throttlePositionUpdate()},this.persistentAudioEnded=()=>{this.playbackState.isPlaying=!1,this.playbackState.currentPosition=0,this.updateLivewireComponent("trackEnded")},e.addEventListener("timeupdate",this.persistentAudioTimeUpdate),e.addEventListener("ended",this.persistentAudioEnded)}play(){this.playWithFallback()}renderCommentMarkers(e,t){if(!e||!t||t<=0)return;const s=this.getCurrentWaveformContainer();if(!s)return;this.clearCommentMarkers(s);let i=s.querySelector(".comment-markers-overlay");i||(i=document.createElement("div"),i.className="comment-markers-overlay absolute inset-0 pointer-events-none",i.style.position="absolute",i.style.top="0",i.style.left="0",i.style.right="0",i.style.bottom="0",i.style.pointerEvents="none",i.style.zIndex="10",s.appendChild(i)),e.forEach(n=>{const o=n.comments&&Array.isArray(n.comments),a=n.timestamp,l=a/t*100,u=Math.min(Math.max(l,0),100),d=n.resolved,c=n.count||1,p=document.createElement("div");p.className="comment-marker absolute h-full w-1 cursor-pointer group",p.style.left=`${u}%`,p.style.background=d?"linear-gradient(to bottom, #22c55e, #10b981)":"linear-gradient(to bottom, #7c3aed, #4f46e5)",p.style.pointerEvents="auto",p.style.zIndex="10";const h=document.createElement("div");h.className=`h-4 w-4 rounded-full -ml-1.5 ${d?"bg-gradient-to-br from-green-500 to-emerald-600":"bg-gradient-to-br from-purple-500 to-indigo-600"} border-2 border-white shadow-lg absolute -top-1 group-hover:scale-125 transition-all duration-200`;const f=document.createElement("div");if(f.className="absolute inset-0 rounded-full bg-white/30 animate-pulse",h.appendChild(f),c>1){const P=document.createElement("div");P.className="absolute -top-1 -right-1 h-4 w-4 bg-red-500 text-white text-[9px] font-bold rounded-full flex items-center justify-center border border-white shadow-md",P.textContent=c,h.appendChild(P)}p.appendChild(h);const m=document.createElement("div");m.className="comment-tooltip absolute mb-2 bg-white",m.style.bottom="1.75rem",m.style.left="50%",m.style.transform="translateX(-50%)",m.style.width="20rem",m.style.maxHeight="20rem",m.style.overflowY="auto",m.style.border="1px solid #e5e7eb",m.style.borderRadius="0.75rem",m.style.boxShadow="0 10px 25px rgba(0,0,0,0.15)",m.style.padding="0.75rem",m.style.zIndex="50",m.style.display="none";const y=document.createElement("div");y.className="flex items-center justify-between mb-3 pb-2 border-b border-gray-200";const v=document.createElement("div");if(v.className="text-xs font-semibold text-purple-600",v.textContent=n.formatted_timestamp||this.formatTime(a),y.appendChild(v),c>1){const P=document.createElement("div");P.className="text-xs text-gray-500",P.textContent=`${c} comments`,y.appendChild(P)}m.appendChild(y);const _=document.createElement("div");_.className="space-y-3",(o?n.comments:[n]).forEach((P,E)=>{var $;const T=document.createElement("div");T.className="border-b border-gray-100 last:border-0 pb-3 last:pb-0";const U=document.createElement("div");U.className="flex items-center mb-2";const M=document.createElement("div");if(M.className="text-xs font-semibold text-gray-900 flex-1",M.textContent=(($=P.user)==null?void 0:$.name)||P.client_email||"Client",U.appendChild(M),P.resolved){const D=document.createElement("div");D.className="text-[9px] text-green-600 font-medium",D.textContent="✓ Resolved",U.appendChild(D)}T.appendChild(U);const B=document.createElement("div");if(B.className="text-xs text-gray-800 bg-gradient-to-r from-purple-50/50 to-indigo-50/50 rounded-lg p-2",B.textContent=(P.comment||"").slice(0,140),T.appendChild(B),Array.isArray(P.replies)&&P.replies.length){const D=document.createElement("div");D.className="mt-2 pl-3 border-l-2 border-purple-200";const ke=document.createElement("div");ke.className="text-[10px] text-gray-500 mb-1",ke.textContent=`${P.replies.length} ${P.replies.length===1?"reply":"replies"}`,D.appendChild(ke),P.replies.slice(0,2).forEach(ge=>{var Pe;const Ce=document.createElement("div");Ce.className="text-[10px] text-gray-600 mb-1";const Se=document.createElement("span");Se.className="font-medium",Se.textContent=(((Pe=ge.user)==null?void 0:Pe.name)||ge.client_email||"Client")+": ",Ce.appendChild(Se),Ce.appendChild(document.createTextNode((ge.comment||"").slice(0,80))),D.appendChild(Ce)}),T.appendChild(D)}_.appendChild(T)}),m.appendChild(_),p.appendChild(m);let k=null;p.addEventListener("mouseenter",()=>{k&&(clearTimeout(k),k=null);try{const E=s.getBoundingClientRect().width||s.clientWidth||0,T=u/100*E,U=320,M=8;m.style.right="auto",m.style.left="50%",m.style.transform="translateX(-50%)",T<U/2+M?(m.style.left="0",m.style.right="auto",m.style.transform="translateX(0)"):E-T<U/2+M&&(m.style.left="auto",m.style.right="0",m.style.transform="translateX(0)")}catch{}m.style.display="block"}),p.addEventListener("mouseleave",()=>{k=setTimeout(()=>{m.style.display="none"},1e3)}),m.addEventListener("mouseenter",()=>{k&&(clearTimeout(k),k=null)}),m.addEventListener("mouseleave",()=>{m.style.display="none"}),p.addEventListener("click",P=>{P.preventDefault(),P.stopPropagation(),this.seekToCommentTimestamp(a)}),i.appendChild(p)})}clearCommentMarkers(e){if(e||(e=this.getCurrentWaveformContainer()),e){const t=e.querySelector(".comment-markers-overlay");t&&(t.innerHTML="")}}getCurrentWaveformContainer(){const e=o=>{if(!o)return!1;const a=window.getComputedStyle(o),l=o.getBoundingClientRect();return a.display!=="none"&&a.visibility!=="hidden"&&l.width>0&&l.height>0};if(this.currentContainer){const o=typeof this.currentContainer=="string"?document.querySelector(this.currentContainer):this.currentContainer;if(e(o))return o}let t=document.querySelector("#global-waveform-full");if(e(t))return t;let s=document.querySelector("#global-waveform");if(e(s))return s;const i=document.querySelector(this.config.fallbackContainer);return i||document.querySelector(this.config.container)||null}findBestContainerSelector(){const e=this.getCurrentWaveformContainer();return e?e.id?`#${e.id}`:this.config.fallbackContainer:this.config.fallbackContainer}seekToCommentTimestamp(e){if(!this.waveSurfer||!this.playbackState.duration||this.playbackState.duration<=0)return;const t=e/this.playbackState.duration;if(this.usingMediaElement){const s=document.getElementById("persistent-audio-element");s&&(s.currentTime=e)}else this.waveSurfer.seekTo(t);this.pause(),this.playbackState.currentPosition=e,this.alpineStore&&(this.alpineStore.currentPosition=e)}updateCommentMarkers(e){if(!e||!this.playbackState.duration){this.clearCommentMarkers();return}this.renderCommentMarkers(e,this.playbackState.duration)}formatTime(e){if(!e||isNaN(e))return"00:00";const t=Math.floor(e/60),s=Math.floor(e%60);return`${t.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`}setupCommentMarkerListeners(){var e;Livewire.on("commentMarkersUpdated",t=>{this.updateCommentMarkers(t.comments)}),(e=this.waveSurfer)==null||e.on("ready",()=>{this.callLivewireMethod("calculateCommentMarkers")}),document.addEventListener("keydown",t=>{if(t.key.toLowerCase()==="c"&&!t.ctrlKey&&!t.metaKey&&!t.altKey){const s=document.activeElement;s.tagName!=="INPUT"&&s.tagName!=="TEXTAREA"&&s.contentEditable!=="true"&&(t.preventDefault(),this.triggerAddCommentAtCurrentPosition())}})}triggerAddCommentAtCurrentPosition(){this.currentTrack&&(this.currentTrack.type==="pitch_file"||this.currentTrack.type==="project_file")&&this.callLivewireMethod("toggleCommentForm",this.playbackState.currentPosition)}destroy(){this.waveSurfer&&(this.waveSurfer.destroy(),this.waveSurfer=null),this.isInitialized=!1,this.currentTrack=null;const e=document.getElementById("persistent-audio-element");e&&(e.pause(),e.src=""),this.clearCommentMarkers()}}window.globalAudioManager=new Eo;typeof kr<"u"&&kr.exports&&(kr.exports=Eo);const Up=(()=>{let r;function e(){const t={uppy:null,isPaused:!1,queue:[],activeMeta:null,livewire:null,wasOffline:!1,bulkVersionUploads:[]};function s(){const a=i(t.queue),l=t.queue.map(c=>({...c})),u=l.map(c=>c.id),d=[...new Set(u)];if(u.length!==d.length){console.warn("Duplicate IDs detected in upload queue:",u);const c=l.filter((p,h,f)=>f.findIndex(m=>m.id===p.id)===h);l.splice(0,l.length,...c)}window.dispatchEvent(new CustomEvent("global-uploader:update",{detail:{queue:l,isPaused:t.isPaused,aggregateProgress:a}}))}function i(a){if(!a.length)return 0;const l=a.reduce((u,d)=>u+(d.progress||0),0);return Math.min(100,Math.round(l/a.length))}function n(){if(t.uppy)return t.uppy;t.uppy=new Js({autoProceed:!0,allowMultipleUploads:!0,restrictions:{allowedFileTypes:["audio/*","video/*","application/pdf","image/*","application/zip"]},onBeforeFileAdded:(l,u)=>(l.meta={...l.meta||{},...t.activeMeta||{}},!0)}).use(ti,{target:"#global-uppy-progress",hideAfterFinish:!1}).use(ei,{target:"#global-uppy-status",hideRetryButton:!1,hidePauseResumeButton:!1}).use(ur,{shouldUseMultipart:!0,createMultipartUpload(l){var u,d,c;return fetch("/s3/multipart",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({filename:l.name,type:l.type,size:l.size,metadata:{modelId:(u=l.meta)==null?void 0:u.modelId,modelType:(d=l.meta)==null?void 0:d.modelType,context:(c=l.meta)==null?void 0:c.context}}),credentials:"same-origin"}).then(p=>{if(!p.ok)throw new Error(`HTTP ${p.status}`);return p.json()}).then(p=>({uploadId:p.uploadId,key:p.key}))},signPart(l,u){const d=`/s3/multipart/${u.uploadId}/${u.partNumber}?key=${encodeURIComponent(u.key)}`;return fetch(d,{method:"GET",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"}).then(c=>{if(!c.ok)throw new Error(`HTTP ${c.status}`);return c.json()}).then(c=>({url:c.url,headers:c.headers||{}}))},completeMultipartUpload(l,{uploadId:u,parts:d,key:c}){return fetch(`/s3/multipart/${u}/complete`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({parts:d,key:c}),credentials:"same-origin"}).then(p=>{if(!p.ok)throw new Error(`HTTP ${p.status}`);return p.json()}).then(p=>({location:p.location}))},abortMultipartUpload(l,{uploadId:u,key:d}){return fetch(`/s3/multipart/${u}?key=${encodeURIComponent(d)}`,{method:"DELETE",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"})}}),t.uppy.on("file-added",l=>{var c;l.id||(l.id=`uppy-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,console.warn("File missing ID, generated:",l.id));const u=t.queue.findIndex(p=>p.id===l.id);if(u>=0?(console.warn("File already in queue, updating:",l.id),t.queue[u]={id:l.id,name:l.name,size:l.size,meta:l.meta,progress:0,status:"queued"}):t.queue.push({id:l.id,name:l.name,size:l.size,meta:l.meta,progress:0,status:"queued"}),((c=l.meta)==null?void 0:c.isBulkVersionUpload)===!0){const p={id:l.id,name:l.name,size:l.size,type:l.type,status:"queued",progress:0};window.dispatchEvent(new CustomEvent("bulk-version-file-selected",{detail:p}))}s()}),t.uppy.on("upload-progress",(l,u)=>{var p,h,f,m,y;const d=t.queue.findIndex(v=>v.id===l.id);if(d>=0){const v=Math.min(100,Math.round(((p=l.progress)==null?void 0:p.percentage)??0));t.queue[d].status=(h=l.progress)!=null&&h.uploadComplete?"complete":"uploading",t.queue[d].progress=v,s()}if(((f=l.meta)==null?void 0:f.isBulkVersionUpload)===!0){const v=Math.min(100,Math.round(((m=l.progress)==null?void 0:m.percentage)??0));window.dispatchEvent(new CustomEvent("bulk-version-upload-progress",{detail:{id:l.id,name:l.name,progress:v,status:(y=l.progress)!=null&&y.uploadComplete?"complete":"uploading"}}))}});const a=()=>{t.uppy.getFiles().forEach(u=>{var c,p,h;const d=t.queue.findIndex(f=>f.id===u.id);if(d>=0){const f=Math.min(100,Math.round(((c=u.progress)==null?void 0:c.percentage)??0));t.queue[d].progress=f,(p=u.progress)!=null&&p.uploadComplete?t.queue[d].status="complete":(h=u.progress)!=null&&h.uploadStarted&&(t.queue[d].status="uploading")}}),s()};return t.uppy.on("upload",a),t.uppy.on("upload-resumed",()=>a()),t.uppy.on("file-removed",()=>a()),t.uppy.on("upload-success",(l,u)=>{var h,f,m,y,v,_,A,k,P,E,T,U,M,B;const d=t.queue.findIndex($=>$.id===l.id);d>=0&&(t.queue[d].status="complete",t.queue[d].progress=100,t.queue[d].response=u,s());const c=((h=l.meta)==null?void 0:h.isVersionUpload)===!0,p=((f=l.meta)==null?void 0:f.isBulkVersionUpload)===!0;if(c){const $={name:l.name,size:l.size,type:l.type,key:((y=(m=l.response)==null?void 0:m.body)==null?void 0:y.Key)||((v=l.meta)==null?void 0:v.key)||((_=l.s3Multipart)==null?void 0:_.key)};window.dispatchEvent(new CustomEvent("version-file-uploaded",{detail:$}))}else if(p){const $={id:l.id,name:l.name,size:l.size,type:l.type,key:((k=(A=l.response)==null?void 0:A.body)==null?void 0:k.Key)||((P=l.meta)==null?void 0:P.key)||((E=l.s3Multipart)==null?void 0:E.key)};t.bulkVersionUploads.push($),window.dispatchEvent(new CustomEvent("bulk-version-file-uploaded",{detail:$}))}else if(t.livewire){const $=[{name:l.name,size:l.size,type:l.type,key:((U=(T=l.response)==null?void 0:T.body)==null?void 0:U.Key)||((M=l.meta)==null?void 0:M.key)||((B=l.s3Multipart)==null?void 0:B.key),meta:l.meta||{}}];try{typeof t.livewire.call=="function"?t.livewire.call("handleGlobalUploadSuccess",$):typeof t.livewire.handleGlobalUploadSuccess=="function"&&t.livewire.handleGlobalUploadSuccess($)}catch{}}}),t.uppy.on("upload-error",(l,u)=>{const d=t.queue.findIndex(c=>c.id===l.id);d>=0&&(t.queue[d].status="error",t.queue[d].error=(u==null?void 0:u.message)||"Upload failed",s())}),t.uppy.on("complete",()=>{t.bulkVersionUploads.length>0&&(window.dispatchEvent(new CustomEvent("bulk-version-files-uploaded",{detail:t.bulkVersionUploads})),t.bulkVersionUploads=[]),s()}),t.uppy}function o(){return t.uppy||n()}return{attachLivewire(a){t.livewire=a,o(),s(),this.initNetworkHandlers()},getActiveMeta(){return t.activeMeta},setActiveTarget(a){t.activeMeta={...a}},openFileDialog(a){var u,d;t.activeMeta={...a},a!=null&&a.isBulkVersionUpload&&(t.bulkVersionUploads=[]),(d=(u=o().getPlugin("Dashboard"))==null?void 0:u.openModal)==null||d.call(u);const l=document.createElement("input");l.type="file",l.multiple=!0,l.onchange=()=>{const c=Array.from(l.files||[]);this.addFiles(c,a)},l.click()},addFiles(a,l){t.activeMeta={...l};const u=o();a.forEach(d=>{u.addFile({name:d.name,type:d.type,data:d,meta:{...l||{}}})})},pauseAll(){t.isPaused=!0,o().pauseAll(),s()},resumeAll(){t.isPaused=!1;const a=o();a.resumeAll();const l=a.getFiles(),u=l.some(c=>{var p,h;return((p=c.progress)==null?void 0:p.uploadStarted)&&!((h=c.progress)!=null&&h.uploadComplete)}),d=l.some(c=>{var p,h;return!((p=c.progress)!=null&&p.uploadStarted)&&!((h=c.progress)!=null&&h.uploadComplete)});!u&&d&&a.upload().catch(()=>{}),s()},cancelAll(){o().cancelAll(),t.queue=t.queue.filter(a=>a.status!=="uploading"),s()},togglePause(a){const l=t.queue.find(u=>u.id===a);if(l){if(l.paused){l.paused=!1;const u=o();u.pauseResume(a);const d=u.getFiles(),c=d.some(h=>{var f,m;return((f=h.progress)==null?void 0:f.uploadStarted)&&!((m=h.progress)!=null&&m.uploadComplete)}),p=d.some(h=>{var f,m;return!((f=h.progress)!=null&&f.uploadStarted)&&!((m=h.progress)!=null&&m.uploadComplete)});!c&&p&&u.upload().catch(()=>{})}else l.paused=!0,o().pauseResume(a);s()}},retry(a){o().retryUpload(a)},retryFailed(){o().retryAll()},clearCompleted(){t.queue=t.queue.filter(a=>a.status!=="complete"),s()},initNetworkHandlers(){const a=()=>{if(t.wasOffline){t.wasOffline=!1,this.resumeAll();try{window.dispatchEvent(new CustomEvent("toaster:info",{detail:{message:"Back online. Resuming uploads."}}))}catch{}}},l=()=>{t.wasOffline=!0,this.pauseAll();try{window.dispatchEvent(new CustomEvent("toaster:warning",{detail:{message:"You are offline. Uploads paused."}}))}catch{}};window.removeEventListener("online",a),window.removeEventListener("offline",l),window.addEventListener("online",a),window.addEventListener("offline",l)},enableGlobalDragDrop(a){window.GlobalDragDrop&&window.GlobalDragDrop.enablePageDragDrop(a)},disableGlobalDragDrop(){window.GlobalDragDrop&&window.GlobalDragDrop.disablePageDragDrop()},registerDropZone(a,l){window.GlobalDragDrop&&window.GlobalDragDrop.registerDropZone(a,l)},unregisterDropZone(a){window.GlobalDragDrop&&window.GlobalDragDrop.unregisterDropZone(a)},validateFiles(a,l){const u=["audio/*","video/*","application/pdf","image/*","application/zip"],d=[],c=[];if(a.forEach(p=>{u.some(f=>f.endsWith("/*")?p.type.startsWith(f.slice(0,-1)):p.type===f)?d.push(p):c.push(p)}),c.length>0){const p=c.map(h=>h.name).join(", ");try{window.dispatchEvent(new CustomEvent("toaster:error",{detail:{message:`Invalid file types: ${p}. Only audio, PDF, image, and ZIP files are allowed.`}}))}catch{}}return d},addValidatedFiles(a,l){const u=this.validateFiles(a,l);if(u.length>0){this.addFiles(u,l);try{window.dispatchEvent(new CustomEvent("toaster:success",{detail:{message:`${u.length} file${u.length>1?"s":""} added to upload queue`}}))}catch{}}return u.length},getUploadStats(){const a=t.queue.length,l=t.queue.filter(p=>p.status==="complete").length,u=t.queue.filter(p=>p.status==="uploading").length,d=t.queue.filter(p=>p.status==="queued").length,c=t.queue.filter(p=>p.status==="error").length;return{total:a,completed:l,uploading:u,queued:d,errors:c,isPaused:t.isPaused}},clearBulkVersionUploads(){console.log("[GlobalUploader] Clearing bulkVersionUploads array, had:",t.bulkVersionUploads.length,"files"),t.bulkVersionUploads=[]}}}return{getInstance(){return r||(r=e()),r}}})();window.GlobalUploader=Up.getInstance();try{Ro(()=>import("./stripe-handler-9538a51a.js"),[])}catch(r){console.error("Could not load Stripe handler:",r)}});export default Rp();
